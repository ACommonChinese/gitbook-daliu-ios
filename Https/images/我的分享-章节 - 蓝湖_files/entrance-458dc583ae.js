!function e(i,t,a){function s(o,r){if(!t[o]){if(!i[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=t[o]={exports:{}};i[o][0].call(c.exports,function(e){var t=i[o][1][e];return s(t?t:e)},c,c.exports,e,i,t,a)}return t[o].exports}for(var n="function"==typeof require&&require,o=0;o<a.length;o++)s(a[o]);return s}({1:[function(e,i,t){var a={preURLLink:document.referrer,decodeUrl:function(e){return"string"==typeof e?decodeURIComponent(e):void 0},getQueryParam:function(e){e=e||document.location.href;var i=e.substring(e.lastIndexOf("?")+1);i.lastIndexOf("#")>=0&&(i=i.substring(0,i.lastIndexOf("#")));for(var t=i.split("&"),s={},n=0;n<t.length;n++){var o=t[n];try{var r=o.substring(0,o.indexOf("=")),l=o.substring(o.indexOf("=")+1);if(0==r.length)continue;/^-?(\d+)(\.\d+)?$/.test(l)?0===l.indexOf("0")?s[r]=""+l:(""+l).length>10?s[r]=""+l:s[r]=Number(l):"true"===l?s[r]=!0:"false"===l?s[r]=!1:s[r]=a.decodeUrl(l)}catch(c){continue}}return s},getUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var i="",t=e.split(/\s+/),a=0;a<t.length;a++){var s=function(e){var i=/((https?|ftp|news):\/\/)?([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;if(e.match(i)){var t=/(https?):\/\/([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;e=e.match(t)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>"}return e+" "}(t[a]);i+=s}return i},getNewUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var i="",t=e.split(/\s+/),a=0;a<t.length;a++){var s=function(e){var i=/^(((https?):\/\/)|(www))[a-zA-Z0-9_\-]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([:\/\(\)\?\.&\-=a-zA-Z0-9;#%_]+)?$/g;if(e.match(i))e=e.match(i)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>";else{var t=/((www.)|((https?):\/\/))[a-zA-Z0-9_\-]+((\.(com|cn|org))|(:[0-9]{2,4}))?(:[0-9]{2,4})?([:\/\(\)\?\.&\-=a-zA-Z0-9;#%_]+)?/g,a=e.match(t),s=a;if(a&&a.length>0){var n=e.indexOf(a[0]),o=a[0].indexOf("http");if(s=o>=0?'<a href="'+a[0]+'" target="_blank">'+a[0]+"</a>":'<a href="http://'+a[0]+'" target="_blank">'+a[0]+"</a>",0===n)e=s+e.substring(a[0].length,e.length);else{var r=e.substring(0,n),l=r+a[0],c=e.substring(l.length,e.length);e=r+s+c}}}return e+" "}(t[a]);i+=s}return i},format:function(e,i,t){if(t){var a;if("object"==typeof i)for(var s in i){var n="{"+s+"}";a=e.replace(n,i[s])}else for(var o=0;o<i.length;o++){if(void 0==i[o])return"";var n="{"+o+"}";a=e.replace(n,i[o])}return a}return e},detectEventSupport:function(e){var i,t=document.createElement("div");return e="on"+e,i=e in t,i||(t.setAttribute(e,"xxx"),i="function"==typeof t[e]),t=null,i}};i.exports=a},{}],2:[function(e,i,t){i.exports={errorlogPath:"log.sobot.com/errorlog/"}},{}],3:[function(e,i,t){var a=function(i){var t=e("./comm.js"),a=e("./util/promise.js"),s=e("./initText.js"),n=new a,o={config_url:"/chat/user/config.action",init_url:"/chat/user/init.action",active_url:"/chat/user/productRecommend.action",multi_url:"/chat-web/user/questionRecommend.action"},r=window.navigator.userAgent.indexOf("Mobile")>=0,l={};l.cacheInfo={};var c=!1;l.cacheInfo.flags={status:"enabled",isLoaded:!1,pageNow:1,pageSize:20,moreHistroy:!1,isConnected:!1,isEnableManual:!1,isEnableOnInput:!0,isGetCustomConfig:!1,isEnableBigImg:!0,isPeopleModel:!1,isWaitModel:!1,isTimeLine:!1,isUserTalked:!1,isSurveyed:!1,isKeepSessions:!1,isOutOneMinute:!1};var d=!0,u=t.getQueryParam(),f=function(e){var i=!0;if(e.whiteListFlag){if(e.domainWhiteList){i=!1;var t=e.domainWhiteList.split(","),a=(l.cacheInfo.urlParams,document.referrer||"");if(a){for(var s=/http(s)?:\/\/[a-zA-Z0-9]+\.[a-zA-Z0-9\-]+(\.[a-zA-Z0-9]*)*/g,a=a.match(s),n=0;n<t.length;n++)if(t[n].indexOf(a)>=0){i=!0;break}return i}return i}return i}return i},p=function(e){if(e.whiteListFlag){var i=f(e);if(!i)throw alert("未在白名单中设置该域名对聊天组件的访问权限"),"未在白名单中设置该域名对聊天组件的访问权限"}},m={initParams:function(){var e=l.cacheInfo.urlParams={},i=t.getQueryParam();if(i)for(var a in i)e[a]=i[a];if(l.cacheInfo.urlParams.locale){c=!0;var s=l.cacheInfo.urlParams.locale;switch(s){case"en":l.cacheInfo.urlParams.lanFlag=1;break;default:l.cacheInfo.urlParams.lanFlag=0}}},initUA:function(){var e=l.cacheInfo.UAInfo={},i=["mz","xiaomi","android","ipad","iphone"],t=["windows","linux","mac"],a=i.length,s=t.length,n=navigator.userAgent.toLowerCase(),o=$(window).width(),r=$(window).height(),c=0,d="iphone-5",u="";e.uaHeight=r;for(var f=0,p="";f<a&&!u.length;f++){if(p=i[f],c=n.indexOf(p),"iphone"===p&&c>0){switch(o>310&&o<320&&(o=1),o>365&&o<385&&(o=2),o>404&&o<424&&(o=3),o){case 1:d="iphone-5";break;case 2:d="iphone-6";break;case 3:d="iphone-6+"}e.iphoneVersion=d,e.UA=p;break}if(c>0){e.UA=p;break}}if(c<=0)for(var f=0,p="";f<s;f++)if(p=t[f],c=n.indexOf(p),c>0){e.UA="pc";break}},initBrowser:function(){for(var e=l.cacheInfo.browser={},i=["mqqbrowser","qq","micromessenger","MicroMessenger","ucbrowser","miuibrowser","safari","opera mobi","opera mini","firefox"],t=i.length,a=navigator.userAgent.toLowerCase(),s=0,n=0,o="";n<t;n++)if(o=i[n],s=a.indexOf(o),s>0)return void(e.browser=o)},initLanguage:function(){var e=l.cacheInfo.language={};d?e.open=!0:e.open=!1},initEventType:function(){var e=l.cacheInfo.eventType={};if("xiaomi"==l.cacheInfo.UAInfo.UA)e.type="mousedown";else if("pc"!=l.cacheInfo.UAInfo.UA){var i=/hp-tablet/gi.test(navigator.appVersion),t="ontouchstart"in window&&!i;e.type=t?"touchstart":"mousedown"}else e.type="click"},initUserInfo:function(){var e=r?4:0,i=t.getQueryParam(),a=i.source;"number"==typeof a&&(e=a),l.cacheInfo.userInfo={source:e,tel:i.tel?i.tel:"",uname:i.uname?i.uname:"",partnerId:i.partnerid?i.partnerid+"":"",email:i.email?i.email:"",visitUrl:i.visitUrl?i.visitUrl:t.preURLLink,visitTitle:i.visitTitle?i.visitTitle:"",face:i.face?i.face:"",back:i.back?i.back:"",realname:i.realname?i.realname:"",weibo:i.weibo?i.weibo:"",weixin:i.weixin?i.weixin:"",qq:i.qq?i.qq:"",sex:i.sex?i.sex:0===i.sex?0:"",birthday:i.birthday?i.birthday:"",remark:i.remark?i.remark:"",color:i.color?i.color:"",modulType:i.type?i.type:"",params:i.params?i.params:"",lastCid:i.cid?i.cid:"",customerFields:i.customerFields?i.customerFields:"",customer_fields:i.customer_fields?i.customer_fields:"",multiParams:i.multiParams?i.multiParams:"",sign:i.sign?i.sign:""}},initSysNum:function(){l.cacheInfo.sysnum=t.getQueryParam().sysnum}},g=function(){var e=new a;return setTimeout(e.resolve,0),e},v=function(e,i){var t=["leaveMessage.html"],a=0,s={};for(var n in e)s[n]=e[n];s.uname=i.apiInit.uname,s.ticketShowFlag=i.apiConfig.ticketShowFlag,s.uname=i.apiInit.uname,s.userId=i.apiInit.userId,s.pid=i.apiInit.pid;for(var n in s){var o=encodeURIComponent(s[n]);o.length>50||(0==a?t.push("?"):t.push("&"),t.push(n+"="+o),a++)}var r=t.join("");return r},h=function(e){if(void 0===e||null===e||e!==e)return"";try{return decodeURIComponent(e)}catch(i){return""}},y=function(){g().then(function(e,i){var i=i||new a;return m.initUA(),m.initParams(),m.initLanguage(),m.initSysNum(),m.initBrowser(),m.initUserInfo(),m.initEventType(),$.ajax({type:"post",url:o.config_url,dataType:"json",timeout:5e3,data:{sysNum:l.cacheInfo.sysnum,source:l.cacheInfo.userInfo.source,lanFlag:l.cacheInfo.urlParams.lanFlag||0,robotFlag:u.robotid||"",channelFlag:l.cacheInfo.urlParams.channelid||""},success:function(e){if(e&&"210006"===e.err_code){var t="Error: "+e.err_msg+"，请检查sysnum是否正确";throw alert(t),t}if(e.isFreeVersion){var a=/^http(s*):\/\/www.sobot.com/,s=document.referrer||"";if(!s||!a.test(s))throw alert("该功能已关闭，如需开通请联系您的客户经理！"),"该版本仅支持来源页为智齿的页面！"}p(e);var n=l.cacheInfo.userInfo.modulType,o=l.cacheInfo.userInfo.color;"number"==typeof n&&n>=1&&n<=4&&(n=Math.floor(n),e.type=n);var r,d=/^(([a-fA-F0-9]{3})|([a-fA-F0-9]{6}))$/;o&&(r=decodeURIComponent(o),d.test(r)&&(e.color="#"+r)),l.cacheInfo.userInfo.color=e.color,l.cacheInfo.apiConfig=e,c||l.cacheInfo.urlParams.lanFlag||l.cacheInfo.apiConfig.lan&&(l.cacheInfo.urlParams.lanFlag=l.cacheInfo.apiConfig.lan,l.cacheInfo.urlParams.lan="en");var f={},m=[];"string"==typeof u.manualType?m=u.manualType.split(","):"string"==typeof l.cacheInfo.apiConfig.manualType&&(m=l.cacheInfo.apiConfig.manualType.split(",")),f.direct=m[0],f.under=m[1],f.guide=m[2],f.unknow=m[3],l.cacheInfo.urlParams.manualTypeObj=f,"undefined"!=typeof u.artificial?l.cacheInfo.urlParams.chatConnectButton=u.artificial:l.cacheInfo.urlParams.chatConnectButton=l.cacheInfo.apiConfig.chatConnectButton,"undefined"!=typeof u.show_manual?l.cacheInfo.urlParams.chatConnectButton=u.show_manual:l.cacheInfo.urlParams.chatConnectButton=l.cacheInfo.apiConfig.chatConnectButton,"number"!=typeof u.tranFlag?l.cacheInfo.urlParams.tranFlag=0:l.cacheInfo.urlParams.tranFlag=u.tranFlag,"undefined"!=typeof u.artificialCount?l.cacheInfo.urlParams.manualBtnCount=u.artificialCount:l.cacheInfo.urlParams.manualBtnCount=l.cacheInfo.apiConfig.manualBtnCount;var g=window.location.href.split("?")[1],v="",a=/sysnum=(\w){1,100}(&)?/;if(a.test(g)){var h=a.exec(g);g=g.replace(h[0],"")}"undefined"!=typeof u.wurl?u.wurl.split("?")[1]?(v="?"+u.wurl.split("?")[1]+"&"+g,l.cacheInfo.urlParams.wurl=u.wurl.split("?")[0]+v):(v="?"+g,l.cacheInfo.urlParams.wurl=u.wurl+v):l.cacheInfo.apiConfig.wurl.split("?")[1]?(v="?"+l.cacheInfo.apiConfig.wurl.split("?")[1]+"&"+g,l.cacheInfo.urlParams.wurl=l.cacheInfo.apiConfig.wurl.split("?")[0]+v):(v="?"+g,l.cacheInfo.urlParams.wurl=l.cacheInfo.apiConfig.wurl+v),"undefined"!=typeof u.leaveCustomUrl?u.leaveCustomUrl.split("?")[1]?(v="?"+u.leaveCustomUrl.split("?")[1]+"&"+g,l.cacheInfo.urlParams.leaveCustomUrl=u.leaveCustomUrl.split("?")[0]+v):(v="?"+g,l.cacheInfo.urlParams.leaveCustomUrl=u.leaveCustomUrl+v):l.cacheInfo.apiConfig.leaveCustomUrl&&l.cacheInfo.apiConfig.leaveCustomUrl.split("?")[1]?(v="?"+l.cacheInfo.apiConfig.leaveCustomUrl.split("?")[1]+"&"+g,l.cacheInfo.urlParams.leaveCustomUrl=l.cacheInfo.apiConfig.leaveCustomUrl.split("?")[0]+v):(v="?"+g,l.cacheInfo.urlParams.leaveCustomUrl=l.cacheInfo.apiConfig.leaveCustomUrl+v),"undefined"!=typeof u.wurlOpenStyle?l.cacheInfo.urlParams.wurlOpenStyle=u.wurlOpenStyle:l.cacheInfo.urlParams.wurlOpenStyle=!0,"undefined"!=typeof u.isCustomSysFlag&&u.wurl?l.cacheInfo.urlParams.isCustomSysFlag=u.isCustomSysFlag:l.cacheInfo.urlParams.isCustomSysFlag=l.cacheInfo.apiConfig.isCustomSysFlag,"undefined"!=typeof u.isLeaveCustomSysFlag?l.cacheInfo.urlParams.isLeaveCustomSysFlag=u.isLeaveCustomSysFlag:l.cacheInfo.urlParams.isLeaveCustomSysFlag=l.cacheInfo.apiConfig.isLeaveCustomSysFlag,"undefined"!=typeof u.msgflag?l.cacheInfo.urlParams.msgflag=u.msgflag:l.cacheInfo.urlParams.msgflag=l.cacheInfo.apiConfig.msgflag,"undefined"!=typeof u.isMessageFlag?l.cacheInfo.urlParams.isMessageFlag=u.isMessageFlag:l.cacheInfo.urlParams.isMessageFlag=l.cacheInfo.apiConfig.isMessageFlag,"undefined"!=typeof u.satDegree_A?l.cacheInfo.urlParams.satDegree_A=u.satDegree_A:l.cacheInfo.urlParams.satDegree_A=!0,"undefined"!=typeof u.isFeedBackFlag?l.cacheInfo.urlParams.isFeedBackFlag=u.isFeedBackFlag:l.cacheInfo.urlParams.isFeedBackFlag=l.cacheInfo.apiConfig.isFeedBackFlag,"undefined"!=typeof u.powered?l.cacheInfo.urlParams.designButton=u.powered:l.cacheInfo.urlParams.designButton=l.cacheInfo.apiConfig.designButton,"undefined"!=typeof u.emailShowFlag&&1!=l.cacheInfo.apiConfig.ticketStartWay?l.cacheInfo.urlParams.emailShowFlag=u.emailShowFlag:l.cacheInfo.urlParams.emailShowFlag=l.cacheInfo.apiConfig.emailShowFlag,"undefined"!=typeof u.emailFlag&&1!=l.cacheInfo.apiConfig.ticketStartWay?l.cacheInfo.urlParams.emailFlag=u.emailFlag:l.cacheInfo.urlParams.emailFlag=l.cacheInfo.apiConfig.emailFlag,"undefined"!=typeof u.telShowFlag&&2!=l.cacheInfo.apiConfig.ticketStartWay?l.cacheInfo.urlParams.telShowFlag=u.telShowFlag:l.cacheInfo.urlParams.telShowFlag=l.cacheInfo.apiConfig.telShowFlag,"undefined"!=typeof u.telFlag&&2!=l.cacheInfo.apiConfig.ticketStartWay?l.cacheInfo.urlParams.telFlag=u.telFlag:l.cacheInfo.urlParams.telFlag=l.cacheInfo.apiConfig.telFlag,l.cacheInfo.urlParams.enclosureShowFlag=l.cacheInfo.apiConfig.enclosureShowFlag,"undefined"!=typeof u.enclosureFlag?l.cacheInfo.urlParams.enclosureFlag=u.enclosureFlag:l.cacheInfo.urlParams.enclosureFlag=l.cacheInfo.apiConfig.enclosureFlag,"undefined"!=typeof u.realuateFlag?l.cacheInfo.urlParams.realuateFlag=u.realuateFlag:l.cacheInfo.urlParams.realuateFlag=l.cacheInfo.apiConfig.realuateFlag,"undefined"!=typeof u.robotHelloWord?l.cacheInfo.urlParams.robotHelloWord=u.robotHelloWord:l.cacheInfo.urlParams.robotHelloWord=l.cacheInfo.apiConfig.robotHelloWord,"undefined"!=typeof u.adminHelloWord?l.cacheInfo.urlParams.adminHelloWord=u.adminHelloWord:l.cacheInfo.urlParams.adminHelloWord=l.cacheInfo.apiConfig.adminHelloWord,l.cacheInfo.urlParams.serviceEndPushMsg=l.cacheInfo.apiConfig.serviceEndPushMsg,"undefined"!=typeof u.adminTipWord?l.cacheInfo.urlParams.adminTipWord=u.adminTipWord:l.cacheInfo.urlParams.adminTipWord=l.cacheInfo.apiConfig.adminTipWord,"undefined"!=typeof u.userTipWord?l.cacheInfo.urlParams.userTipWord=u.userTipWord:l.cacheInfo.urlParams.userTipWord=l.cacheInfo.apiConfig.userTipWord,"undefined"!=typeof u.adminNonelineTitle?l.cacheInfo.urlParams.adminNonelineTitle=u.adminNonelineTitle:l.cacheInfo.urlParams.adminNonelineTitle=l.cacheInfo.apiConfig.adminNonelineTitle,"undefined"!=typeof u.leaveMsgSendGroupIdFlag?l.cacheInfo.urlParams.leaveMsgSendGroupIdFlag=u.leaveMsgSendGroupIdFlag:l.cacheInfo.urlParams.leaveMsgSendGroupIdFlag=l.cacheInfo.apiConfig.leaveMsgSendGroupIdFlag,"undefined"!=typeof u.ticketTypeFlag?l.cacheInfo.urlParams.ticketTypeFlag=u.ticketTypeFlag:l.cacheInfo.urlParams.ticketTypeFlag=l.cacheInfo.apiConfig.ticketTypeFlag,"undefined"!=typeof u.ticketTypeId?l.cacheInfo.urlParams.ticketTypeId=u.ticketTypeId:l.cacheInfo.urlParams.ticketTypeId=l.cacheInfo.apiConfig.ticketTypeId,"undefined"!=typeof u.transferAction&&(l.cacheInfo.urlParams.transferAction=u.transferAction),"undefined"!=typeof u.summaryParams?l.cacheInfo.urlParams.summaryParams=u.summaryParams:l.cacheInfo.urlParams.summaryParams=l.cacheInfo.apiConfig.summaryParams;var y={partnerId:"partner_id",customerFields:"customer_fields",lan:"locale",artificial:"show_manual",moduleType:"type",aid:"agentid",groupId:"groupid",robotFlag:"robotid",msgflag:"msg_flag",isMessageFlag:"leave_msg_flag",satDegree_A:"feedback_flag",isFeedBackFlag:"feedback_flag",isCustomSysFlag:"to_customsys_flag",wurl:"to_customsys_url",wurlOpenStyle:"to_customsys_open_style",tranFlag:"agent_mode_flag",back:"top_bar_flag",guideFlag:"guide_flag",transferAction:"transfer_action",summaryParams:"summaryparams",tipTitle:"tip_title",submitBtnTitle:"submit_title",firstTimeout:"first_timeout",overTimeout:"over_timeout",inviteCount:"invite_count",title_info:"card_title",url_info:"card_url",abstract_info:"card_note",label_info:"card_desc",thumbnail_info:"card_picture",robotHelloWord:"robot_hello_word",adminHelloWord:"agent_hello_word",adminTipWord:"agent_tip_word",adminNonelineTitle:"agent_offline_title",userTipWord:"user_tip_word",preAbstract:"pre_abstract",preVisitUrl:"pre_visit_url",preVisitTitle:"pre_visit_title",preThumbnail:"pre_thumbnail",preTags:"pre_tags",curAbstract:"cur_abstract",curVisitUrl:"cur_visit_url",curVisitTitle:"cur_visit_title",pcurThumbnail:"cur_thumbnail",curTags:"cur_tags",channelFlag:"channelid"};$.each(y,function(e,i){if(l.cacheInfo.apiConfig[e]&&!l.cacheInfo.urlParams[e]&&(l.cacheInfo.urlParams[e]=l.cacheInfo.apiConfig[e]||""),l.cacheInfo.urlParams[i]){var t=l.cacheInfo.urlParams[i];"1"!=t&&"0"!=t&&"2"!=t||(t=Number(t)),l.cacheInfo.urlParams[e]=t}l.cacheInfo.apiConfig[e]&&("lan"===e?l.cacheInfo.apiConfig[e]=l.cacheInfo.urlParams[i]||l.cacheInfo.apiConfig[e]:l.cacheInfo.apiConfig[e]=l.cacheInfo.urlParams[i]||"")}),i.resolve()},error:function(e){alert("请求失败，请稍后再试")}}),i}).then(function(e,i){var i=i||new a,t=l.cacheInfo.urlParams;return 1===t.rput?$.ajax({type:"get",url:o.active_url,dataType:"json",timeout:3e3,data:{sysNum:t.sysnum,partnerId:t.partnerId||"",rpuc:t.rpuc||""},success:function(e){e&&"ok"===e.status?(l.cacheInfo.activeData=e,i.resolve(e.params)):i.resolve()}}):i.resolve(),i}).then(function(e,t){var t=t||new a,n="";return"[object Object]"===Object.prototype.toString.call(e)&&(n=JSON.stringify(e)),$.ajax({type:"post",url:o.init_url,dataType:"json",data:{ack:1,newFlag:1,sysNum:h(l.cacheInfo.sysnum),source:h(l.cacheInfo.userInfo.source),chooseAdminId:l.cacheInfo.urlParams.aid||"",tranFlag:l.cacheInfo.urlParams.tranFlag,groupId:h(l.cacheInfo.urlParams.groupId)||"",partnerId:h(""+l.cacheInfo.userInfo.partnerId),tel:h(l.cacheInfo.userInfo.tel),email:h(l.cacheInfo.userInfo.email),uname:h(l.cacheInfo.userInfo.uname),visitTitle:h(l.cacheInfo.userInfo.visitTitle),visitUrl:h(l.cacheInfo.userInfo.visitUrl),face:h(l.cacheInfo.userInfo.face),realname:h(l.cacheInfo.userInfo.realname),weibo:h(l.cacheInfo.userInfo.weibo),weixin:h(l.cacheInfo.userInfo.weixin),qq:h(l.cacheInfo.userInfo.qq),sex:h(l.cacheInfo.userInfo.sex),birthday:h(l.cacheInfo.userInfo.birthday),remark:h(l.cacheInfo.userInfo.remark),params:h(n||l.cacheInfo.userInfo.params),isReComment:h(1),customerFields:h(l.cacheInfo.userInfo.customer_fields),visitStartTime:h(l.cacheInfo.urlParams.visitStartTime||""),agid:l.cacheInfo.urlParams.uid,multiParams:h(l.cacheInfo.userInfo.multiParams),summaryParams:h(l.cacheInfo.urlParams.summaryParams),channelFlag:l.cacheInfo.urlParams.channelFlag||"",sign:l.cacheInfo.urlParams.sign},success:function(e){if(e&&3==e.ustatus)return void alert("当前用户被验证为非法用户，不能接入客服中心");var a=e.data?e.data:e;if(l.cacheInfo.apiInit=a,s(l.cacheInfo),0==l.cacheInfo.urlParams.msgflag||1==l.cacheInfo.urlParams.isMessageFlag){var n=v(l.cacheInfo.urlParams,l.cacheInfo),o=l.cacheInfo.language.lan;r?l.cacheInfo.apiConfig.leaveMsg=o.L10024.replace("{0}",n).replace("{1}",n):l.cacheInfo.apiConfig.leaveMsg=o.L10039,l.cacheInfo.apiConfig.leaveMsgUrl=n}else l.cacheInfo.apiConfig.leaveMsg="";if("iframe"!=l.cacheInfo.urlParams.from)if(0==l.cacheInfo.apiInit.privacyAgree)if("pc"===i)t.resolve();else{var c='<div class="privacy-proto-layer js-shadow-layer"><div class="content-wrap"><h1 class="title">'+l.cacheInfo.language.text.T0156+'</h1><div class="item">您在使用我们的客服功能时，我们可能会收集和使用您的相关信息。我们希望通过本政策向您，在使用我们的服务时，我们如何收集、使用、储存和分享这些信息。</div><div class="item">本政策与您所使用的我们的服务息息相关，希望您仔细阅读，在需要时，按照本政策的指引，作出您认为适当的选择。</div><a class="more" href="/clausetext.html" target="_blank">查看完整《用户隐私协议》</a><div class="footer"><a href="javascript:void(0);" class="js-privacy-cancel">'+l.cacheInfo.language.text.T0155+'</a><a href="javascript:void(0);" class="js-privacy-sure">'+l.cacheInfo.language.text.T0154+"</a></div></div></div>";layer=$(c),$(document.body).append(layer),layer.delegate(".js-privacy-sure","click",function(e){e.currentTarget;$.ajax({type:"post",url:"/chat-web/user/privacyAgree.action",dataType:"json",data:{uid:h(l.cacheInfo.apiInit.uid),agree:1},success:function(e){t.resolve(),layer.remove()}})}),layer.delegate(".js-privacy-cancel","click",function(e){e.currentTarget;$.ajax({type:"post",url:"/chat-web/user/privacyAgree.action",dataType:"json",data:{uid:h(l.cacheInfo.apiInit.uid),agree:0},success:function(e){t.resolve(),layer.remove()}})}),layer.delegate(".js-privacy-outer","click",function(e){e.stopPropagation(),e.preventDefault()})}else t.resolve();else t.resolve();l.cacheInfo.pageType=i}}),t}).then(function(e,i){var i=i||new a;if(u=l.cacheInfo.urlParams,l.cacheInfo.apiInit.userId&&"null"!==l.cacheInfo.apiInit.userId){var t=JSON.stringify({companyId:l.cacheInfo.apiInit.pid,customerId:l.cacheInfo.apiInit.userId});$.ajax({type:"post",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:l.cacheInfo.apiInit.uid,param:t,url:"ws/checkUserTicketInfo/4",method:"get"},success:function(e){l.cacheInfo.existFlag=e.item.existFlag,i.resolve()}})}else i.resolve();return i}).then(function(e,i){var i=i||new a;u=l.cacheInfo.urlParams,1===u.mflag?$.ajax({type:"post",url:o.multi_url,dataType:"json",timeout:3e3,data:{uid:l.cacheInfo.apiInit.uid,margs:l.cacheInfo.urlParams.margs||JSON.stringify({})},success:function(e){l.cacheInfo.multiGuideData=e,n.resolve(l.cacheInfo)}}):n.resolve(l.cacheInfo)})},T=function(){y()};return T(),n};i.exports=a},{"./comm.js":1,"./initText.js":4,"./util/promise.js":36}],4:[function(e,i,t){function a(e){var i=s(e);n(i),e.language.lan=i.system,e.language.text=i.text}var s=e("./locale.js"),n=function(e){for(var i=[".js-text-return-btn",".js-text-pulldown",".js-text-transfer-btn",".js-text-sendBtn",".js-text-upload-btn",".js-text-comment-btn",".js-text-satisfition-btn",".js-text-conversation-btn",".js-text-submit-btn",".js-text-success-btn",".js-text-contact",".js-text-ok-btn"],t=0;t<i.length;t++){var a=i[t],s=$(a),n=e.html["HTML_MSG0"+t];s.text(n).attr("placeholder",n)}$(".js-text-tel").html(e.html.HTML_MSG18);for(var o=[".js-pulldown-text",".js-text-chatSwitch",".js-text-send",".js-text-satisfaction",".js-text-newMessage",".js-text-leaveMessage"],t=0;t<o.length;t++){var a=o[t],s=$(a),n=e.html["HTML_MSG01"+(t+12)];s.text(n)}};i.exports=a},{"./locale.js":6}],5:[function(e,i,t){!function(e,a){Array.prototype.map||(Array.prototype.map=function(e,i){var t,a,s;if(null==this)throw new TypeError(" this is null or not defined");var n=Object(this),o=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(i&&(t=i),a=new Array(o),s=0;s<o;){var r,l;s in n&&(r=n[s],l=e.call(t,r,s,n),a[s]=l),s++}return a});var s=e.detect=function(){var e=function(){},i={browser_parsers:[{regex:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",family_replacement:"Wii",manufacturer:"Nintendo"},{regex:"(SeaMonkey|Camino)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Camino",other:!0},{regex:"(Pale[Mm]oon)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Pale Moon (Firefox Variant)",other:!0},{regex:"(Fennec)/(\\d+)\\.(\\d+)\\.?([ab]?\\d+[a-z]*)",family_replacement:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)(pre)",family_replacment:"Firefox Mobile"},{regex:"(Fennec)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"Mobile.*(Firefox)/(\\d+)\\.(\\d+)",family_replacement:"Firefox Mobile"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",family_replacement:"Firefox ($1)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(a\\d+[a-z]*)",family_replacement:"Firefox Alpha"},{regex:"(Firefox)-(?:\\d+\\.\\d+)?/(\\d+)\\.(\\d+)(b\\d+[a-z]*)",family_replacement:"Firefox Beta"},{regex:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",family_replacement:"Firefox ($1)"},{regex:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"MicroB",tablet:!0},{regex:"(MozillaDeveloperPreview)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?"},{regex:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)",family_replacement:"Flock",other:!0},{regex:"(RockMelt)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Rockmelt",other:!0},{regex:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",family_replacement:"Netscape"},{regex:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Netscape"},{regex:"(MyIBrow)/(\\d+)\\.(\\d+)",family_replacement:"My Internet Browser",other:!0},{regex:"(Opera Tablet).*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera Tablet",tablet:!0},{regex:"(Opera)/.+Opera Mobi.+Version/(\\d+)\\.(\\d+)",family_replacement:"Opera Mobile"},{regex:"Opera Mobi",family_replacement:"Opera Mobile"},{regex:"(Opera Mini)/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera Mini)/att/(\\d+)\\.(\\d+)",family_replacement:"Opera Mini"},{regex:"(Opera)/9.80.*Version/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(OPR)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",family_replacement:"Opera"},{regex:"(webOSBrowser)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(webOS)/(\\d+)\\.(\\d+)",family_replacement:"webOS"},{regex:"(wOSBrowser).+TouchPad/(\\d+)\\.(\\d+)",family_replacement:"webOS TouchPad"},{regex:"(luakit)",family_replacement:"LuaKit",other:!0},{regex:"(Lightning)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)",family_replacement:"Lightning",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",family_replacement:"Swiftfox",other:!0},{regex:"rekonq",family_replacement:"Rekonq",other:!0},{regex:"(conkeror|Conkeror)/(\\d+)\\.(\\d+)\\.?(\\d+)?",family_replacement:"Conkeror",other:!0},{regex:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Konqueror",other:!0},{regex:"(WeTab)-Browser",family_replacement:"WeTab",other:!0},{regex:"(Comodo_Dragon)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Comodo Dragon",other:!0},{regex:"(YottaaMonitor)",family_replacement:"Yottaa Monitor",other:!0},{regex:"(Kindle)/(\\d+)\\.(\\d+)",family_replacement:"Kindle"},{regex:"(Symphony) (\\d+).(\\d+)",family_replacement:"Symphony",other:!0},{regex:"Minimo",family_replacement:"Minimo",other:!0},{regex:"(Edge)/(\\d+)\\.(\\d+)",family_replacement:"Edge"},{regex:"(CrMo)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile"},{regex:"(CriOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Mobile iOS"},{regex:"(Chrome)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) Mobile",family_replacement:"Chrome Mobile"},{regex:"(chromeframe)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Chrome Frame"},{regex:"(UC Browser)(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"UC Browser",other:!0},{regex:"(SLP Browser)/(\\d+)\\.(\\d+)",family_replacement:"Tizen Browser",other:!0},{regex:"(Epiphany)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"Epiphany",other:!0},{regex:"(SE 2\\.X) MetaSr (\\d+)\\.(\\d+)",family_replacement:"Sogou Explorer",other:!0},{regex:"(Pingdom.com_bot_version_)(\\d+)\\.(\\d+)",family_replacement:"PingdomBot",other:!0},{regex:"(facebookexternalhit)/(\\d+)\\.(\\d+)",family_replacement:"FacebookBot"},{regex:"(Twitterbot)/(\\d+)\\.(\\d+)",family_replacement:"TwitterBot"},{regex:"(AdobeAIR|Chromium|FireWeb|Jasmine|ANTGalio|Midori|Fresco|Lobo|PaleMoon|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|WebPilot|NetFront|Netfront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|ThunderBrowse|Iron|Iris|UP\\.Browser|Bunjaloo|Google Earth|Raven for Mac)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Bolt|Jasmine|IceCat|Skyfire|Midori|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|NetFront|Netfront|Konqueror|Googlebot|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca|Dolfin|BOLT|Minimo|Tizen Browser|Polaris)/(\\d+)\\.(\\d+)"},{regex:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(iCab|Lunascape|Opera|Android|Jasmine|Polaris|BREW) (\\d+)\\.(\\d+)\\.?(\\d+)?"},{regex:"(Android) Donut",v2_replacement:"2",v1_replacement:"1"},{regex:"(Android) Eclair",v2_replacement:"1",v1_replacement:"2"},{regex:"(Android) Froyo",v2_replacement:"2",v1_replacement:"2"},{regex:"(Android) Gingerbread",v2_replacement:"3",v1_replacement:"2"},{regex:"(Android) Honeycomb",v1_replacement:"3"},{regex:"(IEMobile)[ /](\\d+)\\.(\\d+)",family_replacement:"IE Mobile"},{regex:"(MSIE) (\\d+)\\.(\\d+).*XBLWP7",family_replacement:"IE Large Screen"},{regex:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{regex:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{regex:"(Obigo)InternetBrowser",other:!0},{regex:"(Obigo)\\-Browser",other:!0},{regex:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",other:!0},{regex:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",family_replacement:"Maxthon",other:!0},{regex:"(Maxthon|MyIE2|Uzbl|Shiira)",v1_replacement:"0",other:!0},{regex:"(PLAYSTATION) (\\d+)",family_replacement:"PlayStation",manufacturer:"Sony"},{regex:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)",manufacturer:"Sony"},{regex:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(POLARIS)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(Embider)/(\\d+)\\.(\\d+)",family_replacement:"Polaris",other:!0},{regex:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Bon Echo",other:!0},{regex:"(iPod).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPod)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPhone)",family_replacement:"Mobile Safari",manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad).*Version/(\\d+)\\.(\\d+)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(iPad)",family_replacement:"Mobile Safari",tablet:!0,manufacturer:"Apple"},{regex:"(AvantGo) (\\d+).(\\d+)",other:!0},{regex:"(Avant)",v1_replacement:"1",other:!0},{regex:"^(Nokia)",family_replacement:"Nokia Services (WAP) Browser",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+).(\\d+)",manufacturer:"Nokia"},{regex:"(NokiaBrowser)/(\\d+)\\.(\\d+)",manufacturer:"Nokia"},{regex:"(BrowserNG)/(\\d+)\\.(\\d+).(\\d+)",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/5\\.0",v2_replacement:"0",v1_replacement:"7",family_replacement:"NokiaBrowser",manufacturer:"Nokia"},{regex:"(Series60)/(\\d+)\\.(\\d+)",family_replacement:"Nokia OSS Browser",manufacturer:"Nokia"},{regex:"(S40OviBrowser)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Nokia Series 40 Ovi Browser",manufacturer:"Nokia"},{regex:"(Nokia)[EN]?(\\d+)",manufacturer:"Nokia"},{regex:"(PlayBook).+RIM Tablet OS (\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",tablet:!0,manufacturer:"Nokia"},{regex:"(Black[bB]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)",family_replacement:"Blackberry WebKit",manufacturer:"RIM"},{regex:"(Black[bB]erry)\\s?(\\d+)",family_replacement:"Blackberry",manufacturer:"RIM"},{regex:"(OmniWeb)/v(\\d+)\\.(\\d+)",other:!0},{regex:"(Blazer)/(\\d+)\\.(\\d+)",family_replacement:"Palm Blazer",manufacturer:"Palm"},{regex:"(Pre)/(\\d+)\\.(\\d+)",family_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Links) \\((\\d+)\\.(\\d+)",other:!0},{regex:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)",other:!0},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",other:!0,tablet:!0},{regex:"(AppleWebKit)/(\\d+)\\.?(\\d+)?\\+ .* Version/\\d+\\.\\d+.\\d+ Safari/",family_replacement:"WebKit Nightly"},{regex:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",family_replacement:"Safari"},{regex:"(Safari)/\\d+"},{regex:"(OLPC)/Update(\\d+)\\.(\\d+)",other:!0},{regex:"(OLPC)/Update()\\.(\\d+)",v1_replacement:"0",other:!0},{regex:"(SEMC\\-Browser)/(\\d+)\\.(\\d+)",
other:!0},{regex:"(Teleca)",family_replacement:"Teleca Browser",other:!0},{regex:"Trident(.*)rv.(\\d+)\\.(\\d+)",family_replacement:"IE"},{regex:"(MSIE) (\\d+)\\.(\\d+)",family_replacement:"IE"}],os_parsers:[{regex:"(Android) (\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android)\\-(\\d+)\\.(\\d+)(?:[.\\-]([a-z0-9]+))?"},{regex:"(Android) Donut",os_v2_replacement:"2",os_v1_replacement:"1"},{regex:"(Android) Eclair",os_v2_replacement:"1",os_v1_replacement:"2"},{regex:"(Android) Froyo",os_v2_replacement:"2",os_v1_replacement:"2"},{regex:"(Android) Gingerbread",os_v2_replacement:"3",os_v1_replacement:"2"},{regex:"(Android) Honeycomb",os_v1_replacement:"3"},{regex:"(Silk-Accelerated=[a-z]{4,5})",os_replacement:"Android"},{regex:"(Windows Phone 6\\.5)"},{regex:"(Windows (?:NT 5\\.2|NT 5\\.1))",os_replacement:"Windows XP"},{regex:"(XBLWP7)",os_replacement:"Windows Phone OS"},{regex:"(Windows NT 6\\.1)",os_replacement:"Windows 7"},{regex:"(Windows NT 6\\.0)",os_replacement:"Windows Vista"},{regex:"(Windows 98|Windows XP|Windows ME|Windows 95|Windows CE|Windows 7|Windows NT 4\\.0|Windows Vista|Windows 2000)"},{regex:"(Windows NT 6\\.4|Windows NT 10\\.0)",os_replacement:"Windows 10"},{regex:"(Windows NT 6\\.2)",os_replacement:"Windows 8"},{regex:"(Windows Phone 8)",os_replacement:"Windows Phone 8"},{regex:"(Windows NT 5\\.0)",os_replacement:"Windows 2000"},{regex:"(Windows Phone OS) (\\d+)\\.(\\d+)"},{regex:"(Windows ?Mobile)",os_replacement:"Windows Mobile"},{regex:"(WinNT4.0)",os_replacement:"Windows NT 4.0"},{regex:"(Win98)",os_replacement:"Windows 98"},{regex:"(Tizen)/(\\d+)\\.(\\d+)",other:!0},{regex:"(Mac OS X) (\\d+)[_.](\\d+)(?:[_.](\\d+))?",manufacturer:"Apple"},{regex:"(?:PPC|Intel) (Mac OS X)",manufacturer:"Apple"},{regex:"(CPU OS|iPhone OS) (\\d+)_(\\d+)(?:_(\\d+))?",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod); Opera",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(iPad); Opera",tablet:!0,manufacturer:"Apple"},{regex:"(iPhone|iPad|iPod).*Mac OS X.*Version/(\\d+)\\.(\\d+)",os_replacement:"iOS",manufacturer:"Apple"},{regex:"(CrOS) [a-z0-9_]+ (\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"Chrome OS"},{regex:"(Debian)-(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Linux Mint)(?:/(\\d+))?",other:!0},{regex:"(Mandriva)(?: Linux)?/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",other:!0},{regex:"(Symbian[Oo][Ss])/(\\d+)\\.(\\d+)",os_replacement:"Symbian OS"},{regex:"(Symbian/3).+NokiaBrowser/7\\.3",os_replacement:"Symbian^3 Anna"},{regex:"(Symbian/3).+NokiaBrowser/7\\.4",os_replacement:"Symbian^3 Belle"},{regex:"(Symbian/3)",os_replacement:"Symbian^3"},{regex:"(Series 60|SymbOS|S60)",os_replacement:"Symbian OS"},{regex:"(MeeGo)",other:!0},{regex:"Symbian [Oo][Ss]",os_replacement:"Symbian OS"},{regex:"(Black[Bb]erry)[0-9a-z]+/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(Black[Bb]erry).+Version/(\\d+)\\.(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"BlackBerry OS",manufacturer:"RIM"},{regex:"(RIM Tablet OS) (\\d+)\\.(\\d+)\\.(\\d+)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Play[Bb]ook)",os_replacement:"BlackBerry Tablet OS",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry)",os_replacement:"Blackberry OS",manufacturer:"RIM"},{regex:"(webOS|hpwOS)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?",os_replacement:"webOS"},{regex:"(SUSE|Fedora|Red Hat|PCLinuxOS)/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(SUSE|Fedora|Red Hat|Puppy|PCLinuxOS|CentOS)/(\\d+)\\.(\\d+)\\.(\\d+)",other:!0},{regex:"(Ubuntu|Kindle|Bada|Lubuntu|BackTrack|Red Hat|Slackware)/(\\d+)\\.(\\d+)"},{regex:"(Windows|OpenBSD|FreeBSD|NetBSD|Ubuntu|Kubuntu|Android|Arch Linux|CentOS|WeTab|Slackware)"},{regex:"(Linux|BSD)",other:!0}],mobile_os_families:["Windows Phone 6.5","Windows CE","Symbian OS"],device_parsers:[{regex:"HTC ([A-Z][a-z0-9]+) Build",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Z][a-z0-9 ]+) \\d+\\.\\d+\\.\\d+\\.\\d+",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_Touch_([A-Za-z0-9]+)",device_replacement:"HTC Touch ($1)",manufacturer:"HTC"},{regex:"USCCHTC(\\d+)",device_replacement:"HTC $1 (US Cellular)",manufacturer:"HTC"},{regex:"Sprint APA(9292)",device_replacement:"HTC $1 (Sprint)",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+ [A-Z])",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC-([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC_([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"HTC ([A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(ADR[A-Za-z0-9]+)",device_replacement:"HTC $1",manufacturer:"HTC"},{regex:"(HTC)",manufacturer:"HTC"},{regex:"SonyEricsson([A-Za-z0-9]+)/",device_replacement:"Ericsson $1",other:!0,manufacturer:"Sony"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; WOWMobile (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\-update1\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\; [A-Za-z]{2}\\-[A-Za-z]{2}\\; (.+) Build"},{regex:"Android[\\- ][\\d]+\\.[\\d]+\\.[\\d]+; (.+) Build"},{regex:"NokiaN([0-9]+)",device_replacement:"Nokia N$1",manufacturer:"Nokia"},{regex:"Nokia([A-Za-z0-9\\v-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"NOKIA ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Nokia ([A-Za-z0-9\\-]+)",device_replacement:"Nokia $1",manufacturer:"Nokia"},{regex:"Lumia ([A-Za-z0-9\\-]+)",device_replacement:"Lumia $1",manufacturer:"Nokia"},{regex:"Symbian",device_replacement:"Nokia",manufacturer:"Nokia"},{regex:"(PlayBook).+RIM Tablet OS",device_replacement:"Blackberry Playbook",tablet:!0,manufacturer:"RIM"},{regex:"(Black[Bb]erry [0-9]+);",manufacturer:"RIM"},{regex:"Black[Bb]erry([0-9]+)",device_replacement:"BlackBerry $1",manufacturer:"RIM"},{regex:"(Pre)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pre",manufacturer:"Palm"},{regex:"(Pixi)/(\\d+)\\.(\\d+)",device_replacement:"Palm Pixi",manufacturer:"Palm"},{regex:"(Touchpad)/(\\d+)\\.(\\d+)",device_replacement:"HP Touchpad",manufacturer:"HP"},{regex:"HPiPAQ([A-Za-z0-9]+)/(\\d+).(\\d+)",device_replacement:"HP iPAQ $1",manufacturer:"HP"},{regex:"Palm([A-Za-z0-9]+)",device_replacement:"Palm $1",manufacturer:"Palm"},{regex:"Treo([A-Za-z0-9]+)",device_replacement:"Palm Treo $1",manufacturer:"Palm"},{regex:"webOS.*(P160UNA)/(\\d+).(\\d+)",device_replacement:"HP Veer",manufacturer:"HP"},{regex:"(Kindle Fire)",manufacturer:"Amazon"},{regex:"(Kindle)",manufacturer:"Amazon"},{regex:"(Silk)/(\\d+)\\.(\\d+)(?:\\.([0-9\\-]+))?",device_replacement:"Kindle Fire",tablet:!0,manufacturer:"Amazon"},{regex:"(iPad) Simulator;",manufacturer:"Apple"},{regex:"(iPad);",manufacturer:"Apple"},{regex:"(iPod);",manufacturer:"Apple"},{regex:"(iPhone) Simulator;",manufacturer:"Apple"},{regex:"(iPhone);",manufacturer:"Apple"},{regex:"Nexus\\ ([A-Za-z0-9\\-]+)",device_replacement:"Nexus $1"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"acer_([A-Za-z0-9]+)_",device_replacement:"Acer $1",manufacturer:"Acer"},{regex:"Amoi\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"AMOI\\-([A-Za-z0-9]+)",device_replacement:"Amoi $1",other:!0,manufacturer:"Amoi"},{regex:"Asus\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"ASUS\\-([A-Za-z0-9]+)",device_replacement:"Asus $1",manufacturer:"Asus"},{regex:"BIRD\\-([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD\\.([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"BIRD ([A-Za-z0-9]+)",device_replacement:"Bird $1",other:!0},{regex:"Dell ([A-Za-z0-9]+)",device_replacement:"Dell $1",manufacturer:"Dell"},{regex:"DoCoMo/2\\.0 ([A-Za-z0-9]+)",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\_W\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"([A-Za-z0-9]+)\\;FOMA",device_replacement:"DoCoMo $1",other:!0},{regex:"vodafone([A-Za-z0-9]+)",device_replacement:"Huawei Vodafone $1",other:!0},{regex:"i\\-mate ([A-Za-z0-9]+)",device_replacement:"i-mate $1",other:!0},{regex:"Kyocera\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"KWC\\-([A-Za-z0-9]+)",device_replacement:"Kyocera $1",other:!0},{regex:"Lenovo\\-([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Lenovo"},{regex:"Lenovo\\_([A-Za-z0-9]+)",device_replacement:"Lenovo $1",manufacturer:"Levovo"},{regex:"LG/([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE-LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE VX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG ([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE LG\\-AX([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LGE\\-([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"LG([A-Za-z0-9]+)",device_replacement:"LG $1",manufacturer:"LG"},{regex:"(KIN)\\.One (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(KIN)\\.Two (\\d+)\\.(\\d+)",device_replacement:"Microsoft $1"},{regex:"(Motorola)\\-([A-Za-z0-9]+)",manufacturer:"Motorola"},{regex:"MOTO\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"MOT\\-([A-Za-z0-9]+)",device_replacement:"Motorola $1",manufacturer:"Motorola"},{regex:"Philips([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"Philips ([A-Za-z0-9]+)",device_replacement:"Philips $1",manufacturer:"Philips"},{regex:"SAMSUNG-([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"SAMSUNG\\; ([A-Za-z0-9\\-]+)",device_replacement:"Samsung $1",manufacturer:"Samsung"},{regex:"Softbank/1\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"Softbank/2\\.0/([A-Za-z0-9]+)",device_replacement:"Softbank $1",other:!0},{regex:"(hiptop|avantgo|plucker|xiino|blazer|elaine|up.browser|up.link|mmp|smartphone|midp|wap|vodafone|o2|pocket|mobile|pda)",device_replacement:"Generic Smartphone"},{regex:"^(1207|3gso|4thp|501i|502i|503i|504i|505i|506i|6310|6590|770s|802s|a wa|acer|acs\\-|airn|alav|asus|attw|au\\-m|aur |aus |abac|acoo|aiko|alco|alca|amoi|anex|anny|anyw|aptu|arch|argo|bell|bird|bw\\-n|bw\\-u|beck|benq|bilb|blac|c55/|cdm\\-|chtm|capi|comp|cond|craw|dall|dbte|dc\\-s|dica|ds\\-d|ds12|dait|devi|dmob|doco|dopo|el49|erk0|esl8|ez40|ez60|ez70|ezos|ezze|elai|emul|eric|ezwa|fake|fly\\-|fly\\_|g\\-mo|g1 u|g560|gf\\-5|grun|gene|go.w|good|grad|hcit|hd\\-m|hd\\-p|hd\\-t|hei\\-|hp i|hpip|hs\\-c|htc |htc\\-|htca|htcg)",device_replacement:"Generic Feature Phone"},{regex:"^(htcp|htcs|htct|htc\\_|haie|hita|huaw|hutc|i\\-20|i\\-go|i\\-ma|i230|iac|iac\\-|iac/|ig01|im1k|inno|iris|jata|java|kddi|kgt|kgt/|kpt |kwc\\-|klon|lexi|lg g|lg\\-a|lg\\-b|lg\\-c|lg\\-d|lg\\-f|lg\\-g|lg\\-k|lg\\-l|lg\\-m|lg\\-o|lg\\-p|lg\\-s|lg\\-t|lg\\-u|lg\\-w|lg/k|lg/l|lg/u|lg50|lg54|lge\\-|lge/|lynx|leno|m1\\-w|m3ga|m50/|maui|mc01|mc21|mcca|medi|meri|mio8|mioa|mo01|mo02|mode|modo|mot |mot\\-|mt50|mtp1|mtv |mate|maxo|merc|mits|mobi|motv|mozz|n100|n101|n102|n202|n203|n300|n302|n500|n502|n505|n700|n701|n710|nec\\-|nem\\-|newg|neon)",device_replacement:"Generic Feature Phone"},{regex:"^(netf|noki|nzph|o2 x|o2\\-x|opwv|owg1|opti|oran|ot\\-s|p800|pand|pg\\-1|pg\\-2|pg\\-3|pg\\-6|pg\\-8|pg\\-c|pg13|phil|pn\\-2|pt\\-g|palm|pana|pire|pock|pose|psio|qa\\-a|qc\\-2|qc\\-3|qc\\-5|qc\\-7|qc07|qc12|qc21|qc32|qc60|qci\\-|qwap|qtek|r380|r600|raks|rim9|rove|s55/|sage|sams|sc01|sch\\-|scp\\-|sdk/|se47|sec\\-|sec0|sec1|semc|sgh\\-|shar|sie\\-|sk\\-0|sl45|slid|smb3|smt5|sp01|sph\\-|spv |spv\\-|sy01|samm|sany|sava|scoo|send|siem|smar|smit|soft|sony|t\\-mo|t218|t250|t600|t610|t618|tcl\\-|tdg\\-|telm|tim\\-|ts70|tsm\\-|tsm3|tsm5|tx\\-9|tagt)",device_replacement:"Generic Feature Phone"},{regex:"^(talk|teli|topl|tosh|up.b|upg1|utst|v400|v750|veri|vk\\-v|vk40|vk50|vk52|vk53|vm40|vx98|virg|vite|voda|vulc|w3c |w3c\\-|wapj|wapp|wapu|wapm|wig |wapi|wapr|wapv|wapy|wapa|waps|wapt|winc|winw|wonu|x700|xda2|xdag|yas\\-|your|zte\\-|zeto|aste|audi|avan|blaz|brew|brvw|bumb|ccwa|cell|cldc|cmd\\-|dang|eml2|fetc|hipt|http|ibro|idea|ikom|ipaq|jbro|jemu|jigs|keji|kyoc|kyok|libw|m\\-cr|midp|mmef|moto|mwbp|mywa|newt|nok6|o2im|pant|pdxg|play|pluc|port|prox|rozo|sama|seri|smal|symb|treo|upsi|vx52|vx53|vx60|vx61|vx70|vx80|vx81|vx83|vx85|wap\\-|webc|whit|wmlb|xda\\-|xda\\_)",device_replacement:"Generic Feature Phone"},{regex:"(bot|borg|google(^tv)|yahoo|slurp|msnbot|msrbot|openbot|archiver|netresearch|lycos|scooter|altavista|teoma|gigabot|baiduspider|blitzbot|oegp|charlotte|furlbot|http%20client|polybot|htdig|ichiro|mogimogi|larbin|pompos|scrubby|searchsight|seekbot|semanticdiscovery|silk|snappy|speedy|spider|voila|vortex|voyager|zao|zeal|fast\\-webcrawler|converacrawler|dataparksearch|findlinks)",device_replacement:"Spider"}],mobile_browser_families:["Firefox Mobile","Opera Mobile","Opera Mini","Mobile Safari","webOS","IE Mobile","Playstation Portable","Nokia","Blackberry","Palm","Silk","Android","Maemo","Obigo","Netfront","AvantGo","Teleca","SEMC-Browser","Bolt","Iris","UP.Browser","Symphony","Minimo","Bunjaloo","Jasmine","Dolfin","Polaris","BREW","Chrome Mobile","Chrome Mobile iOS","UC Browser","Tizen Browser"]};e.parsers=["device_parsers","browser_parsers","os_parsers","mobile_os_families","mobile_browser_families"],e.types=["browser","os","device"],e.regexes=i||function(){var i={};return e.parsers.map(function(e){i[e]=[]}),i}(),e.families=function(){var i={};return e.types.map(function(e){i[e]=[]}),i}();var t=Array.prototype,a=(Object.prototype,Function.prototype,t.forEach),s=(t.indexOf,function(e,i){for(var t={},a=0;a<i.length&&!(t=i[a](e));a++);return t}),n=function(e,i){o(e,function(e){o(i,function(i){delete e[i]})})},o=forEach=function(e,i,t){if(null!=e)if(a&&e.forEach===a)e.forEach(i,t);else if(e.length===+e.length)for(var s=0,n=e.length;s<n;s++)i.call(t,e[s],s,e);else for(var o in e)_.has(e,o)&&i.call(t,e[o],o,e)},r=function(e){return!(!e||"undefined"==typeof e||null==e)},l=function(e){var i="";return e=e||{},r(e)&&r(e.major)&&(i+=e.major,r(e.minor)&&(i+="."+e.minor,r(e.patch)&&(i+="."+e.patch))),i},c=function(e){e=e||{};var i=l(e);return i&&(i=" "+i),e&&r(e.family)?e.family+i:""};return e.parse=function(i){var t=function(i){return e.regexes[i+"_parsers"].map(function(e){function t(i){var t=i.match(a);if(!t)return null;var o={};return o.family=(s?s.replace("$1",t[1]):t[1])||"other",o.major=parseInt(n?n:t[2])||null,o.minor=t[3]?parseInt(t[3]):null,o.patch=t[4]?parseInt(t[4]):null,o.tablet=e.tablet,o.man=e.manufacturer||null,o}var a=new RegExp(e.regex),s=e[("browser"===i?"family":i)+"_replacement"],n=e.major_version_replacement;return t})},a=function(){},o=t("browser"),d=t("os"),u=t("device"),f=new a;f.source=i,f.browser=s(i,o),r(f.browser)?(f.browser.name=c(f.browser),f.browser.version=l(f.browser)):f.browser={},f.os=s(i,d),r(f.os)?(f.os.name=c(f.os),f.os.version=l(f.os)):f.os={},f.device=s(i,u),r(f.device)?(f.device.name=c(f.device),f.device.version=l(f.device)):f.device={tablet:!1,family:"Other"};var p={};e.regexes.mobile_browser_families.map(function(e){p[e]=!0}),e.regexes.mobile_os_families.map(function(e){p[e]=!0});return"Spider"===f.browser.family?f.device.type="Spider":f.browser.tablet||f.os.tablet||f.device.tablet?f.device.type="Tablet":p.hasOwnProperty(f.browser.family)?f.device.type="Mobile":f.device.type="Desktop",f.device.manufacturer=f.browser.man||f.os.man||f.device.man||null,n([f.browser,f.os,f.device],["tablet","man"]),f},e}();"undefined"!=typeof t&&("undefined"!=typeof i&&i.exports&&(t=i.exports=s),t.detect=s)}(window)},{}],6:[function(e,i,t){function a(e){for(var i=e.urlParams.lan||"cn",t=!1,a=0;a<o.length;a++)if(o[a]==i){t=!0;break}switch(t||(i="cn"),i){case"cn":return s;case"en":return n}}var s=e("./locale/zh-cn.json"),n=e("./locale/en.json"),o=["cn","en"];i.exports=a},{"./locale/en.json":7,"./locale/zh-cn.json":8}],7:[function(e,i,t){i.exports={html:{HTML_MSG00:"Back",HTML_MSG01:"Load more record",HTML_MSG02:"Manual",HTML_MSG03:"Send",HTML_MSG04:"Photos",HTML_MSG05:"Feedback",HTML_MSG06:"Feedback",HTML_MSG07:"Continue",HTML_MSG08:"Submit",HTML_MSG09:"The email has been sent successfully",HTML_MSG010:"The team will contact you soon",HTML_MSG011:"OK",HTML_MSG0112:"Load more record",HTML_MSG0113:"Manual",HTML_MSG0114:"Send",HTML_MSG0115:"Feedback",HTML_MSG0116:"Continue",HTML_MSG0117:"Email",HTML_MSG0118:"Tel"},system:{L10001:"Sorry, the team is not in service right now ",L10002:"{0} is at your service ",L10003:"Conversation has ended temporarily,{0} ",L10004:"Please wait, there are {0} people in need of service before you ",L10005:"You haven't been talking for long time ",L10006:'<a href="javascript: window.location.reload();">Continue</a> ',L10007:"Conversation with {0} has been ended temporarily {1} ",L10008:"Conversation with {0} has been ended temporarily {1} ",L10009:"Conversation with {0} has been ended temporarily ",L10010:"Conversation has been ended temporarily.{0} ",L10011:"{0} You have opened a new window {1}",L10012:"No more record",L10013:"Sorry, the team is not in service right now ",L10014:"Image size can not exceed 5M",L10015:"This file type is not supported",L10016:"Loading...",L10017:"Loading...",L10018:"Load more record",L10019:"{0} is at your service",L10020:"\b{0} is typing",L10021:"Conversation with {0} has been ended temporarily",L10022:'{0} You can also send us an <a href="javascript: void(0);" id="systemMsgLeaveMessage"> email </a>',L10023:'{0} <span  id="systemMsgLeaveMsg">Please wait...</span>',L10024:'You can also send us an <a class="leave-msg-btn" href="{0}" data-href="{1}"> email </a>',L10025:"Service Unavailable",L10026:"Waiting",L10027:"Sorry, the team is not in service right now",L10028:"Conversation with {0} has been ended temporarily",L10029:"You haven't been talking for long time",L10030:"You've opened a new window",L10031:"Conversation has been ended temporarily",L10032:"Please try to describe your problem in other ways",L10033:"This file type is not supported",L10034:"Image size can not exceed 5M",L10035:"Please try another browser",L10036:"Sending...",L10037:"Thank you",L10038:"Failure, please try again",L10039:'You can also send us an <a class="leave-msg-btn js-leaveMessage" href="javascript:void(0);" > email </a>',L10040:"The customer service {0} withdrew a message",L10041:"Reminder, This information may have a risk",L10042:"problem description up to 5000 code",L10043:"Netork Error,Please reload this page. "},text:{T0000:"Cancel",T0001:"OK",T0002:"Load more record",T0003:"Loading····",T0004:"No more record",T0005:"Yes",T0006:"No",T0010:"What do you need?",T0011:"Today",T0012:"Customer Support_",T0013:"Yesterday",T0020:"Customer Service is typing",T0021:"Are you satisfied with our service?",T0022:"Are you satisfied with our service?",T0023:"Send a massage",T0024:"Please wait...",T0025:"We've received your feedback",T0026:"You need to ask questions before feedback",T0027:"What is the problem?",T0028:"Tell us your suggestion",T0029:"Submit",T0030:"Email",T0031:"Sending···",T0032:"Thank you",T0033:"Failure, please try again",T0034:"Email@domain.com (required)",T0035:"Email doesn't look quite right",T0036:"Email doesn't look quite right",T0037:"The description is needed",T0038:"Continue",T0039:"Submit email",T0040:"Email",T0041:"Yes",T0042:"No",T0043:"Feedback",T0044:"Tel",T0045:"tel is not correct",T0046:" (required)",T0047:"",T0048:"Send a massage",T0049:"qq Face",T0050:"upload",T0051:"Email",T0052:"Feedback",T0053:"Email@domain.com",T0054:"telphone",T0055:"telphone(optional)",T0056:"The email has been sent successfully",T0057:"Powered by Sobot",T0058:" new messages",T0059:"new messages",T0060:"Manual",T0061:"Company:",T0062:"Email:",T0063:"serviceNo:",T0064:"Name:",T0065:"Remark:",T0066:"Tel:",T0067:"phone:",T0068:"open",T0069:"close",T0070:"Thank You",T0071:"Sorry",T0072:"Session end",T0073:"Error",T0074:"Already evaluated",T0075:"Upload Error",T0076:"Please Upload Files",T0077:"Maximum upload file size",T0078:"Upload file is not supported",T0079:"Image size can not exceed 5M",T0080:"Please Upload Image",T0081:"This file type is not supported",T0082:"file size can not exceed 20M",T0083:"upload...",T0084:"upload failed",T0085:"upload attachments",T0086:"Maximum upload 5",T0087:"Confirm closing?",T0088:"Ignore upload failed files?",T0089:"Continue",T0090:"Uploading",T0091:"Ignore upload failed Images?",T0092:"Email@domain.com(optional)",T0093:"Feedback",T0094:"Tell us about your problems?",T0095:"Submit",T0096:"Feedback",T0097:"Not evaluate",T0098:"Whether to solve the problem?",T0099:"title",T0100:"abstract",T0101:"label",T0102:"url",T0103:"Please rate the service",T0104:"Please choose tag",T0105:"evaluate can't be blank",T0106:"Has your question been resolved?",T0107:"Your evaluation will make us do better",T0108:"Please Fill ",T0109:"Types",T0110:"Problem Description",T0111:"close",T0112:"Return",T0113:"Choose minutes",T0114:"Choose hours",T0115:"hours",T0116:"minutes",T0117:"Please fill in the description of the problem",T0118:"Select",T0119:"Customer Service is typing",T0120:"Submit",T0121:"province",T0122:"city",T0123:"country",T0124:"is not correct",T0125:"email is not correct",T0126:"please fill in the required",T0127:"fill in by format ",T0128:"All",T0129:"you have a new message",T0130:"Record",T0131:"complete",T0132:"dealing",T0133:"create",T0134:"order",T0135:"no history",T0136:"history",T0137:"look",T0138:"reply",T0139:"Customer service has successfully received your questions. Please be patient",T0140:"choose business",T0141:"Manual",T0142:"helpful",T0143:"helpless",T0144:"Email",T0145:"content",T0146:"The description is needed",T0147:"commit",T0148:"No data yet",T0149:"Custom service",T0150:"User",T0151:"Expand all",T0152:"click",T0153:"to view",T0154:"continue",T0155:"disagree",T0156:"User Information Protocol",T0157:"Your message has been submitted successfully, this session will end, if you need to continue consulting, click the 'Re-establish session' button below.",T0158:"You have new messages",T0159:"Cancelled",T0160:"Download"}}},{}],8:[function(e,i,t){i.exports={html:{HTML_MSG00:"返回",HTML_MSG01:"下拉显示更多",HTML_MSG02:"转人工",HTML_MSG03:" 发 送 ",HTML_MSG04:"图片",HTML_MSG05:"评价",HTML_MSG06:"满意度评价",HTML_MSG07:"重新建立会话",HTML_MSG08:"提交",HTML_MSG09:"创建成功",HTML_MSG010:"我们将会以链接的形式在会话中向您反馈工单处理状态",HTML_MSG011:"完成",HTML_MSG0112:"点击加载历史记录",HTML_MSG0113:"转人工服务",HTML_MSG0114:"发送",HTML_MSG0115:"满意度评价",HTML_MSG0116:"重新建立会话",HTML_MSG0117:"留言",HTML_MSG0118:"手机"},system:{L10001:"暂时无法转接人工客服",L10002:"您好,客服{0}接受了您的请求",L10003:"您已经与服务器断开连接,{0}",L10004:"排队中，您在队伍中的第{0}个",L10005:"您在思考人生？有问题请随时提问哦",L10006:'<a href="javascript: window.location.reload();">重新接入</a>',L10007:"{0}有事离开了{1}",L10008:"您与{0}的会话已结束{1}",L10009:"{0}结束了本次会话",L10010:"您长时间没有说话，本次会话已结束。{0}",L10011:"{0}您已打开新聊天窗口{1}",L10012:"没有更多记录",L10013:"抱歉，您无法接入在线客服",L10014:"图片过大",L10015:"格式不支持",L10016:"正在加载...",L10017:"正在加载...",L10018:"下拉显示更多",L10019:"客服{0}发起了会话",L10020:"{0}正在输入",L10021:"本次会话结束{0}",L10022:'{0} 您可以<a href="javascript: void(0);" id="systemMsgLeaveMessage"> 留言 </a>',L10023:'{0} <span  id="systemMsgLeaveMsg">请等待</span>',L10024:'您可以<a class="leave-msg-btn" href="#0"  data-href="{1}"> 留言 </a>',L10025:"暂无客服在线",L10026:"排队中",L10027:"暂无人工客服在线",L10028:"您与{0}的会话已经结束",L10029:"您已经很长时间未说话了哟，有问题尽管咨询",L10030:"您已打开新窗口，刷新可继续会话",L10031:"您已长时间未说话，系统自动关闭本次会话，刷新可继续会话",L10032:"非常对不起哦，不知道怎么回答这个问题呢，我会努力学习的。",L10033:"请上传正确的图片格式",L10034:"图片不能大于5M",L10035:"抱歉，此浏览器不支持上传图片！",L10036:"正在发送，请稍候...",L10037:"谢谢您的反馈",L10038:"提交失败!请重试",L10039:' 您可以<a class="leave-msg-btn js-leaveMessage" href="javascript:void(0);" > 留言 </a>',L10040:"客服 {0} 撤回了一条消息",L10041:"温馨提示：从正规网站按照正常操作进行交易，不要轻易提供验证码、账号等隐私信息，谨防被骗！",L10042:"问题描述上限5000个字符",L10043:"网络问题，请刷新页面重试"},text:{T0000:"取消",T0001:"确定",T0002:"下拉加载更多",T0003:"加载中····",T0004:"没有更多",T0005:"是",T0006:"否",T0010:"选择要咨询的内容",T0011:"今天",T0012:"咨询客服—",T0013:"昨天",T0020:"客服正在输入···",T0021:"是否解决了您的问题？",T0022:"客服评价",T0023:"请简要描述您的问题",T0024:"排队中，请稍后····",T0025:"您的评价已成功提交",T0026:"咨询后才能评价服务质量",T0027:"存在以下哪些问题：",T0028:" 欢迎给我们服务提建议~",T0029:"提交评价",T0030:"留言",T0031:"正在发送",T0032:"谢谢您的反馈",T0033:"提交失败!请重试",T0034:"邮箱 （必填）",T0035:"请填写邮箱",T0036:"邮箱格式错误",T0037:"请填写问题描述！",T0038:"开始咨询",T0039:"提交留言",T0040:"请您留言",T0041:"已解决",T0042:"未解决",T0043:"评价",T0044:"手机",T0045:"手机号格式不正确",T0046:"（必填）",T0047:"（选填）",T0048:"请简要描述您的问题...",T0049:"表情",T0050:"上传文件",T0051:"留言",T0052:"满意度",T0053:"邮箱",T0054:"手机",T0055:"手机（选填）",T0056:"您的留言已成功提交",T0057:"Powered by 智齿科技",T0058:" 条新消息",T0059:"以下为未读消息",T0060:"转人工服务",T0061:"公司：",T0062:"邮箱：",T0063:"工号：",T0064:"姓名：",T0065:"备注：",T0066:"手机：",T0067:"电话：",T0068:"展开",T0069:"收起",T0070:"感谢您的支持",T0071:"我会努力学习，希望下次帮到您",T0072:"会话结束，无法反馈",T0073:"提交失败请稍后重试",T0074:"已评价过该词条",T0075:"上传失败！",T0076:"请上传附件!",T0077:"已达到最大上传附件数量",T0078:"不支持上传此格式文件,您可以将文件打包为zip或者rar格式文件上传",T0079:"图片大小不能超过5MB",T0080:"请上传图片",T0081:"请上传正确的图片格式",T0082:"文件大小不能超过20MB",T0083:"上传中...",T0084:"上传失败",T0085:"上传附件",T0086:"最多上传5个附件",T0087:"您的留言尚未提交，确认关闭？",T0088:"提交将自动忽略上传失败的附件",T0089:"仍然提交",T0090:"有文件正在上传，无法提交",T0091:"提交将自动忽略上传失败的图片",T0092:"邮箱（选填）",T0093:"邀请您对本次服务进行评价",T0094:"告诉我们您遇到的问题？",T0095:"提交",T0096:"请您对本次服务进行评价",T0097:"暂不评价",T0098:"是否解决了您的问题？",T0099:"标题",T0100:"摘要",T0101:"标签",T0102:"链接",T0103:"请您对本次服务进行评分",T0104:"请至少选择一个标签",T0105:"请填写评价详情",T0106:"是否解决了您的问题？",T0107:"您的评价会让我们做得更好",T0108:"请填写",T0109:"问题类型",T0110:"问题描述",T0111:"关闭",T0112:"上一级",T0113:"选择分钟",T0114:"选择小时",T0115:"时",T0116:"分",T0117:"请填写问题类型！",T0118:"请选择",T0119:"正在输入···",T0120:"提交并咨询",T0121:"选择省",T0122:"选择市",T0123:"选择县",T0124:"填写不正确",T0125:"邮箱填写不正确",T0126:"请填写必填项",T0127:"按格式填写",T0128:"全部",T0129:"您的留言状态有更新",T0130:"留言记录",T0131:"已完成",T0132:"受理中",T0133:"已创建",T0134:"工单号",T0135:"暂无相关信息",T0136:"留言详情",T0137:"查看详情",T0138:"问题回复",T0139:"客服已经成功收到您的问题，请耐心等待",T0140:"选择要咨询的业务",T0141:"转人工",T0142:"有用",T0143:"没用",T0144:"留言消息",T0145:"留言内容",T0146:"请填写留言内容！",T0147:"提交留言",T0148:"暂时没有数据",T0149:"客服回复",T0150:"用户回复",T0151:"全部展开",T0152:"点击",T0153:"查看",T0154:"同意授权并继续",T0155:"不同意",T0156:"用户隐私协议",T0157:"您的留言已经提交成功，此会话将结束，如需继续咨询可点击下方“重新建立会话”按钮。",T0158:"您有【新消息】",T0159:"已取消",T0160:"下载"}}},{}],9:[function(e,i,t){function a(i,t){var a,s=e("../util/listener.js"),n=e("../util/promise.js"),t=t||new n,o=e("./template.js"),r=(e("../util/load.js")(),i.global||{}),l=(i.groupId||"",i.tranType||""),c=(i.transferType||"",i.transferAction||"",r.language.lan,r.language.text),d=(e("../config/config.json"),e("../util/monitAjax.js")(r)),u=[],f={},p={},m=60,g=60,v=!0,h=function(){$.ajax({type:"get",url:"/chat-web/user/queryFormConfig.action",dataType:"json",data:{uid:r.apiInit.uid},success:function(e){1==e.status&&(e.openFlag&&1!=e.ustatus&&r.apiInit.ustatus!=-2&&!r.apiConfig.fillFormFlag?"pc"===r.pageType?y(e):T(e):(s.trigger("chatGroups.hide"),t.resolve(i)))}})},y=function(n){var l=n.fields,h=e("./dropdownMenu.js"),y=!0,T={},j=function(){var e=$(this).attr("data-fieldId"),i=[],t=[];$(this).find(".js-userCheckIco"+e).hasClass("userCheckIcoActive")?($(this).addClass("userCheck"),$(this).find(".js-userCheckIco"+e).removeClass("userCheckIcoActive")):($(this).removeClass("userCheck"),$(this).find(".js-userCheckIco"+e).addClass("userCheckIcoActive")),$(".js-userCheckIco"+e).each(function(){$(this).hasClass("userCheckIcoActive")&&(i.push($(this).parent().attr("dataValue")),t.push($(this).parent().attr("dataName")))}),i=i.join(","),t=t.join(",");var a={fieldId:e,dataValue:i,dataName:t};p[a.fieldId].value=a.dataValue,f[a.fieldId]=a.dataValue},b=function(){var e=$(this).attr("data-fieldId"),i=$(this).attr("dataValue"),t=$(this).attr("dataName");a.find(".js-userOptIco"+e).removeClass("userOptIcoActive"),a.find(".js-userOptIco"+e).parent().addClass("userOpt"),$(this).removeClass("userOpt").find(".js-userOptIco"+e).addClass("userOptIcoActive");var s={fieldId:e,dataValue:i,dataName:t};p[s.fieldId].value=s.dataValue,f[s.fieldId]=s.dataValue},I=function(){var e=$(this).attr("data-fieldId"),i=$(this).val();p[e].value=i,f[e]=i,a.find(".js-errorTip"+e).css("visibility","hidden")},w=function(e,i){p[i].value=e,f[i]=e,a.find(".js-errorTip"+i).css("visibility","hidden")},x=function(){var e=$(this).attr("data-fieldId"),i=$(".js-definedNumInput"+e).val();i.length>300&&(i=i.slice(0,300)),a.find(".js-definedNumInput"+e).val(i)},F=function(e){"province"==e.key||"city"==e.key||"county"==e.key||("definedList"==e.type?(p[e.fieldId].value=e.dataValue,f[e.fieldId]=e.dataValue):"time"==e.type&&(p[e.fieldId].value=e.dataValue,f[e.fieldId]=e.dataValue),a.find(".js-errorTip"+e.fieldId).css("visibility","hidden"))},k=function(){a.find(".js-chatBeforeFormlayer").addClass("show"),a.find("#chatBeforeForm").animate({right:"0"})},C=function(){t.reject(t),a.find(".js-chatBeforeFormlayer").removeClass("show"),a.find(".js-chatBeforeForm").animate({right:"-390px"},function(){setTimeout(function(){a.remove()},300)}),s.off("core.closeAlldropMenu"),s.off("core.fillProvinceInner"),s.off("core.definedFieldResult"),s.off("core.fillCityInner")},L=function(){var e=$(".js-mainBox").height()-m-g;a.find(".chatBeforeFormBody").height(e)},S=function(e){var i;e&&e.this_el&&(i=e.this_el);for(var t in T)i&&t==i||T[t].collapse()},M=function(e){var e=e||{};return p.city.value="填了",e.areaId?(f.areaId=e.areaId,void(f.areaName=e.dataName)):void d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(i){if(i&&1==i.status)if(e.provinceId){var t={list:i.citys},s=doT.template(o.cityEle)(t);a.find(".js-cityDropListUl").html(s),a.find(".js-cityDropListTitle").html("选择市"),a.find(".js-countryDropListTitle").html("选择县"),f.proviceId=e.provinceId,f.proviceName=e.dataName,f.cityId="",f.cityName="",f.areaId="",f.areaName=""}else if(e.cityId){var t={list:i.areas},s=doT.template(o.countryEle)(t);a.find(".js-countryDropListUl").html(s),a.find(".js-countryDropListTitle").html("选择县"),f.cityId=e.cityId,f.cityName=e.dataName,f.areaId="",f.areaName=""}},error:function(){}})},P=function(){var e={};d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(e){if(e&&1==e.status){var i={list:e.provinces},t=doT.template(o.provinceEle)(i);a.find(".js-provinceDropListUl").html(t)}},error:function(){}})},A=function(){for(var e=0,s=0;s<u.length;s++)if(p[u[s].id].fillFlag&&""==p[u[s].id].value?(a.find(".js-errorTip"+p[u[s].id].id).css("visibility","inherit"),v=!1):(u[s].value=p[u[s].id].value,a.find(".js-errorTip"+p[u[s].id].id).css("visibility","hidden"),e++),"email"==p[u[s].id].id&&""!=p[u[s].id].value){var n=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(!n.test(p[u[s].id].value))return void a.find(".js-errorTip"+p[u[s].id].id).html(p[u[s].id].fieldName+c.T0124).css("visibility","inherit")}if(0!=u.length&&e!=u.length||(v=!0),v&&y){f=JSON.stringify(f),y=!1;var o={uid:r.apiInit.uid,companyId:r.sysnum,customerFields:f};d({type:"post",url:"/chat-web/user/submitForm.action",dataType:"json",data:o,success:function(e){e&&1==e.status&&(t.resolve(i),r.apiConfig.fillFormFlag=!0,C())},error:function(){}})}},D=function(){$chatBeforeFormlayer=a.find(".js-chatBeforeFormlayer"),$close=a.find(".js-close"),$txtTip=a.find(".js-txt-tip"),$definedFields=a.find(".js-definedFields"),$userCheck=a.find(".js-userCheck"),$userOpt=a.find(".js-userOpt"),$definedNumInput=a.find(".js-definedNumInput"),$chatBeforeFormSubmit=a.find(".js-chatBeforeFormSubmit")},_=function(){$definedNumInput.on("input",x),a.delegate(".js-definedInput","blur",I),s.on("core.definedFieldResult",F),s.on("core.fillCityInner",M),s.on("core.fillProvinceInner",P),$userCheck.on("click",j),$userOpt.on("click",b),$chatBeforeFormSubmit.on("click",A),$(window).on("resize",L),a.delegate(".js-chatBeforeFormlayer","click",function(){C()}),a.delegate(".js-cancel-btn","click",function(){C()}),s.on("core.closeAlldropMenu",S);
},N=function(){s.trigger("chatGroups.hide");var e=doT.template(o.chatBeforeFormPc)({global:r,formDoc:n.formDoc,formTitle:n.formTitle,languageText:c,definedField:l});a=$(e),$(".js-mainBox").append(a);for(var i=a.find(".js-dropdownList"),t=0;t<i.length;t++){var d=$(i[t]).attr("id");T[d]=new h(i[t],r,d)}a.find(".submit").css("background-color",r.apiConfig.color);for(var t=0;t<l.length;t++){var f={};f.id=l[t].cusFieldConfig.fieldId,f.fieldName=l[t].cusFieldConfig.fieldName,4==l[t].cusFieldConfig.fieldType?(f.fillFlag=0,f.value="00:00"):(f.fillFlag=l[t].cusFieldConfig.fillFlag,f.value=""),u.push(f),p[f.id]=f}for(var t=0,m=l.length;t<m;t++)3==l[t].cusFieldConfig.fieldType&&a.find("#dp"+l[t].cusFieldConfig.fieldId).datepicker().on("changeDate",function(e){var i,t,a,s=e.date;i=s.getFullYear(),t=s.getMonth()+1<10?"0"+(Number(s.getMonth())+1):s.getMonth()+1,a=s.getDate()<10?"0"+s.getDate():s.getDate(),_bir=i+"-"+t+"-"+a,$(this).val(_bir);var n=$(this).attr("data-fieldId");w(_bir,n),$(".datepicker.dropdown-menu").hide()});k(),D(),_(),L()};N()},T=function(e){var n,l,m=e.fields,g=!1,h=!0,y="",T=function(){var e=$(this).attr("fieldId"),i=$(this).val();p[e].value=i},j=function(){var e=$(this).attr("fieldId"),i=$(this).val();p[e].value=i},b=function(){var e=0;$(this).parents(".js-definedArea").find(".js-dropListArea").animate({bottom:e+"px",opacity:1},300),a.find(".js-definedLayer").show(),a.find(".js-definedLayer").animate({opacity:1},300)},I=function(){var e=$(this).attr("date-type"),i=0;"hour"==e?$(this).parent().find(".js-dropListHour").animate({bottom:i+"px"},300):"minutes"==e&&$(this).parent().find(".js-dropListMinutes").animate({bottom:i+"px"},300),a.find(".js-definedLayer").show(),a.find(".js-definedLayer").animate({opacity:1},300)},w=function(){var e=$(this).attr("date-type"),i=$(this).attr("dataValue"),t=$(this).attr("fieldId");$(this).addClass("active").siblings().removeClass("active"),"hour"==e?$(this).parents(".js-definedArea").find(".js-definedHour").val(i):"minutes"==e&&$(this).parents(".js-definedArea").find(".js-definedMinutes").val(i),p[t].value=$(this).parents(".js-definedArea").find(".js-definedHour").val()+":"+$(this).parents(".js-definedArea").find(".js-definedMinutes").val()},x=function(){$(this).parents(".js-dropListArea").animate({bottom:"-382px",opacity:0},300),a.find(".js-definedLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-definedLayer").hide()},100)})},F=function(){var e=$(this).attr("datavalue"),i=$(this).attr("dataName"),t=$(this).attr("fieldId");p[t].value=e,$(this).parent().find("li").removeClass("active"),$(this).addClass("active"),$(this).parents(".definedArea").find(".js-definedDropListText").html(i)},k=function(){$(this).hasClass("checkedActive")?$(this).removeClass("checkedActive"):$(this).addClass("checkedActive")},C=function(){for(var e=$(this).attr("fieldId"),i=$(this).prev().find(".js-definedCheckedLi"),t="",s="",n=0;n<i.length;n++)$(i[n]).hasClass("checkedActive")&&(t+=$(i[n]).attr("dataValue")+",",s+=$(i[n]).attr("dataName")+";");t.length>0&&(t=t.substr(0,t.length-1)),s.length>0?(s=s.substr(0,s.length-1),$(this).parents(".js-definedArea").find(".js-definedDropListText").html(s)):$(this).parents(".js-definedArea").find(".js-definedDropListText").html("--"),p[e].value=t,$(this).parents(".js-dropListArea").animate({bottom:"-382px",opacity:0},300),a.find(".js-definedLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-definedLayer").hide()},100)})},L=function(){var e=(window.screen.width,50),i=0;"none"!=$(".js-header-back").css("display")&&(i=50,a.find(".js-chatFormLayer").css("top",i+"px")),definedHeight=l.height()-e,a.find(".js-chatBeforeForm-content").css({height:definedHeight-i+"px"})},S=function(){a.find(".js-orderClassifyLayer").show();var e=0;a.find(".js-orderClassifyInner").animate({bottom:e+"px"},300),a.find(".js-orderClassifyLayer").animate({opacity:1},300),h=!0},M=function(){a.find(".js-orderClassifyInner").animate({bottom:"-280px"},300),a.find(".js-orderClassifyLayer").animate({opacity:0},300,function(){setTimeout(function(){a.find(".js-orderClassifyLayer").hide()},100)})},P=function(e){var e=e||{};h&&(h=!1,d({type:"post",url:"/chat-web/user/queryCity.action",dataType:"json",data:e,success:function(i){if(i&&1==i.status){if(e.provinceId){g=!0,m=i.citys,f.proviceId=e.provinceId,f.proviceName=e.provinceName,y=e.provinceName,a.find(".js-cityTitle").html(c.T0122),p.city.value=y,a.find(".js-cityAreaTitle").html(y);var t={items:m,languageText:c},s=doT.template(o.cityListEleH5)(t);a.find(".js-areaListArea").html(s)}else if(e.cityId){g=!0,m=i.areas,f.cityId=e.cityId,f.cityName=e.cityName,y+=e.cityName,a.find(".js-cityTitle").html(c.T0123),p.city.value=y,a.find(".js-cityAreaTitle").html(y);var t={items:m,languageText:c},s=doT.template(o.areaListEleH5)(t);a.find(".js-areaListArea").html(s)}else{g=!0,m=i.provinces;var t={items:m,languageText:c},s=doT.template(o.provinceEleH5)(t);a.find(".js-areaListArea").html(s),S()}setTimeout(function(){h=!0},200)}},error:function(){}}))},A=function(e){P()},D=function(){var e=$(this).attr("provinceId"),i=$(this).attr("cityId"),t=$(this).attr("areaId"),s=$(this).attr("endFlag"),n={};if(p.city.value="填了",e){var o=$(this).attr("provinceName");n={provinceId:e,provinceName:o},"true"==s?($(this).addClass("active"),a.find(".js-cityAreaTitle").html(o),f.proviceId=n.provinceId,f.proviceName=n.provinceName,M()):P(n)}else if(i){var r=$(this).attr("cityName");n={cityId:i,cityName:r},"true"==s?($(this).addClass("active"),a.find(".js-cityAreaTitle").html(y+r),f.cityId=n.cityId,f.cityName=n.cityName,M()):P(n)}else if(t){var l=$(this).attr("areaName");return f.areaId=n.areaId,f.areaName=l,y+=l,a.find(".js-cityAreaTitle").html(y),$(this).addClass("active"),M(),void a.find(".js-cityTitle").html(c.T0121)}},_=function(){for(var e=0,s=0;s<u.length;s++){if(p[u[s].id].fillFlag&&""==p[u[s].id].value)return N(c.T0126),void(v=!1);if(u[s].value=p[u[s].id].value,f[u[s].id]=u[s].value,e++,"email"==p[u[s].id].id&&""!=p[u[s].id].value){var n=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(!n.test(p[u[s].id].value))return void N(c.T0125)}if(3==p[u[s].id].filedType&&""!==p[u[s].id].value){var o=/^((19[0-9][0-9])|(20[0-9][0-9]))-(((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))$/,l=o.test(p[u[s].id].value);if(!l)return void N(p[u[s].id].fieldName+c.T0124)}}if(0!=u.length&&e!=u.length||(v=!0),v&&h){f=JSON.stringify(f),h=!1;var m={uid:r.apiInit.uid,companyId:r.sysnum,customerFields:f};d({type:"post",url:"/chat-web/user/submitForm.action",dataType:"json",data:m,success:function(e){e&&1==e.status&&(t.resolve(i),a.remove(),r.apiConfig.fillFormFlag=!0)},error:function(){}})}},N=function(e){var i={};i={text:e};var t=doT.template(o.showTip)(i),a=$(t);l.append(a);var s=l.height()/2-21,n=l.width()/2-70;a.find(".js-showTip").css({top:s,left:n}),setTimeout(function(){a.find(".js-showTip").remove()},3e3)},R=function(){t.reject(t),a.remove()},O=function(){l=$(".js-wrapBox"),n=$(".js-showTip")},B=function(){a.delegate(".js-cityAreaTitle","click",A),a.delegate(".js-provinceList","click",D),a.delegate(".js-orderClassifyClose","click",M),a.delegate(".js-definedInput","blur",T),a.delegate(".js-definedDate","blur",j),a.delegate(".js-chatBeforeFormCommit","click",_),a.delegate(".js-definedDropList","click",b),a.delegate(".js-definedTimeDropList","click",I),a.delegate(".js-definedTimeLi","click",w),a.delegate(".js-dropLIstAreaClose","click",x),a.delegate(".js-definedDropListLi","click",F),a.delegate(".js-definedCheckedLi","click",k),a.delegate(".js-checkedSure","click",C),a.delegate(".js-closeForm","click",R)},z=function(){s.trigger("chatGroups.hide");var i={global:r,formDoc:e.formDoc,formTitle:e.formTitle,languageText:c,items:m},t=doT.template(o.chatBeforeFormH5)(i);a=$(t),l.append(a);for(var n=0;n<m.length;n++){var d={};d.id=m[n].cusFieldConfig.fieldId,d.fieldName=m[n].cusFieldConfig.fieldName,4==m[n].cusFieldConfig.fieldType?(d.fillFlag=0,d.value="00:00"):3==m[n].cusFieldConfig.fieldType?(d.fillFlag=m[n].cusFieldConfig.fillFlag,d.value="",d.filedType=3):(d.fillFlag=m[n].cusFieldConfig.fillFlag,d.value=""),u.push(d),p[d.id]=d}},E=function(){O(),z(),B(),L()};E()},j=function(){"keySwitch"==l?t.resolve(i):h()};return j(),t}i.exports=a},{"../config/config.json":2,"../util/listener.js":32,"../util/load.js":33,"../util/monitAjax.js":34,"../util/promise.js":36,"./dropdownMenu.js":12,"./template.js":21}],10:[function(e,i,t){function a(i,t){var a=e("../util/listener.js"),s=e("../util/promise.js"),t=t||new s,n=i.global,o=i.groupList;i.groupId||"",i.tranType||"";transferType=i.transferType||"",transferAction=i.transferAction||"";var r,l=e("./template.js"),c=(n.language.lan,n.language.text),d=(window.navigator.userAgent.indexOf("Mobile")>=0,e("../util/monitAjax.js")(n),!0),u=function(e){var i=doT.template(l.groupTemplate)({list:e,languageText:c});r=$(i),$(".js-wrapBox").append(r),r.delegate(".js-item","click",function(e){var i=e.currentTarget,a=$(i).attr("data-id"),s={global:n,groupId:a,transferType:transferType,transferAction:transferAction};t.resolve(s),r.remove()}),$(document.body).delegate(".js-shadow-layer","click",function(){t.reject(t),r.remove()}),r.delegate(".js-group-outer","click",function(e){e.stopPropagation(),e.preventDefault()}),r.delegate(".js-cancel-btn","click",function(e){t.reject(t),r.remove()}),$(".js-item").css("background-color",n.apiConfig.color),$(".js-cancel-btn").css("color",n.apiConfig.color)},f=function(e){var i=n.apiConfig.color,a=doT.template(l.groupTemplatePC)({list:e,languageText:c});r=$(a),$(".js-mainBox").append(r),r.find(".js-group-outer").animate({right:"0"}),r.delegate(".js-item","click",function(e){if(d){d=!1;var a=e.currentTarget,s=$(a).attr("data-id");$(a).css({"border-color":i,color:i}).siblings().css({"border-color":"",color:""});var o={global:n,groupId:s,transferType:transferType,transferAction:transferAction};t.resolve(o),e.stopPropagation()}}),r.delegate(".js-cancel-btn","click",function(e){r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove(),t.reject(t)})}),r.delegate(".js-group-layer","click",function(){r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove(),t.reject(t)})})},p=function(){"pc"===n.pageType?r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove()}):r.remove()},m=function(){n.urlParams.groupId||"";"pc"===n.pageType?f(o):u(o),a.on("chatGroups.hide",p)};return o?m():t.resolve(i),t}i.exports=a},{"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./template.js":21}],11:[function(e,i,t){var a,s={},n=e("../util/listener.js");s.setCurrentState=function(e){a=e,n.trigger("core.statechange",a)},s.getCurrentState=function(){return a},i.exports=s},{"../util/listener.js":32}],12:[function(e,i,t){var a=function(i,t,a){var s=(e("../util/monitAjax.js")(t),e("../util/listener.js")),n=(e("./template.js"),!1);i=$(i);var o=!1,r=function(e){e.stopPropagation();var t=$(this).parent().attr("id"),a={this_el:t};s.trigger("core.closeAlldropMenu",a),n?(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1):(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),$(this).find(".dropListTitleIcn").css("background-position","-3320px 13px"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),n=!0),"province"!=t||o||(o=!0,s.trigger("core.fillProvinceInner"))},l=function(e){e.stopPropagation();var t=$(this).attr("data-fieldId")||"",a=$(this).attr("dataValue")||"",o=($(this).attr("fieldType")||"",$(this).attr("dataName")||"");if(i.find(".js-dropdown-title").html($(this).html()),a)var r={fieldId:t,dataValue:a,dataName:o,type:"definedList"};else{var l="00:00";l=$("#hour"+t).find(".js-definedHour").html()+":"+$("#minute"+t).find(".js-definedMinutes").html();var r={fieldId:t,dataValue:l,dataName:l,type:"time"}}s.trigger("core.definedFieldResult",r),i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1},c=function(e){e.stopPropagation();var t=$(this).attr("provinceId"),a=$(this).attr("cityId"),o=$(this).attr("areaId"),r=$(this).attr("title")||"",l={};i.find(".js-dropdown-title").html($(this).html()),t?l={provinceId:t,dataName:r}:a?l={cityId:a,dataName:r}:o&&(l={areaId:o,dataName:r}),s.trigger("core.fillCityInner",l),i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),n=!1},d=function(){n=!1,i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px")},u=function(){},f=function(){},p=function(){i.delegate(".js-dropdown-btn","click",r),i.delegate(".js-dropdownLi","click",l),i.delegate(".js-cityLi","click",c),$(document.body).on("click",function(){s.trigger("core.closeAlldropMenu")})},m=function(){},g=function(){m(),f(),p()};g(),this.expand=u,this.collapse=d};i.exports=a},{"../util/listener.js":32,"../util/monitAjax.js":34,"./template.js":21}],13:[function(e,i,t){var a=function(i){var t,a,s=e("../util/listener.js"),n=e("../util/promise.js"),o=e("../util/date.js"),r=e("../socket/robot.js"),l=e("./currentState.js"),c=e("../util/monitAjax.js")(i),d=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),u=e("./initsession.js"),f=e("../socket/socketfactory.js"),p=i.apiConfig.leaveMsg,m=i.language.lan,g=!1,v=function(){i.urlParams.guideFlag&&1!=i.apiInit.multiFlag&&2!=i.apiConfig.type&&$.ajax({type:"post",url:"/chat/user/robotGuide.action",dataType:"json",data:{uid:i.apiInit.uid,robotFlag:i.urlParams.robotFlag||""},success:function(e){var t=e.data.ts?new Date(e.data.ts):new Date;t=new Date(t.getTime()+1e5);var a=o.formatDate(t,!0),n=e.data.answer||"";n.indexOf("<a")>=0&&(n=n.replace(/<a/g,'<a target="_blank"'));var r=[];r.push({type:"robot",answerType:"welcome-sugguestions",date:a,content:[{senderName:i.apiConfig.robotName,senderType:3,msg:n,stripe:"",list:e.data.suggestions,ts:a}]}),s.trigger("core.initsession",r)}})},h=function(e,t,a){var n=a?t.aface:i.apiConfig.robotLogo,r=a?t.aname:i.apiConfig.robotName,a=a||i.urlParams.robotHelloWord,c=i.apiInit.ustatus==-2,d=i.apiInit.ustatus==-2?1:0;e||(e=[]);var u=new Date,f={date:o.formatDate(u),content:[{senderType:d?1:a?2:1,t:+u,msg:a,ts:o.formatDate(u,!0),senderFace:n,senderName:r}]};c?l.setCurrentState("robot"):l.setCurrentState("human"),i.apiConfig.adminHelloWordFlag&&e.push(f),setTimeout(function(){s.trigger("core.initsession",e)},0)},y=function(e,a){e||(e=[]);var n=new Date,c={date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};!i.apiInit.multiFlag&&i.apiConfig.robotHelloWordFlag&&e.push(c),t&&t.destroy(),t=new r(i),l.setCurrentState("robot"),setTimeout(function(){s.trigger("core.initsession",e)},0)},T=function(e,a){if(e){var n=new Date,c={date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};l.setCurrentState("robot"),t&&t.destroy(),t=new r(i),u(i,a,!1).then(function(e){i.apiConfig.robotHelloWordFlag&&e.push(c),s.trigger("core.initsession",e)})}},j=function(e,n,o,c){var d=e.queueDoc;g=!0,n?(v(),h(o,e,null),setTimeout(function(){i.urlParams.msgflag?e.content=d:e.content=d+" "+p,7==e.status&&(e.content=e.msg),!c&&i.apiConfig.customerQueueFlag&&s.trigger("core.system",{type:"system",status:"queue",data:e})},1)):(i.urlParams.msgflag?e.content=d:e.content=d+" "+p,7==e.status&&(e.content=e.msg),(i.apiConfig.customerQueueFlag||1==queueFlag||2==queueFlag)&&s.trigger("core.system",{type:"system",status:"queue",data:e})),t&&t.destroy(),a||7==e.status||(a=f(e,i),a.start()),t=new r(i),l.setCurrentState("robot"),7!=e.status&&s.trigger("core.sessionclose",-3)},b=function(e){for(var n=e.list||[],o=0,r=n.length;o<r;o++){var c=n[o],d=c;if(200===c.type){t&&a&&(t.destroy(),t=a,a=null),l.setCurrentState("human"),s.trigger("core.system",{type:"system",status:"transfer",data:{content:m.L10002.replace("{0}",d.aname)}}),d.serviceInfo.adminHelloWord&&(i.urlParams.adminHelloWord=d.serviceInfo.adminHelloWord),d.content=i.urlParams.adminHelloWord,s.trigger("core.system",{type:"human",data:d}),s.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},I=function(e,a,n){s.trigger("core.buttonchange",{type:"transfer",action:"show"}),a?(v(),y(n,e,null),setTimeout(function(){i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+" "+p,s.trigger("core.system",{type:"system",status:"offline",data:e})},1)):(t&&t.destroy(),t=new r(i),l.setCurrentState("robot"),i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+p,s.trigger("core.system",{type:"system",status:"offline",data:e}))},w=function(e,a){i.urlParams.msgflag?e.content=m.L10001:e.content=m.L10001+" "+p,t=new r(i),l.setCurrentState("robot"),s.trigger("core.system",{type:"system",status:"blacklist",data:e}),a&&y()},x=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null},F=function(e,n,o){var o=!!o,r=e.groupId||"",d=e.tranType||"",p=e.transferFlag||"",v=e.keyword||"",y=e.keywordId||"",T=e.queueFlag||"",b=e.transferType||"",F=e.transferAction||"";u(i,n,!0).then(function(e,n){var u;u=a&&"websocket"==a.type?8:1;var k=i.urlParams,C="/chat/user/chatconnect.action",$={sysNum:i.sysnum,uid:i.apiInit.uid,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,way:u,current:g,groupId:r||"",keyword:v||"",keywordId:y||"",queueFlag:T,transferType:b,transferAction:F,summaryParams:i.urlParams.summaryParams,adminHelloWorld:i.urlParams.adminHelloWorld};if(null!=x("queueFirst")&&($.queueFirst=x("queueFirst")),k.autoManual&&k.aid&&(C="/chat/user/invite.action",$.aid=k.aid),1==T){var L={answer:"您的消息涉及重点业务，正在为您转接人工客服",answerType:"5",msgId:"",transferType:0,ustatus:-1};s.trigger("core.onreceive",{list:[L],type:"robot"})}c({url:C,type:"post",dataType:"json",data:$,success:function(a){if(i.urlParams.leaveMsgGroupId=r,1==a.status||"keySwitch"!=d||1!=p||a.count)return a.status==-1?void s.trigger("core.sessionclose",7):void(2==a.status?I(a,o,e):0==a.status||7==a.status?j(a,o,e,y):1==a.status?(window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),g=!1,a.adminHelloWord&&(i.urlParams.adminHelloWord=a.adminHelloWord),i.urlParams.queueDoc=a.queueDoc||"",a.serviceEndPushMsg&&(i.urlParams.serviceEndPushMsg=a.serviceEndPushMsg||""),o?(h(e,a,i.urlParams.adminHelloWord),s.trigger("core.transfersuccess",{data:a})):(s.trigger("core.system",{type:"system",status:"transfer",data:{content:m.L10002.replace("{0}",a.aname)}}),s.trigger("core.transfersuccess",{data:a}),a.content=i.urlParams.adminHelloWord,i.apiConfig.adminHelloWordFlag&&s.trigger("core.system",{type:"human",status:"transfer",data:a})),t&&t.destroy(),t=f(a,i),t.start(),l.setCurrentState("human"),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==a.status?(s.trigger("core.sessionclose",7),w(a,o)):6==a.status&&(delete i.urlParams.aid,i.apiConfig.smartRouteInfoFlag=!1,s.trigger("core.grouplist")))},fail:function(){}})})},k=function(e,t,a){var a=!!a,t=new n;return d(i,t,g).then(function(e){F(e,null,a)},function(){0==i.apiConfig.smartRouteInfoFlag&&(a=!0),T(a,t)}),t},C=function(e){var t=new n;return d(i,t,g,e).then(function(e){F(e,null,!1)},function(){T(!1,t)}),t},L=function(){},S=function(){s.on("sendArea.artificial",k),s.on("listMsg.keyWordArtificial",C),s.on("listMsg.transTypeArtificial",C),s.on("core.onreceive",b)},M=function(){var e=i.apiInit.ustatus;0==e||1==e||e==-2?k(null,null,!0):e==-1&&u(i).then(y)},P=function(){L(),S(),M()};P(),this.getWelcome=function(){}};i.exports=a},{"../socket/robot.js":24,"../socket/rolling.js":25,"../socket/socketfactory.js":26,"../socket/websocket.js":27,"../util/date.js":28,"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./currentState.js":11,"./initsession.js":15,"./transfer.js":22}],14:[function(e,i,t){function a(i){var t=e("../util/listener.js"),a=e("../util/promise.js"),s=e("../util/date.js"),n=e("../util/monitAjax.js")(i),o=(e("../socket/robot.js"),e("../socket/websocket.js"),e("./currentState.js")),r=(e("../socket/rolling.js"),e("./currentState.js")),l=e("./transfer.js"),c=e("./initsession.js"),d=e("../socket/socketfactory.js"),u=i.apiConfig.leaveMsg,f=i.language.lan,p=null,m=!1,g=function(e,a,n){var o=n?a.aface:i.apiConfig.robotLogo,r=n?a.aname:i.apiConfig.robotName,n=n||i.urlParams.robotHelloWord,l=i.apiInit.ustatus==-2?1:0;e||(e=[]);var c=new Date,d={date:s.formatDate(c),content:[{senderType:l?1:n?2:1,t:+c,msg:n,ts:s.formatDate(c,!0),senderFace:o,senderName:r}]};i.apiConfig.adminHelloWordFlag&&e.push(d),setTimeout(function(){t.trigger("core.initsession",e)},0)},v=function(e,t,s){var s=!!s,t=new a;return l(i,t,m).then(function(e){w(e,null,s)},y),t},h=function(e){for(var a=e.list||[],s=0,n=a.length;s<n;s++){var r=a[s],l=r;if(200===r.type){o.setCurrentState("human"),t.trigger("core.system",{type:"system",status:"transfer",data:{content:f.L10002.replace("{0}",l.aname)}}),l.serviceInfo.adminHelloWord&&(i.urlParams.adminHelloWord=l.serviceInfo.adminHelloWord),l.content=i.urlParams.adminHelloWord,t.trigger("core.system",{type:"human",data:l}),t.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},y=function(){setTimeout(function(){t.trigger("core.sessionclose",-1)},0)},T=function(e,a,s){var n=e.queueDoc;m=!0,p&&p.destroy(),p=d(e,i),p.start(),a?(t.trigger("core.initsession",s),setTimeout(function(){i.urlParams.msgflag?e.content=n:e.content=n+" "+u,e.aname=f.L10026,i.apiConfig.customerQueueFlag&&t.trigger("core.system",{type:"system",status:"queue",data:e}),t.trigger("core.sessionclose",-2)},1)):(i.urlParams.msgflag?e.content=n:e.content=n+" "+u,e.aname="排队中",t.trigger("core.system",{type:"system",status:"queue",data:e}),t.trigger("core.sessionclose",-2))},j=function(e,a,s){p&&p.destroy(),i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+" "+u,t.trigger("core.buttonchange",{type:"transfer",action:"hide",data:e}),a?setTimeout(function(){t.trigger("core.sessionclose",-1)},1):t.trigger("core.sessionclose",-1)},b=function(e,a){i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+" "+u,e.aname=f.L10025,t.trigger("core.system",{type:"system",status:"blacklist",data:e,moduleType:"humanOnly"}),t.trigger("core.sessionclose",-1)},I=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null},w=function(e,a,s){var s=!!s,o=e.groupId||"";c(i,a).then(function(e,a){var l=i.urlParams,c="/chat/user/chatconnect.action",u={sysNum:i.sysnum,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,uid:i.apiInit.uid,way:1,current:m,groupId:o||"",transferAction:i.urlParams.transferAction,summaryParams:i.urlParams.summaryParams,adminHelloWorld:i.urlParams.adminHelloWorld};null!=I("queueFirst")&&(u.queueFirst=I("queueFirst")),l.autoManual&&l.aid&&(c="/chat/user/invite.action",u.aid=l.aid),n({url:c,type:"post",dataType:"json",data:u,success:function(a){return i.urlParams.leaveMsgGroupId=o,a.status==-1?void t.trigger("core.sessionclose",7):void(2==a.status?j(a,s,e):0==a.status?T(a,s,e):1==a.status?(window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),a.adminHelloWord&&(i.urlParams.adminHelloWord=a.adminHelloWord),i.urlParams.queueDoc=a.queueDoc||"",a.serviceEndPushMsg&&(i.urlParams.serviceEndPushMsg=a.serviceEndPushMsg||""),s?(g(e,a,i.urlParams.adminHelloWord),t.trigger("core.transfersuccess",{data:a})):(t.trigger("core.system",{type:"system",status:"transfer",data:{content:f.L10002.replace("{0}",a.aname)}}),t.trigger("core.transfersuccess",{data:a}),a.content=i.urlParams.adminHelloWord,t.trigger("core.system",{type:"human",status:"transfer",data:a})),p&&p.destroy(),p=d(a,i),r.setCurrentState("human"),p.start(),t.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==a.status?b(a,s):6==a.status?(delete i.urlParams.aid,i.apiConfig.smartRouteInfoFlag=!1,t.trigger("core.grouplist")):7==a.status&&(a.content=a.msg,t.trigger("core.system",{type:"system",status:"queue",data:a})))},fail:function(){}})})},x=function(){t.on("sendArea.artificial",v)},F=function(){t.on("core.onreceive",h)},k=function(){var e=i.apiInit.ustatus;0!=e&&1!=e&&e!=-2||v(null,null,!0)},C=function(){x(),F(),k()};C()}i.exports=a},{"../socket/robot.js":24,"../socket/rolling.js":25,"../socket/socketfactory.js":26,"../socket/websocket.js":27,"../util/date.js":28,"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./currentState.js":11,"./initsession.js":15,"./transfer.js":22}],15:[function(e,i,t){var a,s,n,o=e("../util/promise.js"),r=e("../util/date.js"),l=e("./offlineMessage.js"),c=function(e,i){var i=i||new o;return 0==e.apiInit.ustatus?setTimeout(function(){i.resolve([])},0):$.ajax({type:"post",url:"/chat/user/getChatDetailByCid.action",dataType:"json",data:{cid:e.apiInit.cid,uid:e.apiInit.uid},success:function(e){i.resolve(e)}}),i},d=function(e,i){var i=i||new o;return $.ajax({url:"/chat/msgOffline/queryOfflineMsg.action",dataType:"jsonp",type:"GET",data:{uid:a.apiInit.uid},success:function(t){var a;if(t.length>0){for(var s=0;s<t.length;s++)for(var n=t[s].content||[],o=0;o<n.length;o++){var c=n[o];0==o&&(a=c),l[c.msgId]=!0,c.msgType_2="offline",null===c.senderType&&(c.senderType=2),c.msg||(c.msg="")}var d=a.t?new Date(a.t):new Date;d=new Date(d.getTime()+1e5);var u=r.formatDate(d,!0);e.push({type:"offline-seperator",date:"",content:[{senderType:-1,msg:"",ts:a?a.ts:u,t:a?a.t:+new Date}]})}var n=e.concat(t);i.resolve(n)}}),i},u=function(e,i){var i=i||new o;if(s)return void setTimeout(function(){i.resolve(e)},0);var t;return void 0!==a.urlParams.moduleType&&(t=a.urlParams.moduleType),void 0===t&&(t=a.apiConfig.type),a.urlParams.guideFlag&&1!=a.apiInit.multiFlag&&1!=a.apiInit.ustatus&&2!=t?$.ajax({type:"post",url:"/chat/user/robotGuide.action",dataType:"json",data:{uid:a.apiInit.uid,robotFlag:a.urlParams.robotFlag||""},success:function(t){var s=t.data.ts?new Date(t.data.ts):new Date;s=new Date(s.getTime()+1e5);var n=r.formatDate(s,!0),o=t.data.answer||"";o.indexOf("<a")>=0&&(o=o.replace(/<a/g,'<a target="_blank"')),e.push({type:"robot",answerType:"welcome-sugguestions",date:n,content:[{senderName:a.apiConfig.robotName,senderType:3,msg:o,stripe:"",list:t.data.suggestions,ts:n}]}),i.resolve(e)}}):i.resolve(e),i};i.exports=function(i,t,o){return a=i,n=e("../util/monitAjax.js")(a),s=o,c(a).then(d).then(u)}},{"../util/date.js":28,"../util/monitAjax.js":34,"../util/promise.js":36,"./offlineMessage.js":17}],16:[function(e,i,t){function a(i){var t,a,r=3,l=4,c=1,d=2,u=e("./humanfirst.js"),f=e("./robotfirst.js"),p=e("./robotonly.js"),m=e("./humanonly.js"),g=e("../comm.js");if(t=g.getQueryParam(),a=t.moduleType>=1&&t.moduleType<=4?t.moduleType:i.apiConfig.type,s)return s;switch(a!=l&&a!=d||i.apiInit.pid!==o||n.specialError("qufenqi_human_first","mode",{url:location.href,moduleType:a,uid:i.apiInit.uid},i),a){case r:s=new f(i);break;case l:s=new u(i);break;case c:s=new p(i);break;case d:s=new m(i)}return s}var s=null,n=e("../util/errorlog.js"),o="a2a01f79faed48489058af7eabaafc1c";i.exports=a},{"../comm.js":1,"../util/errorlog.js":29,"./humanfirst.js":13,"./humanonly.js":14,"./robotfirst.js":19,"./robotonly.js":20}],17:[function(e,i,t){i.exports={}},{}],18:[function(e,i,t){function a(e){var i=0;for(var t in s)s.hasOwnProperty(t)&&i++;if(0!=i)for(var a=0;a<e.length;a++){for(var n=[],o=0;o<e[a].content.length;o++){var r=e[a].content[o];s[r.msgId]?delete s[r.msgId]:n.push(r)}e[a].content=n}}var s=e("./offlineMessage.js");i.exports=a},{"./offlineMessage.js":17}],19:[function(e,i,t){var a=function(i){var t,a,s=e("../util/listener.js"),n=e("../util/promise.js"),o=e("../util/date.js"),r=e("../socket/robot.js"),l=e("./currentState.js"),c=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),d=e("./initsession.js"),u=e("../util/monitAjax.js")(i),f=e("../socket/socketfactory.js"),p=i.apiConfig.leaveMsg,m=i.language.lan,g=!1,v=(new n,0),h=function(){$transferBtn=$(".temp_test")},y=function(e,t){var t=t||new n;return d(i,t).then(function(e,t){e||(e=[]);var a=new Date,n={date:o.formatDate(a),content:[{senderType:1,t:+a,msg:i.urlParams.robotHelloWord,ts:o.formatDate(a,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};return i.apiConfig.robotHelloWordFlag&&e.push(n),setTimeout(function(){s.trigger("core.initsession",e)},0),t}),t},T=function(e,t){var a=!!e,n=e?t.aface:i.apiConfig.robotLogo,r=e?t.aname:i.apiConfig.robotName,e=e||i.urlParams.robotHelloWord,l=i.apiInit.ustatus==-2?1:0;d(i).then(function(t,c){t||(t=[]);var d=new Date,u={date:o.formatDate(d),content:[{senderType:l?1:e?2:1,t:+d,msg:e,ts:o.formatDate(d,!0),senderFace:n,senderName:r}]};return a&&!i.apiInit.multiFlag&&i.apiConfig.adminHelloWordFlag&&t.push(u),a||i.apiInit.multiFlag||!i.apiConfig.robotHelloWordFlag||t.push(u),setTimeout(function(){s.trigger("core.initsession",t)},0),c})},j=function(e,t){t?(T(null,e),setTimeout(function(){i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+p,i.apiConfig.adminNoneLineFlag&&s.trigger("core.system",{type:"system",status:"offline",data:e})},1)):(i.urlParams.msgflag?e.content=i.urlParams.adminNonelineTitle:e.content=i.urlParams.adminNonelineTitle+p,i.apiConfig.adminNoneLineFlag&&s.trigger("core.system",{type:"system",status:"offline",data:e})),l.setCurrentState("robot")},b=function(e,n,o){var c=e.queueDoc;g=!0,a||(a=f(e,i),a.start()),t&&t.destroy(),t=new r(i),n?(T(null,e),setTimeout(function(){i.urlParams.msgflag?e.content=c:e.content=c+" "+p,!o&&i.apiConfig.customerQueueFlag&&s.trigger("core.system",{type:"system",status:"queue",data:e})},1)):(i.urlParams.msgflag?e.content=c:e.content=c+" "+p,(!o&&i.apiConfig.customerQueueFlag||1==e.queueFlag||2==e.queueFlag)&&s.trigger("core.system",{type:"system",status:"queue",data:e})),l.setCurrentState("robot")},I=function(e,a){t&&t.destroy(),window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),g=!1,window.parent&&window.postMessage&&window.parent.postMessage(JSON.stringify({type:"manual",status:"success"}),"*"),t=f(e,i),t.start(),l.setCurrentState("human"),e.adminHelloWord&&(i.urlParams.adminHelloWord=e.adminHelloWord),i.urlParams.queueDoc=e.queueDoc||"",e.serviceEndPushMsg&&(i.urlParams.serviceEndPushMsg=e.serviceEndPushMsg||""),a?(T(i.urlParams.adminHelloWord,e),s.trigger("core.transfersuccess",{data:e})):(s.trigger("core.system",{type:"system",status:"transfer",data:{content:m.L10002.replace("{0}",e.aname)}}),s.trigger("core.transfersuccess",{data:e}),e.content=i.urlParams.adminHelloWord,i.apiConfig.adminHelloWordFlag&&s.trigger("core.system",{type:"human",data:e})),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})},w=function(e,t){i.urlParams.msgflag?e.content=m.L10001:e.content=m.L10001+" "+p,s.trigger("core.system",{type:"system",status:"blacklist",data:e}),t&&k()},x=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(i);return null!=t?unescape(t[2]):null;
},F=function(e){var t;e&&(t=!!e.clickType),c(i,null,g,e).then(function(e,n){var o,r=e.groupId||"",l=e.tranType||"",c=e.transferFlag||"",d=e.keyword||"",f=e.keywordId||"",p=e.queueFlag,m=e.transferType;transferAction=e.transferAction,o=a&&"websocket"==a.type?8:1;var h=i.urlParams,y="/chat/user/chatconnect.action",T={sysNum:i.sysnum,uid:i.apiInit.uid,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,way:o,current:g,groupId:r||"",keyword:d||"",keywordId:f||"",queueFlag:p,transferType:m,transferAction:decodeURIComponent(transferAction),summaryParams:i.urlParams.summaryParams,adminHelloWord:i.urlParams.adminHelloWord};if(1==p){var F={answer:"您的消息涉及重点业务，正在为您转接人工客服",answerType:"5",msgId:"",ustatus:-1};s.trigger("core.onreceive",{list:[F],type:"robot"})}null!=x("queueFirst")&&(T.queueFirst=x("queueFirst")),h.autoManual&&h.aid&&(y="/chat/user/invite.action",T.aid=h.aid),u({url:y,type:"post",dataType:"json",data:T,success:function(e){if(1==e.status||"keySwitch"!=l||1!=c||e.count||1==e.queueFlag){if(e.status==-1)return void s.trigger("core.sessionclose",7);v++,v>6||(i.urlParams.leaveMsgGroupId=r,2==e.status?j(e,t):0==e.status?b(e,t,f):1==e.status?I(e,t):3==e.status?(s.trigger("core.sessionclose",7),w(e,t),$(".js-queueing").remove()):6==e.status?(delete i.urlParams.aid,i.apiConfig.smartRouteInfoFlag=!1,s.trigger("core.grouplist")):7==e.status&&(e.content=e.msg,s.trigger("core.system",{type:"system",status:"queue",data:e})))}},fail:function(){}})},function(){})},k=function(e,a){e||(e=[]);var n=new Date,c={date:o.formatDate(n),content:[{senderType:1,t:+n,msg:i.urlParams.robotHelloWord,ts:o.formatDate(n,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};!i.apiInit.multiFlag&&i.apiConfig.robotHelloWordFlag&&e.push(c),setTimeout(function(){s.trigger("core.initsession",e)},0),t=new r(i),l.setCurrentState("robot")},C=function(e){for(var n=e.list||[],o=0,r=n.length;o<r;o++){var c=n[o],d=c;if(200===c.type){t&&a&&(t.destroy(),t=a,a=null),l.setCurrentState("human"),s.trigger("core.system",{type:"system",status:"transfer",data:{content:m.L10002.replace("{0}",d.aname)}}),d.serviceInfo.adminHelloWord&&(i.urlParams.adminHelloWord=d.serviceInfo.adminHelloWord),d.content=i.urlParams.adminHelloWord,i.apiConfig.adminHelloWordFlag&&s.trigger("core.system",{type:"human",data:d}),s.trigger("core.buttonchange",{type:"transfer",action:"hide"});break}}},L=function(){s.on("sendArea.artificial",F),s.on("listMsg.keyWordArtificial",F),s.on("listMsg.transTypeArtificial",F),s.on("core.onreceive",C)},S=function(){s.trigger("core.buttonchange",{type:"transfer",action:"show"});var e=i.apiInit.ustatus;if(0==e)t=new r(i),y(),l.setCurrentState("robot");else if(1==e||e==-2){var a={clickType:!0};F(a)}else e==-1&&d(i).then(k)},M=function(){h(),L(),S()};M()};i.exports=a},{"../socket/robot.js":24,"../socket/rolling.js":25,"../socket/socketfactory.js":26,"../socket/websocket.js":27,"../util/date.js":28,"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./currentState.js":11,"./initsession.js":15,"./transfer.js":22}],20:[function(e,i,t){var a=function(i){var t,a,s=e("../util/listener.js"),n=e("../util/promise.js"),o=e("../util/date.js"),r=e("../socket/robot.js"),l=e("./currentState.js"),c=(e("../socket/websocket.js"),e("../socket/rolling.js"),e("./transfer.js")),d=e("./initsession.js"),u=i.apiConfig.leaveMsg,f=e("../socket/socketfactory.js"),p=e("../util/monitAjax.js")(i),m=i.language.lan,g=!1,v=function(e,i,a){t&&t.destroy(),e.content=m.L10027+" "+u,s.trigger("core.buttonchange",{type:"transfer",action:"hide",data:e}),i?setTimeout(function(){s.trigger("core.sessionclose",-1)},1):s.trigger("core.sessionclose",-1)},h=function(e,t,a){var n=a?t.aface:i.apiConfig.robotLogo,r=a?t.aname:i.apiConfig.robotName,a=a||i.urlParams.robotHelloWord,l=i.apiInit.ustatus==-2?1:0;e||(e=[]);var c=new Date,d={date:o.formatDate(c),content:[{senderType:l?1:a?2:1,t:+c,msg:a,ts:o.formatDate(c,!0),senderFace:n,senderName:r}]};i.apiConfig.robotHelloWordFlag&&e.push(d),setTimeout(function(){s.trigger("core.initsession",e)},0)},y=function(e,t){i.urlParams.msgflag?e.content=m.L10001:e.content=m.L10001+" "+u,e.aname=m.L10025,s.trigger("core.system",{type:"system",status:"blacklist",data:e}),s.trigger("core.sessionclose",-1)},T=function(e,a,n){var o=m.L10004.replace("{0}",e.count);g=!0,t&&t.destroy(),t=f(e,i),t.start(),a?setTimeout(function(){i.urlParams.msgflag?e.content=o:e.content=o+" "+u,e.aname=m.L10026,s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-2)},1):(i.urlParams.msgflag?e.content=o:e.content=o+" "+u,e.aname=m.L10026,s.trigger("core.system",{type:"system",status:"queue",data:e}),s.trigger("core.sessionclose",-2))},j=function(e,t){var t=t||new n;return d(i,t).then(function(e,t){e||(e=[]);var a=new Date,n={date:o.formatDate(a),content:[{senderType:1,t:+a,msg:i.urlParams.robotHelloWord,ts:o.formatDate(a,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};return i.apiConfig.robotHelloWordFlag&&e.push(n),setTimeout(function(){s.trigger("core.initsession",e)},0),t}),t},b=function(){setTimeout(function(){s.trigger("core.sessionclose",-1)},0)},I=function(e,n,o){var o=!!o;d(i,n).then(function(n,r){var c;c=a&&"websocket"==a.type?8:1;var d=i.urlParams,u="/chat/user/chatconnect.action",j={sysNum:i.sysnum,uid:i.apiInit.uid,chooseAdminId:i.urlParams.aid||"",tranFlag:i.urlParams.tranFlag,way:c,current:g,groupId:e||"",summaryParams:i.urlParams.summaryParams};d.autoManual&&d.aid&&(u="/chat/user/invite.action",j.aid=d.aid),p({url:u,type:"post",dataType:"json",data:j,success:function(a){return a.status==-1?void s.trigger("core.sessionclose",7):void(2==a.status?v(a,o,n):0==a.status?(i.urlParams.groupId=e,T(a,o,n)):1==a.status?(window.parent&&window.postMessage&&"iframe"==i.urlParams.from&&window.parent.postMessage(JSON.stringify({name:"manual",status:"success"}),"*"),o?(h(n,a,i.urlParams.adminHelloWord),s.trigger("core.transfersuccess",{data:a})):(s.trigger("core.system",{type:"system",status:"transfer",data:{content:m.L10002.replace("{0}",a.aname)}}),s.trigger("core.transfersuccess",{data:a}),a.content=i.urlParams.adminHelloWord,s.trigger("core.system",{type:"human",status:"transfer",data:a})),t&&t.destroy(),t=f(a,i),l.setCurrentState("human"),t.start(),window.parent&&window.postMessage&&window.parent.postMessage(JSON.stringify({type:"manual",status:"success"}),"*"),s.trigger("core.buttonchange",{type:"transfer",action:"hide"})):3==a.status?(s.trigger("core.sessionclose",7),y(a,o)):6==a.status&&(delete i.urlParams.aid,s.trigger("core.grouplist")))},fail:function(){}})})},w=function(e,t,a){var a=!!a,t=new n;return c(i,t,g).then(function(){I(null,null,a)},b),t},x=function(e,t){e||(e=[]);var a=new Date,n={date:o.formatDate(a),content:[{senderType:1,t:+a,msg:i.urlParams.robotHelloWord,ts:o.formatDate(a,!0),senderFace:i.apiConfig.robotLogo,senderName:i.apiConfig.robotName}]};!i.apiInit.multiFlag&&i.apiConfig.robotHelloWordFlag&&e.push(n),setTimeout(function(){s.trigger("core.initsession",e)},0)},F=function(){},k=function(){},C=function(){var e=i.apiInit.ustatus;0==e?(setTimeout(function(){s.trigger("core.buttonchange",{type:"transfer",action:"hide"})},5),t=new r(i),l.setCurrentState("robot"),j()):e==-1?(setTimeout(function(){s.trigger("core.buttonchange",{type:"transfer",action:"hide"})},5),t=new r(i),l.setCurrentState("robot"),d(i).then(x)):w(null,null,!0)},$=function(){F(),k(),C()};$()};i.exports=a},{"../socket/robot.js":24,"../socket/rolling.js":25,"../socket/socketfactory.js":26,"../socket/websocket.js":27,"../util/date.js":28,"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./currentState.js":11,"./initsession.js":15,"./transfer.js":22}],21:[function(e,i,t){var a={},s='<div class="shadow-layer js-shadow-layer"><div class="group-outer js-group-outer"><div class="group-title">{{= it.languageText.T0010}}</div><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.groupId}}">{{=item.recGroupName}}</li>{{  } }}</ul></div><div class="group-footer"><span class="js-cancel-btn cancel">{{=it.languageText.T0000}}</span></div></div></div>',n='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer"><p class="group-title">{{= it.languageText.T0010}}<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.groupId}}">{{=item.recGroupName}}</li>{{  } }}</ul></div></div></div>',o='<div class=""><div class="chatBeforeFormlayer js-chatBeforeFormlayer"></div><div id="chatBeforeForm" class="chatBeforeForm js-chatBeforeForm"> <div class="js-chatBeforeFormHeader chatBeforeFormHeader"><p class="title">{{=it.formTitle}}</p><span class="close js-cancel-btn"></span></div><div class="chatBeforeFormBody js-chatBeforeFormBody"><div class="guide">{{=it.formDoc}}</div><div class="definedFields js-definedFields">{{for(var i=0;i<it.definedField.length;i++){}} {{if(it.definedField[i].cusFieldConfig.fieldType==1){}} <div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><input type="text" class="definedInput js-definedInput" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}"><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==2){}}<div class="definedArea js-definedArea"> <p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><textarea class="definedTextarea js-definedInput" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}"></textarea><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==3){}}<div class="definedArea definedDateArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><input type="text" class="definedInput js-definedDate" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId}}" id="dp{{=it.definedField[i].cusFieldConfig.fieldId}}" readonly="readonly" ><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}" style="margin:3px 3%">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p>{{}else if(it.definedField[i].cusFieldConfig.fieldType==4){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="definedTimeDropList js-dropdownList" id="hour{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="js-dropdown-btn"><p class="definedTimeInput js-dropdown-title js-definedHour">00</p><span class="dropListTitleIcn"></span></div><ul class="dropdown-menus js-dropdown-menu zc-scroll">{{for(var j=0;j < 24;j++){}}{{if(j<10){}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{="0"+j}}</li>{{}else{}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{=j}}</li>{{}}}{{}}}</ul></div><span class="definedTimeText">:</span><div class="definedTimeDropList js-dropdownList" id="minute{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="js-dropdown-btn"><p class="definedTimeInput js-dropdown-title js-definedMinutes">00</p> <span class="dropListTitleIcn"></span></div><ul class="dropdown-menus js-dropdown-menu zc-scroll">{{for(var j=0;j < 60;j++){}}{{if(j<10){}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{="0"+j}}</li>{{}else{}}<li class="js-dropdownLi dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" style="width:60px;">{{=j}}</li>{{}}}{{}}} </ul></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p> <div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==5){}}<div class="definedArea js-definedArea"><p class="title">{{=it.definedField[i].cusFieldConfig.fieldName}}{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}}</p><input class="definedInput js-definedInput js-definedNumInput js-definedNumInput{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" type="number" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==6){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="js-dropdownList dropdownList" id="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}"><div class="definedDropList js-dropdown-btn"><p class="definedDropListTitle js-dropdown-title">{{=it.languageText.T0118}}</p><span class="dropListTitleIcn"></span></div><ul class="definedDropListUl js-dropdown-menu zc-scroll">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}}<li class="js-dropdownLi" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue}}" fieldType="{{=it.definedField[i].cusFieldDataInfoList[j].fieldType}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}" title="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}<span></span></li>{{}}}</ul><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==7){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><ul class="definedCheckedUl">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}} <li class="definedCheckedLi  js-userCheck {{=it.definedField[i].cusFieldDataInfoList[j].userCheckIcoActive=="userCheckIcoActive"?"":"userCheck"}}" data-fieldId="{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue?it.definedField[i].cusFieldDataInfoList[j].dataValue:""}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}"><span class="definedCheckedLiIcn js-userCheckIco{{=it.definedField[i].cusFieldConfig.fieldId?it.definedField[i].cusFieldConfig.fieldId:""}} {{=it.definedField[i].cusFieldDataInfoList[j].userCheckIcoActive=="userCheckIcoActive"?"userCheckIcoActive":""}}"></span><span class="definedCheckedLiText">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}</span></li>{{}}}</ul><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==8){}}<div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span> {{}}} {{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="definedOptionUl js-optionArea">{{for(var j=0;j<it.definedField[i].cusFieldDataInfoList.length;j++){}} <div class="js-userOpt definedOptionLi {{=it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive=="userOptIcoActive"?"":"userOpt"}}" data-fieldId="{{=it.definedField[i].cusFieldDataInfoList[j].fieldId?it.definedField[i].cusFieldDataInfoList[j].fieldId:""}}" dataValue="{{=it.definedField[i].cusFieldDataInfoList[j].dataValue?it.definedField[i].cusFieldDataInfoList[j].dataValue:""}}" dataName="{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}"><span class="userOptIco js-userOptIco{{=it.definedField[i].cusFieldDataInfoList[j].fieldId}} {{=it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive=="userOptIcoActive"?it.definedField[i].cusFieldDataInfoList[j].userOptIcoActive:""}}"></span><p class="definedOptionLiText">{{=it.definedField[i].cusFieldDataInfoList[j].dataName}}</p></div>{{}}}</div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}else if(it.definedField[i].cusFieldConfig.fieldType==9){}} <div class="definedArea js-definedArea"><p class="title">{{if(it.definedField[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div class="js-dropdownList dropdownList" id="province"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title">{{=it.languageText.T0121}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-provinceDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both"></div></div><div class="js-dropdownList dropdownList" id="city"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title js-cityDropListTitle">{{=it.languageText.T0122}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-cityDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both;"></div></div><div class="js-dropdownList dropdownList" id="county"><div class="cityDropList js-dropdown-btn"><p class="cityDropListTitle js-dropdown-title js-countryDropListTitle">{{=it.languageText.T0123}}</p><span class="dropListTitleIcn"></span></div><ul class="cityDropListUl js-countryDropListUl js-dropdown-menu zc-scroll"></ul><div style="clear:both"></div></div><p class="errorTip js-errorTip{{=it.definedField[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0108}}{{=it.definedField[i].cusFieldConfig.fieldName}}</p><div style="clear:both"></div></div>{{}}}{{}}}</div></div><div class="submitArea"><span class="submit js-chatBeforeFormSubmit">{{=it.languageText.T0120}}</span></div></div></div>',r='<div><div class="chatFormLayer js-chatFormLayer"><div class="chatBeforeForm"><div class="header"><p class="title">{{=it.formTitle}}</p><span class="closeForm js-closeForm">×</span></div><div class="chatBeforeForm-content js-chatBeforeForm-content"><div class="wrap-helper js-wrap-helper"><div class="js-helper helper"><div><p><span>{{=it.formDoc}}</span></p></div></div></div><div class="definedAreas">{{for(var i=0;i<it.items.length;i++){}}{{if(it.items[i].cusFieldConfig.fieldType==1){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><input type="text" class="definedInput js-definedInput" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div>{{}else if(it.items[i].cusFieldConfig.fieldType==2){}} <div class="definedArea js-definedArea"><p class="title" style="height:80px">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><textarea class="definedTextarea js-definedInput" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></textarea></div>{{}else if(it.items[i].cusFieldConfig.fieldType==3){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDateArea js-definedDateArea"><input type="text" class="definedDate js-definedDate" placeholder="{{=it.languageText.T0127}}xxxx-xx-xx" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==4){}} <div class="definedArea js-definedArea"><p class="title" style="width:18%">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedTimeArea"><input type="text" readonly="readonly" value="00" date-type="hour" class="definedTimeDropList js-definedTimeDropList js-definedHour"><span  class="definedTimeText">{{=it.languageText.T0115}} <span class="definedTimeIcn"></span> |</span><input type="text" readonly="readonly" value="00" date-type="minutes" class="definedTimeDropList js-definedTimeDropList js-definedMinutes"><span  class="definedTimeText">{{=it.languageText.T0116}} <span class="definedTimeIcn"></span></span><div class="dropListArea js-dropListArea js-dropListHour"><p class="dropListAreaTitle"><span class="titleText">{{=it.languageText.T0114}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><ul class="definedTimeDropListUl">{{for(var j=0;j<24;j++){}} {{if(j<10){}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="hour" dataValue="{{="0"+j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{="0"+j}}<span></span></li>{{}else{}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="hour" dataValue="{{=j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=j}}<span></span></li>{{}}}{{}}}</ul></div><div class="dropListArea js-dropListArea js-dropListMinutes"><p class="dropListAreaTitle"><span class="titleText">{{=it.languageText.T0113}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><ul class="definedTimeDropListUl">{{for(var j=0;j<60;j++){}} {{if(j<10){}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="minutes" dataValue="{{="0"+j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{="0"+j}}<span></span></li>{{}else{}}<li class="js-definedTimeLi js-dropLIstAreaClose" date-type="minutes" dataValue="{{=j}}" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=j}}<span></span></li>{{}}}{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==5){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><input class="definedInput js-definedInput" type="number" oninput="if(value.length>300)value=value.slice(0,300)"  fieldId="{{=it.items[i].cusFieldConfig.fieldId}}"></div>{{}else if(it.items[i].cusFieldConfig.fieldType==6){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedDropListUlWidely"><ul class="definedDropListUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="js-definedDropListLi js-dropLIstAreaClose" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedDropListLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==7){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedCheckedUlWidely zc-scroll"><ul class="definedCheckedUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="definedCheckedLi js-definedCheckedLi" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedCheckedLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div><p class="checkedSure js-checkedSure" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}">{{=it.languageText.T0001}}</p></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==8){}} <div class="definedArea js-definedArea"><p class="title">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><div class="definedDropList js-definedDropList"><p class="definedDropListText js-definedDropListText"></p><span class="definedDropListTextIcn"></span></div><div class="dropListArea js-dropListArea"><p class="dropListAreaTitle"><span class="titleText">{{=it.items[i].cusFieldConfig.fieldName}}</span><span class="close js-dropLIstAreaClose">{{=it.languageText.T0111}}</span></p><div class="definedDropListUlWidely"><ul class="definedDropListUl">{{for(var j=0;j<it.items[i].cusFieldDataInfoList.length;j++){}}<li class="js-definedDropListLi js-dropLIstAreaClose" fieldId="{{=it.items[i].cusFieldConfig.fieldId}}" dataValue="{{=it.items[i].cusFieldDataInfoList[j].dataValue}}" dataName="{{=it.items[i].cusFieldDataInfoList[j].dataName}}"><span class="definedDropListLiText">{{=it.items[i].cusFieldDataInfoList[j].dataName}}</span><span class="icn"></span></li>{{}}}</ul></div></div></div>{{}else if(it.items[i].cusFieldConfig.fieldType==9){}}<div class="cityArea "><p class="text">{{=it.items[i].cusFieldConfig.fieldName}}{{if(it.items[i].cusFieldConfig.fillFlag==1){}}<span class="icon">*</span>{{}}}</p><p class="cityAreaTitle js-cityAreaTitle"></p><span class="classIfyIcn"></span><div class="cityAreaLayer js-orderClassifyLayer"><div class="cityAreaInner js-orderClassifyInner"><div class="titleArea"><span class="title js-cityTitle">{{=it.languageText.T0121}}</span><span class="close js-orderClassifyClose">{{=it.languageText.T0111}}</span></div><div class="areaListArea js-areaListArea"></div></div></div></div>{{}}}{{}}}</div><div class="chatBeforeFormCommitWidely"><p class="chatBeforeFormCommit js-chatBeforeFormCommit">{{=it.languageText.T0120}}</p></div></div><div class="definedLayer js-definedLayer"></div></div></div>',l='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].provinceId){}}<p class="js-provinceList" provinceId="{{=it.items[i].provinceId}}" provinceName="{{=it.items[i].provinceName}}" endFlag="{{=it.items[i].endFlag}}">{{=it.items[i].provinceName}}{{if(!it.items[i].endFlag){}}<span class="firstIcon"></span>{{}}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',c='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].cityId){}}<p class="js-provinceList" cityId="{{=it.items[i].cityId}}" cityName="{{=it.items[i].cityName}}" endFlag="{{=it.items[i].endFlag}}">{{=it.items[i].cityName}}{{if(!it.items[i].endFlag){}}<span class="firstIcon"></span>{{}}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',d='<div class="cityList"><div class="questionList js-firstQuestionList">{{ for(var i=0;i<it.items.length;i++){ }}{{if(it.items[i].areaId){}}<p class="js-provinceList" areaId="{{=it.items[i].areaId}}" areaName="{{=it.items[i].areaName}}">{{=it.items[i].areaName}}<span class="sureActive"></span></p>{{}}}{{ } }}</div></div>',u='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" provinceId="{{=it.list[i].provinceId}}" title="{{=it.list[i].provinceName}}">{{=it.list[i].provinceName}}</li>{{}}}',f='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" cityId="{{=it.list[i].cityId}}" title="{{=it.list[i].cityName}}">{{=it.list[i].cityName}}</li>{{}}}',p='{{for(var i=0;i<it.list.length;i++){}}<li class="js-cityLi" areaId="{{=it.list[i].areaId}}" title="{{=it.list[i].areaName}}">{{=it.list[i].areaName}}</li>{{}}}',m='<div><div class="js-showTip showTip"><p class="showTipText">{{=it.text}}</p></div></div>';a.groupTemplate=s,a.groupTemplatePC=n,a.provinceEle=u,a.cityEle=f,a.countryEle=p,a.chatBeforeFormPc=o,a.chatBeforeFormH5=r,a.provinceEleH5=l,a.cityListEleH5=c,a.areaListEleH5=d,a.showTip=m,i.exports=a},{}],22:[function(e,i,t){function a(i,t,a,s){var n=(e("../util/listener.js"),e("../util/promise.js"));t=t||new n;var o=(e("./template.js"),i.language.lan,i.language.text,e("./chatGroups.js")),r=e("./chatBeforeForm.js"),l=e("../util/monitAjax.js")(i),c=function(e,i,t,a){var s;s=a&&"keySwitch"===a.switchType?"":e.urlParams.groupId||"";var n=e.urlParams.transferAction||"",o=e.urlParams,r={global:e,groupId:s,transferType:a&&a.transferType?a.transferType:"",queueFlag:a&&a.queueFlag?a.queueFlag:"",transferFlag:a&&a.transferFlag?a.transferFlag:"",transferAction:n},c=a?a.switchType:"",d=a?a.groupId:"",u=a?a.transferFlag:"",f=a?a.keyword:"",p=a?a.keywordId:"";if(queueFlag=a?a.queueFlag:"","transferType"==c&&(r.tranType="transferType",r.transferFlag=u),"keySwitch"==c)if(s){if(1==queueFlag){var m={global:e,groupId:"",tranType:c,transferFlag:u,keyword:f,keywordId:p,queueFlag:queueFlag,transferAction:n};setTimeout(function(){i.resolve(m)},0)}}else{var m={global:e,groupId:d,tranType:c,transferFlag:u,keyword:f,keywordId:p,queueFlag:queueFlag,switchTypeStyle:a.switchTypeStyle,transferAction:n};setTimeout(function(){i.resolve(m)},0)}else o.aid&&"number"==typeof o.tranFlag?setTimeout(function(){i.resolve(r)},0):o.autoManual&&o.aid?setTimeout(function(){i.resolve(r)},0):0!==e.apiInit.ustatus&&e.apiInit.ustatus!==-1?setTimeout(function(){i.resolve(r)},0):t?setTimeout(function(){i.resolve(r)},0):0===e.apiConfig.groupflag?setTimeout(function(){i.resolve(r)},0):"keySwitch"!=c&&e.urlParams.groupId&&e.urlParams.groupId.length?setTimeout(function(){i.resolve(r)},0):e.apiConfig.smartRouteInfoFlag?setTimeout(function(){i.resolve(r)},0):l({url:"/chat/user/getGroupList.action",dataType:"json",type:"get",data:{companyId:e.apiInit.pid,source:e.userInfo.source,channelFlag:e.urlParams.channelFlag||""},success:function(e){if(1==e.length){var t=e[0];r.global.urlParams.groupId=t.groupId,r.groupId=t.groupId,i.resolve(r)}else 0==e.length?i.resolve(r):(r.groupList=e,i.resolve(r))},fail:function(){}});return i};return c(i,t,a,s).then(o).then(r,function(e){
e.reject(e)}).then(function(e){t.resolve(e)},function(e){e.reject(e)}),t}i.exports=a},{"../util/listener.js":32,"../util/monitAjax.js":34,"../util/promise.js":36,"./chatBeforeForm.js":9,"./chatGroups.js":10,"./template.js":21}],23:[function(e,i,t){function a(i){var t,t,a=2e4,r=3e3,l=e("../util/monitAjax.js")(i);s.on("core.sessionclose",function(e){e!==-2&&e!==-3&&clearInterval(t)});var c=function(){l({url:"/chat/user/msgt.action",type:"post",dataType:"json",data:{uid:i.apiInit.uid,pid:i.apiInit.pid},success:function(e){e&&0==e.ustatus&&"human"==n.getCurrentState()&&s.trigger("core.sessionclose",4);var i=o.isReady();if(i){var t="rolling"===o().getType()?1:8;t!==e.way&&s.trigger("core.sessionclose",4)}},error:function(e){var i=new Image;i.src="images/static/errorlog.png?t="+ +new Date+"&response="+encodeURIComponent(e.response)+"&status="+e.status+"&statusText="+encodeURIComponent(e.statusText)+"&timeout="+e.timeout+"&from=heartbeat_user"}})};setTimeout(function(){c(),t=setInterval(c,a)},r)}var s=e("../util/listener.js"),n=e("../mode/currentState.js"),o=e("./socketfactory.js");i.exports=a},{"../mode/currentState.js":11,"../util/listener.js":32,"../util/monitAjax.js":34,"./socketfactory.js":26}],24:[function(e,i,t){function a(i){var t=e("../util/listener.js"),a="robot",s=!1,n=e("../util/monitAjax.js")(i),o=e("../util/errorlog.js"),r=function(){},l=function(e){return e.uid+""+e.date},c=function(e){var r=e[0];if(!r.leaveMsg&&"robot"===r.currentStatus){var c=(l(r),r.answer.replace(/(^\s+|\s+$)/g,""));/^\d+$/.test(c)||(s=!1),"question"==r.requestType&&(s=!0),r.answer||o.specialError("question_blank","common_robot",r,i),n({url:"/chat/user/robotsend.action",data:"type",data:{requestText:("string"==typeof r.requestText?r.requestText:JSON.stringify(r.requestText))||r.answer||"",question:("object"==typeof r.multiDiaQuestion?JSON.stringify(r.multiDiaQuestion):r.multiDiaQuestion)||r.answer,sysNum:i.sysNum,uid:i.apiInit.uid,cid:i.apiInit.cid,source:i.userInfo.source,questionFlag:2===r.questionFlag?r.questionFlag:s?1:0,lanFlag:i.urlParams.lanFlag||0,robotFlag:i.urlParams.robotFlag||""},type:"post",success:function(e){var i="object"==typeof e?e:JSON.parse(e);if(4==i.answerType&&(s=!0),t.trigger("core.onreceive",{list:[i],type:a}),t.trigger("core.msgresult",{msgId:r.dateuid,result:"success"}),i.keyword)t.trigger("core.keySwitchAdmin",i);else if(1==i.transferType||2==i.transferType||5==i.transferType){var n={answer:"对不起，未能解决您的问题，正在为您转接人工客服",answerType:"5",msgId:"",transferType:0,ustatus:-1};t.trigger("core.onreceive",{list:[n],type:a}),t.trigger("core.transTypeSwitchAdmin",i)}0===i.ustatus&&t.trigger("core.sessionclose",8)},error:function(e){t.trigger("core.msgresult",{msgId:r.dateuid,result:"fail"})}}),s=!1}},d=function(){t.off("sendArea.send",c),t.off("sendArea.sendSugguestions",c),t.off("multiConv.send",c)},u=function(){t.on("sendArea.send",c),t.on("sendArea.sendSugguestions",c),t.on("multiConv.send",c)},f=function(){r(),u()};this.destroy=d,f()}i.exports=a},{"../util/errorlog.js":29,"../util/listener.js":32,"../util/monitAjax.js":34}],25:[function(e,i,t){function a(i,t,a){this.puid=i;var n,o=e("../util/listener.js"),r=e("../util/monitAjax.js")(a),l=e("../util/errorlog.js"),c="human",d=0,u={},f=(a.language.lan,this),p=function(e,t){var t=t||0,a=e[0];if("human"===a.currentStatus){a.date?a.ts=a.date:a.ts=+new Date;var s={};s=24==a.msgType?{puid:i,cid:a.cid,uid:a.uid,msgType:a.msgType,content:a.miniPage}:{puid:i,cid:a.cid,uid:a.uid,content:a.answer},r({url:"/chat/user/chatsend.action",data:s,dataType:"json",type:"POST",success:function(e){o.trigger("core.msgresult",{msgId:a.dateuid,result:"success"})},error:function(e){t>=3?o.trigger("core.msgresult",{msgId:a.dateuid,result:"fail"}):setTimeout(function(){p([a],t+1)},1e3)}})}},m=function(){clearInterval(n)},g=function(e){for(var i=[],t=0,a=e.length;t<a;t++){var s=e[t],n={type:300,utype:d,cid:s.cid,uid:s.uid,msgId:s.msgId};i.push(n)}i.length<=0||!JSON.stringify||r({url:"/chat/user/msg/ack.action",dataType:"json",data:{content:JSON.stringify(i),tnk:+new Date},type:"POST"})},v=function(){r({url:"/chat/user/msg.action",dataType:"json",data:{puid:i,uid:a.apiInit.uid,token:+new Date},type:"get",success:function(e){if(e&&e.length)try{for(var i=[],t=[],s=0;s<e.length;s++){var n=JSON.parse(e[s]);if(n.msgId||(n.msgId=+new Date+Math.random().toString(36).substr(2)+n.type),!u[n.msgId])if(u[n.msgId]=!0,i.push(n),202===n.type&&t.push(n),204===n.type){var r=a.urlParams.serviceEndPushMsg.replace("#客服#",n.aname);if(o.trigger("core.sessionclose",n.status),2==n.status||4==n.status)a.apiConfig.serviceEndPushFlag&&o.trigger("core.system",{type:"system",status:"kickout",data:{content:r}});else if(5==n.status){var d="温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！";o.trigger("core.system",{type:"system",status:"kickout",data:{content:d}})}}else 212==n.type?o.trigger("core.system",{type:"system",status:"",data:{content:n.content}}):215==n.type&&o.trigger("core.system",{type:"overTimeTips",status:"",data:{content:n.content,sysType:n.sysType}})}window.parent&&"iframe"===a.urlParams.from&&t.length>0&&window.postMessage&&window.parent.postMessage(JSON.stringify({name:"zhichiReceive",data:t}),"*"),g(i),o.trigger("core.onreceive",{type:c,list:i})}catch(f){l.runtimeError(f,"onreceive.rolling",{type:c,list:i},a)}},error:function(e,i){var t=new Image;t.src="images/static/errorlog.png?t="+ +new Date+"&e="+encodeURIComponent(i)+"&reponse="+e.responseText+"&uid="+a.apiInit.uid}})},h=function(){o.on("sendArea.send",p),o.on("multiConv.send",p),o.on("sendArea.sendSugguestions",p)},y=function(){setInterval(v,1500),s(a)},T=function(){h(),y()};T(),this.getType=function(){return f.type},this.type="rolling",this.destroy=m,this.start=v}var s=e("./heartbeat.js");i.exports=a},{"../util/errorlog.js":29,"../util/listener.js":32,"../util/monitAjax.js":34,"./heartbeat.js":23}],26:[function(e,i,t){var a=null,s=3e5,n=!1,o=function(i,t){if(a)return a;var o=+new Date;window.localStorage&&(o=+window.localStorage.getItem("websocketerror"));var r=!0;o&&(r=+new Date-o>s);var l=e("../socket/websocket.js"),c=e("../socket/rolling.js"),d=i["wslink.bak"];d.push(i["wslink.default"]);var u=i["wslink.default"];return a=window.WebSocket&&r&&(u.indexOf("ws:")>=0||u.indexOf("wss:")>=0)?new l(i.puid,d,u,t):new c(i.puid,i["wslink.default"],t),n=!0,a};o.isReady=function(){return n},i.exports=o},{"../socket/rolling.js":25,"../socket/websocket.js":27}],27:[function(e,i,t){function a(i,t,a,n){this.puid=i;var o,r,l,c=(Math.floor(Math.random()*t.length),"human"),d={},u=e("../util/listener.js"),f=e("../util/errorlog.js"),p=e("../util/date.js"),m=15e3,g=n.language.lan,v=this;this.channelId=Math.random().toString(32).substr(2);var h=!1,y=0,T=0,j=0,b=(new Date,5e3),I=0,w={},x=function(){var e=+new Date;for(var i in w){var t=w[i];e-t.sendTime>=b&&(delete w[i],u.trigger("core.msgresult",{msgId:t.dateuid,result:"fail"}))}},F=function(e){var i=e;if(Object.prototype.toString.call(e).indexOf("Array")>=0&&(i=e[0]),"human"===i.currentStatus){var t=i.date?new Date(i.date):new Date;i.t=+t,i.ts=p.formatDate(t,!0),i.type=103,i.msgId=i.dateuid,i.sendTime=i.date,i.channelId=v.channelId,i.content=i.answer,i.uname=n.apiInit.uname;var a=$("<div></div>");a.text(i.uname),i.uname=a.html(),i.face=n.userInfo.face,w[i.msgId]=i,T++;try{o.send(JSON.stringify(i))}catch(s){if(window.location.reload(!0),window.localStorage)try{window.localStorage.setItem("websocketerror",+new Date)}catch(s){}P(),alert(g.L10043)}}},k=function(e){u.trigger("core.msgresult",{msgId:e.msgId,result:"success"}),delete w[e.msgId]},C=function(e){u.trigger("core.onreceive",{type:c,list:[e]})},L=function(e){var i=n.urlParams.serviceEndPushMsg.replace("#客服#",e.aname);if(204==e.type){if(u.trigger("core.sessionclose",e.status),h=e.status%2==0,o.close(),2==e.status||4==e.status)u.trigger("core.system",{type:"system",status:"kickout",data:{content:i}});else if(5==e.status){var t="温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！";u.trigger("core.system",{type:"system",status:"kickout",data:{content:t}})}}else 212==e.type?u.trigger("core.system",{type:"system",status:"",data:{content:e.content}}):215==e.type&&u.trigger("core.system",{type:"overTimeTips",status:"",data:{content:e.content,sysType:e.sysType}});u.trigger("core.onreceive",{type:c,list:[e]})},S=function(e){if(301!=e.type){var i={type:300,msgId:e.msgId,utype:I,data:[e],channelId:v.channelId};try{o.send(JSON.stringify(i))}catch(t){}}},M=function(e){if("pong"===e.data)return clearTimeout(l),void(l=setTimeout(function(){o.close()},m));j++;var i=JSON.parse(e.data);if(!d[i.msgId+"_"+i.type]){var t=[];202===i.type&&t.push(i),window.top&&"iframe"===n.urlParams.from&&t.length>0&&window.top.postMessage(JSON.stringify({name:"zhichiReceive",data:t}),"*"),S(i),i.msgId||(i.msgId=+new Date+Math.random().toString(36).substr(2)+i.type),d[i.msgId+"_"+i.type]=i;try{301==i.type?k(i):202==i.type?C(i):L(i)}catch(a){f.runtimeError(a,"receive.websocket",i,n)}}},P=function(){if(y++>=3){var e=g.L10003.replace("{0}","");return u.trigger("core.system",{type:"system",status:"kickout",data:{content:e}}),void u.trigger("core.sessionclose",-4)}setTimeout(function(){Math.floor(Math.random()*t.length);o=new WebSocket(a),o.onerror=N,o.onopen=D,o.onclose=_,o.onmessage=M},5e3)},A=function(e){if(window.localStorage&&!h)try{window.localStorage.setItem("websocketerror",+new Date)}catch(e){f.runtimeError(e,"localStorage error",data,n)}h||P()},D=function(){r=setInterval(function(){o.send("ping")},5e3),window.localStorage&&window.localStorage.removeItem("websocketerror");var e={t:I,u:n.apiInit.uid,puid:i,s:n.sysnum,ts:+new Date},t=0;for(var a in w)t++;y=0,o.send(JSON.stringify(e));for(var a in w){var s=w[a];o.send(JSON.stringify(s))}setInterval(x,1e3)},_=function(e){A(e),clearTimeout(r)},N=function(e){},R=function(){o.onerror=N,o.onopen=D,o.onclose=_,o.onmessage=M,u.on("sendArea.send",F),u.on("sendArea.sendSugguestions",F)},O=function(){R()},B=function(){o&&(o.close(),clearTimeout(r))},z=function(){o=new WebSocket(a),O(),s(n)},E=function(){};this.getType=function(){return v.type},this.type="websocket",this.destroy=B,this.start=z,this.stop=E}var s=e("./heartbeat.js");i.exports=a},{"../util/date.js":28,"../util/errorlog.js":29,"../util/listener.js":32,"./heartbeat.js":23}],28:[function(e,i,t){var a={},s=function(e){return e>=10?e+"":"0"+e},n=function(e){var i=s,t=e.getHours(),a=e.getMinutes(),n=e.getSeconds(),o=[i(t),i(a),i(n)];return o.join(":")},o=function(e,i){var t=s,a=e.getFullYear(),o=e.getMonth()+1,r=e.getDate(),l=[t(a),t(o),t(r)],c=e.getHours(),d=e.getMinutes(),u=e.getSeconds();[t(c),t(d),t(u)];return l.join("-")+(i?" "+n(e):"")};a.formatTime=n,a.formatDate=o,i.exports=a},{}],29:[function(e,i,t){var a,s={},n=e("../config/config.json"),o=e("../lib/detect.js"),r=encodeURIComponent,l=/Mobile/.test(window.navigator.userAgent)?"wap":"pc",c=function(e,i,t,s){var o=new Image,c="error="+r(e.toString());c+="&stack="+r(e.stack),c+="&from="+i,c+="&os="+a.os.family,c+="&osVersion="+a.os.version,c+="&browser="+a.browser.family,c+="&browserVersion="+a.browser.version,c+="&type="+l,c+="&uid="+s.apiInit.uid,c+="&data="+r(JSON.stringify(t)),c+="&pid="+s.apiInit.pid,o.src="//"+n.errorlogPath+"runtime?"+c},d=function(e,i,t,a){return},u=function(e,i,t,a,s,n){return},f=function(e,i,t,a,s){return};!function(){var e=window.navigator.userAgent;a=o.parse(e)}(),s.networkError=f,s.runtimeError=c,s.overTimeError=u,s.specialError=d,s.init=function(){},s.getFlag=function(){return!1},i.exports=s},{"../config/config.json":2,"../lib/detect.js":5}],30:[function(e,i,t){function a(e,i){var i=i||0;if("object"!=typeof e)throw"not a json";var t=Object.prototype.toString.call(e),s="";if(/Array/.test(t)){s="[";for(var n=[],o=0;o<e.length;o++){var r=e[o];if("object"==typeof r)try{n.push(a(r,i))}catch(l){continue}else n.push(r.toString())}return s+n.join(", ")+"]"}if(/Object/.test(t)){var c,d="",u="",n=[];s="{";var f=0;for(var p in e)if(e.hasOwnProperty(p)){if("number"==typeof e[p])c="",f>0&&(c+=","),c+='"'+p+'":'+e[p],n.push(c);else if("boolean"==typeof e[p])c="",f>0&&(c+=","),c+='"'+p+'":'+e[p],n.push(c);else if("string"==typeof e[p])c="",f>0&&(c+=","),c+='"'+p+'":"'+e[p]+'"',n.push(c);else if("object"==typeof e[p]){c="";try{f>0&&(c+=","),c+='"'+p+'":'+a(e[p],i+1),n.push(c)}catch(l){continue}}f++}return s+=n.join(""+d)+""+u+"}"}throw"not a json"}i.exports=a},{}],31:[function(require,module,exports){function init(){var parse=function(str){var obj;try{obj=eval("("+str+")")}catch(e){}return obj},stringify=function(e){if(e){var i=formatJSON(e,0);return i}return""};window.JSON||(window.JSON={parse:parse,stringify:stringify})}var formatJSON=require("./formatJSON.js");module.exports=init},{"./formatJSON.js":30}],32:[function(e,i,t){var a={},s={},n=function(e,i){if(s[e])for(var t=0,a=s[e].length;t<a;t++){var n=s[e][t];n(i)}},o=function(e,i){s[e]||(s[e]=[]);for(var t=!1,a=s[e],n=0,o=a.length;n<o;n++)if(a[n]==i){t=!0;break}t||s[e].push(i)},r=function(e,i){if(i&&"function"==typeof i){var t=s[e];if(t&&t.length)for(var a=t.length,n=a-1;n>=0;n--){var o=t[n];if(o==i){t.splice(n,1);break}}}else delete s[e]};a.on=o,a.off=r,a.trigger=n,i.exports=a},{}],33:[function(e,i,t){var a=e("./promise.js"),s={},n={},o=function(e,i){var i=i||new a;if(n[e])return a.when(function(){var i=n[e],t=new a;return setTimeout(function(){t.resolve(i)},0),t});var i=a.when(function(){return $.ajax({url:e,dataType:"text",type:"get"}).success(function(t){i.resolve(t),n[e]=t}).fail(function(e){i.reject(e)}),i});return i};s.load=o;var r=function(){return s};i.exports=r},{"./promise.js":36}],34:[function(e,i,t){i.exports=function(i){if(!i)throw"global is not defined";return function(t){var a=5e3,s=e("./errorlog.js"),n={},o=$.extend({url:"",data:{}},t),r=new Date;o.success&&(n.successCallback=o.success,delete o.success),o.fail&&(n.failCallback=o.fail,delete o.fail),o.error&&(n.failCallback=o.error,delete o.error);var l=o.url,c=o.data;return o.success=function(e){var t=(new Date,new Date-r);t>=a&&s.overTimeError(e,l,c,t,o.type,i),n.successCallback&&n.successCallback(e)},o.error=function(e){s.networkError(e,l,c,o.type,i),n.failCallback&&n.failCallback(e)},$.ajax(o),n.success=function(e){return n.successCallback=e,n},n.fail=function(e){return n.failCallback=e,n},n}}},{"./errorlog.js":29}],35:[function(e,i,t){var a={doc:document,timer:null,oldTitle:"",flashFlag:!1,count:0,flash:function(e){this.flashFlag?this.clear():this.oldTitle=this.doc.title,this.flashFlag=!0;var i=this;this.timer=setInterval(function(){i.count++,i.count>=30&&(i.count=0,i.clear()),i._flash(e)},500)},_flash:function(e){this.index=this.index?0:1,this.doc.title=this.index?e:this.oldTitle},clear:function(){clearInterval(this.timer),this.flashFlag&&(this.doc.title=this.oldTitle),this.flashFlag=!1}};i.exports=a},{}],36:[function(e,i,t){function a(){var e=[],i=this;this.resolve=function(t){var a=e.shift();a&&a.success&&"function"==typeof a.success&&a.success(t,i)},this.reject=function(t){var a=e.shift();a&&a.fail&&"function"==typeof a.fail&&a.fail(t,i)},this.then=function(t,a){return e.push({success:t,fail:a}),i}}a.when=function(e){return e()},i.exports=a},{}],37:[function(e,i,t){i.exports={basePath:"/chat/pc/v2",imgPath:"http://img.sobot.com/chat/common"}},{}],38:[function(e,i,t){var a=function(i){var t,a=e("../../../common/initConfig.js")("pc"),s=e("../../../common/mode/mode.js");e("../../../common/socket/heartbeat.js");e("../../../common/util/initJSON.js")();var n,o=e("../../../common/util/listener.js"),r=function(){},l=function(){o.on("system.send",function(e){})},c=function(){t=s(n)},d=function(){r(),l(),c()};a.then(function(e){$(".white-layer").remove(),$(document.body).trigger("core.onload",[{data:e}]),n=e,d(),i.parent&&i.parent!==i&&i.parent.postMessage(JSON.stringify({name:"init"}),"*"),o.trigger("core.onload",[n])})};i.exports=a},{"../../../common/initConfig.js":3,"../../../common/mode/mode.js":16,"../../../common/socket/heartbeat.js":23,"../../../common/util/initJSON.js":31,"../../../common/util/listener.js":32}],39:[function(e,i,t){!function(i){var t=e("./core/core.js")(window,"pc"),a=e("./nesting/nesting.js"),s=e("./listMsg/index.js"),n=e("./sendArea/index.js");e("./util/json.js");var o=function(){},r=function(){window.console||(window.console={log:function(){}}),s(),n($("#footer"),t,window),a()},l=function(){o(),r()};l()}(document.body)},{"./core/core.js":38,"./listMsg/index.js":40,"./nesting/nesting.js":47,"./sendArea/index.js":52,"./util/json.js":63}],40:[function(e,i,t){var a=function(){var i,t,a,s,n,o,r,l,c,d,u,f,p=e("../../../common/util/listener.js"),m=e("../../../common/util/load.js")(),g=e("../util/qqFace.js"),v=e("../../../common/mode/offlineMessageFilter.js"),h=e("../config/config.json"),y=e("./template.js"),T=e("./theme.js"),j=e("./msgHandler.js"),b=e("../util/datetime.js"),I=e("../../../common/comm.js"),w={},x=60,F=107,k=0,C=0,L=[],S=0,M=0,P="",A=!0,D=function(){0===S&&A?(A=!1,i({type:"post",url:"/chat/user/queryUserCids.action",dataType:"json",data:{uid:t.apiInit.uid,time:t.urlParams.time||0},success:function(e){L=e.cids.reverse(),P=L[S],M=L.length-1,N(P)}})):S>0&&A&&(A=!1,P=L[S],N(P))},_=function(e){e.remindQuestion&&(e.remindQuestion=e.remindQuestion.split("\n")),e.answerStrip&&(e.answerStrip=e.answerStrip.split("\n"))},N=function(e){if(S<=M){$pulldownLoading.css("display","block"),$pulldownText.css("display","none");var r=o.find(".magBox").eq(0).attr("creattime");Number(k)||r,$(this);f=o.children().eq(0),i({type:"post",url:"/chat/user/getChatDetailByCid.action",dataType:"json",data:{uid:t.apiInit.uid,cid:e},success:function(i){i.length>0?(v(i),k=i[0].content.length>0?i[0].content[0].t:+new Date,m.load(h.basePath+"/views/listMsg/historyMsg.html").then(function(e){for(var t="",r=["<a","<img","<frame","<audio","<video","<iframe","<IFRAME","<EMBED","<embed"],l=!1,c=["<script"],d=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"],u=0;u<i.length;u++){var p=i[u].date;if(p){var m=i[u].content[0].ts;p=b.formatTime(m,s),t+=doT.template(y.msgDate)(p)}24==i[u].msgType?i[u].miniPage="string"==typeof i[u].miniPage?JSON.parse(i[u].miniPage):i[u].miniPage:25==i[u].msgType&&(i[u].miniPage="string"==typeof i[u].miniPage?JSON.parse(i[u].miniPage):i[u].miniPage);for(var g=0;g<i[u].content.length;g++){if(l=!1,9==i[u].content[g].msgType||10==i[u].content[g].msgType){"string"==typeof i[u].content[g].msg&&(i[u].content[g].msg=JSON.parse(i[u].content[g].msg));var v=i[u].content[g].msg;if(v.retCode&&"000000"!=v.retCode)"000002"==v.retCode?i[u].content[g].msg=v.retErrorMsg:"000001"==v.retCode&&(i[u].content[g].msg=doT.template(y.cyclicSessionError)(v));else if("string"==typeof v.inputContentList){var h=v.inputContentList.split(","),T={multiDiaRespInfo:v,contentAry:h,msgId:""};i[u].content[g].msg=doT.template(y.inputContentTMP)(T)}else if("object"==typeof v.inputContentList){for(var h=[],j=[],x=0;x<v.inputContentList.length;x++)for(var F in v.inputContentList[x])j.push(F),h.push(v.inputContentList[x][F]);var T={multiDiaRespInfo:v,titleAry:j,contentAry:h,msgId:""};i[u].content[g].msg=doT.template(y.inputContentTMP_1511)(T)}else switch(v.template){case 0:_(v);var T={multiDiaRespInfo:v,msgId:v.msgId,from:"history",clickFlag:!0};i[u].content[g].msg=doT.template(y.cyclicSessionTMP0)(T);break;case 1:_(v);var T={multiDiaRespInfo:v,from:"history",clickFlag:!0};i[u].content[g].msg=doT.template(y.cyclicSessionTMP1)(T);break;case 2:_(v);var T={multiDiaRespInfo:v,from:"history",clickFlag:!0};i[u].content[g].msg=doT.template(y.cyclicSessionTMP2)(T);break;case 3:_(v);var T={multiDiaRespInfo:v};i[u].content[g].msg=doT.template(y.cyclicSessionTMP3)(T);break;case 4:_(v);var T={multiDiaRespInfo:v};i[u].content[g].msg=doT.template(y.cyclicSessionTMP4)(T);break;case 99:_(v);var T={multiDiaRespInfo:v};i[u].content[g].msg=doT.template(y.cyclicSessionTMP99)(T);break;default:i[u].content[g].msg=v.remindQuestion}}for(var x=0;x<r.length;x++)"string"==typeof i[u].content[g].msg&&i[u].content[g].msg.indexOf(r[x])>=0&&(l=!0);if("string"==typeof i[u].content[g].msg&&i[u].content[g].msg.indexOf(c[0])>=0){var k=$("<div></div>").text(i[u].content[g].msg);i[u].content[g].msg=k.html()}"object"!=typeof i[u].content[g].msg&&(i[u].content[g].msg=l?i[u].content[g].msg:I.getNewUrlRegex(i[u].content[g].msg)),i[u].content[g].recallMsg=a.L10040.replace("{0}",i[u].content[g].senderName)}t+=doT.template(e)({data:i[u].content,orderStatusNameList:d})}t=w.analysis(t),o.find("li:first").before(t);var C=f.offset().top;n.scrollTop(C-n.offset().top-100),$("#cutoff").css("display","none")}),S++):(S++,e=L[S],N(e)),A=!0,$pulldownLoading.css("display","none"),$pulldownText.css("display","block")}})}else $pulldownText.html(s.T0004)},R=function(e){var e=e.data;p.trigger("listMsg.artificial",e),d.attr("src",e.aface),u.html(e.aname),u.attr("title",e.aname),C=1},O=function(){$(this).hasClass("removeVoice")?(l.css("background-position","-581px 0px"),$(this).removeClass("removeVoice"),p.trigger("listMsg.openVoice",!0)):(l.css("background-position","-501px 0px"),$(this).addClass("removeVoice"),p.trigger("listMsg.openVoice",!1))},B=function(){2===t.apiConfig.pageCloseFlag&&(p.trigger("core.sessionclose",999),i({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){e.status}}))},z=function(){if(t.urlParams.satDegree_A){var e={from:"close",resultFlag:!0,sourceType:1};p.trigger("listMsg.toEvaluate",e)}else window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window",status:"close"}}),"*"),B()):(window.close(),window.location.href="about:blank")},E=function(e){var i=0,t=($(window).height(),$(window).width(),$(".js-mainBox").width(),$(".js-mainBox").height());e&&(i=e.noticeMsgHeight||0);var a=t-x-F-i;n.css("height",a+"px")},H=function(e){"human"===e?C=1:"robot"===e&&(C=0)},q=function(n){t=n[0],i=e("../../../common/util/monitAjax.js")(t),a=t.language.lan,s=t.language.text,document.title=t.apiConfig.companyName,W()},W=function(){T(t),w=g(window,t),E(),j(t,window),d.attr("src",t.apiConfig.robotLogo),u.html(t.apiConfig.robotName),c.html(t.apiConfig.companyName),u.attr("title",t.apiConfig.robotName),c.attr("title",t.apiConfig.companyName)},U=function(){n=$(".js-chatPanel"),o=$(".js-chatPanelList"),r=$(".js-historyTrigger"),$pulldownLoading=$(".js-pulldown-loading"),l=$(".js-zhichiVoice"),c=$(".js-infoBarCompany"),$pulldownText=$(".js-pulldown-text"),d=$(".js-infoBarLogo"),u=$(".js-titleName"),$closeForm=$(".js-closeForm")},G=function(){p.on("core.onload",q),r.on("click",D),p.on("core.transfersuccess",R),l.on("click",O),$closeForm.on("click",z),$(window).resize(function(){E()}),p.on("listMsg.noticeInit",E),$(document.body).on("click",".openEdit",function(){$(this).hasClass("active")?($(this).closest(".leftMsg").find(".editContent").scrollTop(0),$(this).closest(".leftMsg").find(".editContent").removeClass("active"),$(this).removeClass("active"),$(this).find(".texts").text("查看全部")):($(this).closest(".leftMsg").find(".editContent").addClass("active"),$(this).addClass("active"),$(this).find(".texts").text("收起全部"))})},V=function(){U(),G(),p.on("core.statechange",H)};V()};i.exports=a},{"../../../common/comm.js":1,"../../../common/mode/offlineMessageFilter.js":18,"../../../common/util/listener.js":32,"../../../common/util/load.js":33,"../../../common/util/monitAjax.js":34,"../config/config.json":37,"../util/datetime.js":58,"../util/qqFace.js":69,"./msgHandler.js":41,"./template.js":45,"./theme.js":46}],41:[function(e,i,t){var a=function(i,t){var a,i,s,n,o,r,l,c,d,u,f,p,m,g,v=e("../../../common/util/listener.js"),h=e("../../../common/comm.js"),y=e("../util/qqFace.js"),T=(e("../../../common/util/promise.js"),!0),j=e("../../../common/util/errorlog.js"),b=e("../../../common/util/monitAjax.js")(i),I=0,w=e("./template.js"),x=e("../util/datetime.js"),F=e("./noticeMessage.js"),k=e("./pushEvaHandler.js"),C=e("../util/showTip.js"),L=e("../../../common/util/msgReminder.js"),S=e("../sendArea/leaveMessage.js"),M="",P={},A=0,D=!0,_=0,N=!0,R="",O=0,B=!1,z="",E=[],H={},q=0,W=!1,U="",G=!1,V=!1,Z=!0,J="",Q=[],K=[],X=i.language.lan,Y=i.language.text,ee=i.apiConfig.userOutFlag,ie=i.apiConfig.adminOutFlag,te=i.urlParams.adminTipWord,ae=60*i.apiConfig.adminTipTime,se=i.apiConfig.accountStatus,ne=!1,oe=!1,re=function(e){"human"==e&&(A=1)},le=function(e){if(!e.originalEvent.data){var i=JSON.parse(e.originalEvent.data);"offlineMessage"==i.name?(0==$(".cutoff").length&&v.trigger("core.onreceive",{type:"human",list:[{type:-110}]}),i.data.type=202,i.data.msg=i.data.content,v.trigger("core.onreceive",{type:"human",list:[i.data]})):"collapse"==i.name?(a=i.name,I=0,$(".cutoff").length>0&&$(".cutoff").remove(),v.trigger("core.onreceive",{type:"human",list:[{type:-110}]})):"expand"==i.name&&(a=i.name,Ye(),0==I?($(".cutoff").remove(),$(".js-unread").hide()):$(".js-unread").show().text(I+Y.T0058))}},ce=function(e){e.remindQuestion&&(e.remindQuestion=e.remindQuestion.split("\n")),e.answerStrip&&(e.answerStrip=e.answerStrip.split("\n"))},de=function(e){var i=new Date,t=i.getHours()>=10?i.getHours():"0"+i.getHours(),a=i.getMinutes()>=10?i.getMinutes():"0"+i.getMinutes(),s=Y.T0011+t+":"+a,n=d.children().last().prev();if(d&&d.children().length&&n.hasClass("sysData")&&n.find(".msgData").html(s),1===e){var o=doT.template(w.msgDate)(s);d.append(o)}},ue=function(e){if("humanOnly"!=e.moduleType||"blacklist"!=e.status){if("system"===e.type){var a=(+new Date,""),s="";if("queue"==e.status)return $(".js-queueing").remove(),s=doT.template(w.systemMsg)(e.data),s=Qe(s),M=$(s),d.append(M),7==e.data.status&&setTimeout(function(){i.urlParams.isLeaveCustomSysFlag?t.open(i.urlParams.leaveCustomUrl,"_self"):v.trigger("listMsg.openleaveMsgPage")},5e3),Ye(),fe(),pe(e.data.id),$(".js-moduleSwitch").remove(),d.find(".js-fengefu1").remove(),W=!0,void(R&&$("#"+R).remove());if("kickout"==e.status)return;e.data.id="systemMsg"+ +new Date,2===e.data.status&&(R&&$("#"+R).remove(),R=e.data.id),3==e.data.status?(a=doT.template(w.systemMsg2)(e.data),a=Qe(a)):(a=doT.template(w.systemMsg)(e.data),a=Qe(a));var n=$(a);d.append(n),"evaluate"==e.status&&setTimeout(function(){pe(e.data.id)},5e3),"leaveMsgComplete"==e.status&&setTimeout(function(){pe(e.data.id)},3e4),"transfer"==e.status&&de(1),Ye()}else if("human"==e.type){var e=e.data;f.attr("src",e.aface),u.html(e.aname),u.attr("title",e.aname),v.trigger("listMsg.artificial",e);var a=doT.template(w.transferSayHello)(e);a=Qe(a),i.apiConfig.adminHelloWordFlag&&d.append(a),d.find(".js-SwitchAdminsMsg").remove()}else if("overTimeTips"==e.type)if(1==e.data.sysType){var o=[{type:206,content:e.data.content}];Pe(o,0,function(){}),Ye()}else if(2==e.data.sysType){var o=[{type:206,content:e.data.content}];Pe(o,0,function(){}),Ye()}Ye()}},fe=function(){var e=40;$(".js-queueing").css("width",$(".js-chatPanelBody").width()-e+"px")},pe=function(e){$("#"+e).remove()},me=function(e){i.urlParams.templateId=e,b({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:{uid:i.apiInit.uid,url:"basic-set/getCusMsgTemplateConfig/4",method:"get",param:JSON.stringify({templateId:e})}}).success(function(e){i.urlParams.msgTxt=e.item.msgTxt,i.urlParams.msgTmp=e.item.msgTmp,i.urlParams.emailFlag=e.item.emailFlag,i.urlParams.emailShowFlag=e.item.emailShowFlag,i.urlParams.enclosureFlag=e.item.enclosureFlag,i.urlParams.enclosureShowFlag=e.item.enclosureShowFlag,i.urlParams.telFlag=e.item.telFlag,i.urlParams.telShowFlag=e.item.telShowFlag,i.urlParams.ticketShowFlag=e.item.ticketShowFlag,i.urlParams.ticketTypeFlag=e.item.ticketTypeFlag,i.urlParams.ticketTypeId=e.item.ticketTypeId,i.urlParams.ticketTitleShowFlag=e.item.ticketTitleShowFlag,S(i,1)})},ge=function(e){if(e&&e.length)for(var a=0;a<e.length;a++){var s=e[a].date||"",n="";if(s&&"welcome-sugguestions"!==e[a].answerType){var o=e[a].content[0].ts,r=0;try{r=e[1].content[0].t}catch(l){}s=x.formatTime(o,Y),n+=doT.template(w.msgDate)(s),d.append(n)}"welcome-sugguestions"===e[a].answerType&&(H=e[a],e[a].content[0].answer=e[a].content[0].msg,ye(e[a],!1));var c=e[a].content||[];ve(c,0,function(){$(".webchat_img_upload")&&$(".webchat_img_upload").parent().parent().parent().addClass("imgMagBox"),$(".js-msgFileIco")&&$(".js-msgFileIco").parent().parent().parent().addClass("fileMagBox")}),_>10&&$(".js-unread").css("display","block").html(_+Y.T0058)}if(0==$(".js-chatPanelList").find(".js-noticeMsg").length){var u=doT.template(w.noticeHtml)({languageText:Y,style:i.apiConfig.announceTopFlag});i.apiConfig.announceTopFlag?(p.append(u),i.apiConfig.announceClickUrl&&i.apiConfig.announceClickFlag&&(p.find(".js-noticeMsg").attr("href",i.apiConfig.announceClickUrl),p.find(".js-noticeMsg").addClass("openLink"))):setTimeout(function(){$(".js-chatPanelList  > li:first-child").before(u)},10),!i.apiConfig.announceMsgFlag||i.apiInit.multiFlag&&!i.apiConfig.announceTopFlag||setTimeout(function(){F(i,t)},50)}if(d.append(z),$(".js-changeGroup").click(function(){q++,q>=E.length&&(q=0);var e={list:E[q],isHistory:!1},i=doT.template(w.sugguestionsListMsg)(e);$(".sugguestions-change").html(i)}),i.multiGuideData){var f=doT.template(w.multiGuideHtml)({languageText:Y,robotData:i.apiConfig,multiGuideData:i.multiGuideData});d.append(f)}if(d.append(M),"1"==i.existFlag&&i.apiConfig.ticketShowFlag){var m='<div style="width: 190px;height: 28px;background:rgba(240,244,245,1);border-radius:4px;text-align: center;margin: 0px auto"><p class="sysData js-jumpLeaveMsg" style="color:#8C989B;margin-top:0;text-align: center;line-height: 28px;">'+Y.T0129+"，"+Y.T0152+'<span class="js-jump" style="color:#4D9DFE;cursor: pointer ">'+Y.T0153+"</span></p></div>";d.append(m),$(".js-jump").on("click",function(){b({type:"post",url:"/chat-web/user/getWsTemplate.action",dataType:"json",data:{uid:i.apiInit.uid,source:0,channelFlag:i.urlParams.channelFlag||""},success:function(e){var i=e||[];if(i.length>1){var t=doT.template(w.groupTemplate)({list:i});layer=$(t),$(".js-mainBox").append(layer),layer.delegate(".js-item","click",function(){layer.remove();var e=$(this).data("id");me(e)}),layer.find(".js-group-outer").animate({right:"0"}),layer.delegate(".js-cancel-btn,.js-group-layer","click",function(){layer.find(".js-group-outer").animate({right:"-390px"},function(){layer.remove()})})}else me(i[0].templateId)}}),$(this).parent().parent().remove()})}de(),Ye()},ve=function(e,t,a){try{if(t>=e.length)return void(a&&a(t));var s=e[t],n=function(){ve(e,t+1,a)};switch(s.senderType){case-1:var o={content:Y.T0059},r=doT.template(w.cutoffMsg)(o);d.append(r),n();break;case 0:var l="";9==s.msgType||10==s.msgType?(s.msg=JSON.parse(s.msg),l=he(s.msg,s.senderType)):"string"==typeof s.msg&&(l=Be(s.msg));var c={msg:l,t:s.t,dateuid:s.msgId,senderType:s.senderType,from:"initHistory"},r=doT.template(w.rightMsg)(c);d.append(r),n();break;case 1:try{9==s.msgType||10==s.msgType?(s.msg=JSON.parse(s.msg),s.msg=he(s.msg,s.senderType)):"string"==typeof s.msg&&(s.msg=Be(s.msg));var c={msg:s.msg,aname:s.senderName,t:s.t,languageText:Y,revokeFlag:s.revokeFlag,from:"initHistory"},r=doT.template(w.leftMsg)(c);r=Qe(r),d.append(r),n()}catch(u){}break;case 2:try{if(9==s.msgType||10==s.msgType)s.msg=JSON.parse(s.msg),s.msg=he(s.msg,s.senderType);else if(24==s.msgType)s.miniPage="string"==typeof s.miniPage?JSON.parse(s.miniPage):s.miniPage;else if(25==s.msgType){var f=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"];s.miniPage="string"==typeof s.miniPage?JSON.parse(s.miniPage):s.miniPage,s.miniPage.orderStatusNameList=f}else"string"==typeof s.msg&&(s.msg=Be(s.msg));var c={msg:s.msg,aname:s.senderName,t:s.t,languageText:Y,revokeFlag:s.revokeFlag,from:"initHistory",ticketMsgFlag:s.ticketMsgFlag,msgType:s.msgType,miniPage:s.miniPage},r=doT.template(w.leftMsg)(c);r=Qe(r),1==i.apiConfig.adminHelloWordCountRule&&1==i.apiInit.ustatus&&(oe=!0),c.msgType>=0?d.append(r):oe||d.append(r),"offline"===s.msgType_2&&_++,n()}catch(u){}break;case 3:n();break;default:n()}}catch(u){j.runtimeError(u,"initmessage",s,i)}},he=function(e,i){
var t=e;if(1==i||2==i)if("000000"==t.retCode)if("string"==typeof t.inputContentList){var a=t.inputContentList.split(",");ce(t);var s={multiDiaRespInfo:t,contentAry:a,msgId:e.msgId};e.msg=doT.template(w.inputContentTMP)(s)}else if("object"==typeof t.inputContentList){for(var a=[],n=[],o=0;o<t.inputContentList.length;o++)for(var r in t.inputContentList[o])n.push(r),a.push(t.inputContentList[o][r]);ce(t);var s={multiDiaRespInfo:t,titleAry:n,contentAry:a,msgId:e.msgId};e.msg=doT.template(w.inputContentTMP_1511)(s)}else if(t.interfaceRetList)switch(t.template){case 0:ce(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(w.cyclicSessionTMP0)(s);break;case 1:ce(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(w.cyclicSessionTMP1)(s);break;case 2:ce(t);var s={multiDiaRespInfo:t,clickFlag:!0};e.msg=doT.template(w.cyclicSessionTMP2)(s);break;case 3:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP3)(s);break;case 4:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP4)(s);break;case 99:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP99)(s);break;default:e.msg=t.remindQuestion}else e.msg=t.remindQuestion||t.answer;else if("000002"==t.retCode)e.msg=t.retErrorMsg;else{var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionError)(s)}else switch(t.template){case 0:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP0)(s);break;case 1:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP1)(s);break;case 2:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP2)(s);break;case 3:ce(t);var s={multiDiaRespInfo:t};e.msg=doT.template(w.cyclicSessionTMP3)(s);break;default:e.msg=t.remindQuestion}return e.msg},ye=function(e,t){if("robot"==e.type||t===!0){if(g&&g.play&&N)try{g.play()}catch(a){}if(t===!0)var s=e,n=e.answerType;else{if(e.list)var s=e.list[0],n=e.list[0].answerType;if(e.content)var s=e.content[0],n=e.content[0].answerType}if(contentInner=Ie(s),contentInner&&0!=contentInner){var o={aname:i.apiConfig.robotName,msg:contentInner,languageText:Y,showArtificial:B,showEvaluate:showEvaluate,wurl:U,wurlOpenStyle:V,robotFlag:s.robotFlag,docId:s.docId,question:s.question,msgId:s.msgId},r=doT.template(w.leftMsg)(o),c=$(r);if(1==i.urlParams.realuateFlag&&s.docId&&c.find(".msgDiv").css("display","block"),n&&c.find(".msgText").find("a").attr("target","_blank"),"welcome-sugguestions"===e.answerType)return void(z=c);d.append(c),$(".sugguestions").find("a").attr("target","_self")}$(".sugguestions").find("a").attr("target","_self"),ie&&clearInterval(l)}else"human"==e.type?(Pe(e.list,0,function(){}),L.flash(Y.T0158)):j.specialError("ignore message","msgHandler",{data:e,searchFlag:t},i);setTimeout(function(){Ye()},100)},Te=function(e){var i={switchType:"transferType",queueFlag:e.queueFlag,transferType:e.transferType};v.trigger("listMsg.transTypeArtificial",i)},je=function(e){if(1==e.transferFlag||3==e.transferFlag){var t={switchType:1==e.transferFlag?"keySwitch":"defaultKey",groupId:e.groupId,transferFlag:e.transferFlag,keyword:e.keyword,keywordId:e.keywordId,queueFlag:e.queueFlag};v.trigger("listMsg.keyWordArtificial",t)}else if(2==e.transferFlag&&!i.urlParams.groupId){var t={aname:i.apiConfig.robotName,list:e.groupList,tipsMessage:e.tipsMessage,transferFlag:e.transferFlag,keyword:encodeURIComponent(e.keyword),keywordId:e.keywordId},a=doT.template(w.keySwitchAdmins)(t),s=$(a);d.append(s)}},be=function(){var e=$(this).attr("data-id"),i=$(this).attr("keyword"),t=$(this).attr("keywordId"),a={switchType:"keySwitch",groupId:e,keyword:decodeURIComponent(i),keywordId:t,switchTypeStyle:"click",queueFlag:2};v.trigger("listMsg.keyWordArtificial",a)},Ie=function(e){var t=e.answer,a=e.answerType,s=["1511","1522","1523","15239","1524"],n=!1;if((e.sugguestions||[]).length>0||3==e.senderType){for(var o=0;o<s.length;o++)s[o]==a&&(n=!0);n||(t=Se(e,!1))}else t=Be(t);if(0===e.ustatus)return!1;switch(B=!1,showEvaluate=!1,a){case"1":"1"!==i.urlParams.manualTypeObj.direct||W||1==i.apiConfig.type||(B=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"2":"1"!==i.urlParams.manualTypeObj.under||W||1==i.apiConfig.type||(B=!0);break;case"3":1===i.urlParams.chatConnectButton&&(O++,O==i.urlParams.manualBtnCount&&v.trigger("listMsg.showChatSwitch")),"1"!==i.urlParams.manualTypeObj.unknow||W||1==i.apiConfig.type||(B=!0);break;case"4":"1"!==i.urlParams.manualTypeObj.guide||W||1==i.apiConfig.type||(B=!0);break;case 5:break;case 6:break;case 7:break;case 8:break;case"9":"1"!==i.urlParams.manualTypeObj.direct||W||1==i.apiConfig.type||(B=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case 10:break;case"11":"1"!==i.urlParams.manualTypeObj.direct||W||1==i.apiConfig.type||(B=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"12":"1"!==i.urlParams.manualTypeObj.direct||W||1==i.apiConfig.type||(B=!0),1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"14":1==i.urlParams.realuateFlag&&(showEvaluate=!0);break;case"15":case"151":case"1521":case"1531":case"1532":case"1533":case"1534":case"1535":case"1536":case"1537":case"153":if("000000"==e.multiDiaRespInfo.retCode){K.push(e.multiDiaRespInfo);var r=e.multiDiaRespInfo;if(4==e.transferType&&(B=!0),Q[r.level]=r,J=r.conversationId,r.endFlag&&(J=""),r.inputContentList){var l=r.inputContentList.split(",");ce(r),l.length>9&&(l=l.slice(0,9));var c={multiDiaRespInfo:r,contentAry:l,msgId:e.msgId};t=doT.template(w.inputContentTMP)(c)}else if(r.interfaceRetList){if(0==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP0)(c)}else if(1==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP1)(c)}else if(2==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP2)(c)}else if(3==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP3)(c)}else if(4==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP4)(c)}else if(99==r.template){ce(r);var c={multiDiaRespInfo:r,msgId:e.msgId};t=doT.template(w.cyclicSessionTMP99)(c)}}else t=e.multiDiaRespInfo.remindQuestion;if(1==i.urlParams.realuateFlag)for(var d=["1521","1522","1523","15239","1524","153","1531","1532","1533","1534","1535","1536","1537"],o=0;o<d.length;o++)e.answerType==d[o]&&(showEvaluate=!0)}else if("000002"==e.multiDiaRespInfo.retCode){K.push(e.multiDiaRespInfo);var r=e.multiDiaRespInfo;Q[r.level]=r,J=r.conversationId,r.endFlag&&(J=""),t=e.multiDiaRespInfo.retErrorMsg}else{var r=e.multiDiaRespInfo;Q[r.level]=r,J=r.conversationId,r.endFlag&&(J=""),t=doT.template(w.cyclicSessionError)(e)}break;case"1511":var r=e.multiDiaRespInfo;K.push(e.multiDiaRespInfo),J=r.conversationId,Q[r.level]=r,4==e.transferType&&(B=!0),r.endFlag&&(J="");var l=[],u=[],f={};if("000000"==r.retCode){for(var o=0;o<r.inputContentList.length;o++)for(var p in r.inputContentList[o])u.push(p),l.push(r.inputContentList[o][p]);ce(r),f={multiDiaRespInfo:r,titleAry:u,contentAry:l,msgId:e.msgId}}else f={multiDiaRespInfo:r};t=doT.template(w.inputContentTMP_1511)(f);break;case"1522":case"1523":case"15239":case"1524":if(1==i.urlParams.realuateFlag)for(var d=["1521","1522","1523","15239","1524"],o=0;o<d.length;o++)e.answerType==d[o]&&(showEvaluate=!0);var r=e.multiDiaRespInfo;K.push(e.multiDiaRespInfo),4==e.transferType&&(B=!0),J=r.conversationId,Q[r.level]=r,e.multiDiaRespInfo.endFlag&&(J=""),t=we(e)}return t},we=function(e){var i=e.sugguestions||e.list,t="",a=e.multiDiaRespInfo;ce(a),t=e.answer||e.multiDiaRespInfo.answer||"";var s={list:i,answerStrip:e.multiDiaRespInfo.answerStrip||e.answerStrip||"",stripe:e.stripe||"",answer:t},n=doT.template(w.multiListSugguestionsMsg)(s);return n},xe=function(){var e=$(this).attr("conversationId"),i=parseInt($(this).attr("page")),t=91,a=$(this).parent().find(".js-interfaceRetList"+e),s=a.find("li").length,n=0;if(i<=Math.floor(s/3)-1)n=i*(3*t),i++;else{var o=t*(s%3);0==o?(n=0,i=1):(n=(i-1)*(3*t)+o,i=0)}$(this).attr("page",i),a.stop(!0).animate({"margin-top":-n},500)},Fe=function(){var e=parseInt($(this).attr("page")),i=$(this).parent().find(".js-tmp2List li"),t=i.length;if(t>3*e){e++,$(this).attr("page",e);for(var a=3*(e-1);a<3*e;a++){if(a>t-1)return $(this).find("span").html("收起全部"),void $(this).find("i").addClass("pull");a==t-1&&($(this).find("span").html("收起全部"),$(this).find("i").addClass("pull")),i.eq(a).removeClass("multiHide")}}else{$(this).find("span").html("展开更多"),$(this).find("i").removeClass("pull");for(var a=3;a<t;a++)i.eq(a).addClass("multiHide");$(this).attr("page",1)}},ke=function(){var e=parseInt($(this).attr("page")),i=$(this).parent().find(".js-tmp1List li"),t=i.length;if(t>9*e){e++,$(this).attr("page",e);for(var a=9*(e-1);a<9*e;a++){if(a>t-1)return $(this).find("span").html("收起全部"),void $(this).find("i").addClass("pull");i.eq(a).removeClass("multiHide")}}else{$(this).find("span").html("展开更多"),$(this).find("i").removeClass("pull");for(var a=9;a<t;a++)i.eq(a).addClass("multiHide");$(this).attr("page",1)}},Ce=function(){try{var e=$(this).attr("level"),t=$(this).attr("data-index"),a=($(this).attr("conversationId"),$(this).attr("clickFlag"));if(1!=a&&("UL"===$(this).parent()[0].nodeName?$(this).parent().css("pointerEvents","none"):$(this).parent().parent().css("pointerEvents","none"),$(this).parents(".msgDiv").addClass("noneClick")),!Q.length)return;var o=Q[e],r=o.interfaceRetList[t],l=o.outPutParamList,c=o.template,d={},u=[];o.conversationId;u.push(r),d={interfaceRetList:u,template:c},l=l.split("#");for(var f={},p=0;p<l.length;p++)f[l[p]]=r[l[p]];f.level=Q[o.level].level,f.conversationId=Q[o.level].conversationId;var m="";0==c?m=0==A?'<div class="tmp0InnerList">'+$(this).html()+"</div>":d.interfaceRetList[0].title:1==c?(m=$(this).html(),d=$(this).html()):2==c&&(m=0==A?'<div class="tmp2InnerList">'+$(this).html()+"</div>":d.interfaceRetList[0].title),v.trigger("sendArea.send",[{answer:m,requestText:f,multiDiaQuestion:d,uid:s,cid:n,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==A?"robot":"human"}])}catch(g){}},$e=function(){try{if(!Q.length)return;var e={},t=($(this).attr("data-index"),$(this).text()),a=$(this).attr("level"),o=Q[a].levelName;$(this).attr("conversationId");e.level=Q[a].level,e.conversationId=Q[a].conversationId,e[o]=t,v.trigger("sendArea.send",[{answer:t,requestText:e,multiDiaQuestion:t,uid:s,cid:n,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==A?"robot":"human"}])}catch(r){}},Le=function(){try{if(!Q.length)return;var e={},t=$(this).attr("title"),a=$(this).attr("content"),o=$(this).attr("level"),r=(Q[o].remindQuestion,$(this).attr("conversationId"),t+"："+a);e.level=Q[o].level,e.conversationId=Q[o].conversationId,e[t]=a,v.trigger("sendArea.send",[{answer:r,requestText:e,multiDiaQuestion:r,uid:s,cid:n,sysNum:i.sysnum,date:+new Date,questionFlag:2,source:0,robotFlag:i.urlParams.robotFlag||"",lanFlag:i.urlParams.lanFlag||0,currentStatus:0==A?"robot":"human"}])}catch(l){}},Se=function(e,t){if(e){if(e.list){if(i.apiConfig.guideGroupFlag&&i.apiConfig.guideGroupNum!==-1){for(var a=e.list,s=JSON.parse(JSON.stringify(a)),n=s.length,o=i.apiConfig.guideGroupNum,r=n%o===0?n/o:Math.floor(n/o+1),l=0;l<r;l++){var c=s.slice(l*o,l*o+o);E.push(c)}var d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:E[q],isHistory:t,stripe:e.stripe,answer:d,count:i.apiConfig.guideGroupFlag},f=doT.template(w.listSugguestionsMsgChange)(u);return f}var a=e.list,d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:a,isHistory:t,stripe:e.stripe,answer:d},f=doT.template(w.listSugguestionsMsgChange)(u);return f}if(e.sugguestions){var a=e.sugguestions,d="";e.answer&&(d="[object Object]"==Object.prototype.toString.call(e.answer)?e.answer.msg:e.answer);var u={list:a,isHistory:t,stripe:e.stripe,answer:d},f=doT.template(w.listSugguestionsMsg)(u);return f}}return X.L10032},Me=function(){},Pe=function(e,s,n){if(s>=e.length)return void(n&&n(s));var c=e[s],p=function(){Pe(e,s+1,n)};switch(c.type){case 200:c.serviceInfo.serviceOutDoc&&(te=c.serviceInfo.serviceOutDoc),c.serviceInfo.serviceOutTime&&c.serviceInfo.serviceOutDoc&&(ae=60*c.serviceInfo.serviceOutTime);case 201:if(i.urlParams.msgflag)var m=c.queueDoc;else var m=c.queueDoc+X.L10039;var h={id:c.msgId,content:m},y=doT.template(w.systemqueue)(h);$(".js-queueing").html(y),fe(),p();break;case 202:"collapse"==a&&I++;var j=Be(c.content);j.indexOf("验证码")==-1||0!=se&&1!=se||(G=!0);var h;if(24==c.msgType)h={msg:j,msgId:c.msgId,aname:c.aname,languageText:Y,language:X,revokeFlag:c.revokeFlag,dangerWarnFlag:G,msgType:c.msgType,miniPage:"string"==typeof c.miniPage?JSON.parse(c.miniPage):c.miniPage};else if(25==c.msgType){var b=["","待付款","待发货","运输中","派送中","已完成","待评价","已取消"];h={msg:j,msgId:c.msgId,aname:c.aname,languageText:Y,language:X,revokeFlag:c.revokeFlag,dangerWarnFlag:G,msgType:c.msgType,miniPage:"string"==typeof c.miniPage?JSON.parse(c.miniPage):c.miniPage},h.miniPage.orderStatusNameList=b}else h={msg:j,msgId:c.msgId,aname:c.aname,languageText:Y,language:X,revokeFlag:c.revokeFlag,dangerWarnFlag:G};var y=doT.template(w.leftMsg)(h),x=$(y);if(1==i.urlParams.realuateFlag&&c.docId&&x.find(".msgDiv").css("display","block"),d.append(x),G=!1,$("#js-inputIng").removeClass("inputIngActive"),ie&&clearInterval(l),overTimeTipFlag="user",ee&&2==i.apiInit.isLock&&He(),(document.hidden||!T)&&N&&g&&g.play)try{g.play()}catch(F){}p();break;case 204:var y="";t.parent!==t&&t.parent.postMessage(JSON.stringify({name:"closeSession",data:c,status:c.status}),"*"),D=!1,p();break;case 205:clearInterval(o),c.content=Y.T0119,$("#js-inputIng").html(c.content).addClass("inputIngActive"),o=setTimeout(function(){$("#js-inputIng").removeClass("inputIngActive")},5e3),p();break;case 206:var j=Be(c.content),h={msg:j,aname:u.html(),languageText:Y},y=doT.template(w.leftMsg)(h);d.append(y),$("#js-inputIng").removeClass("inputIngActive"),p();break;case 210:f.attr("src",c.face),u.html(c.name),u.attr("title",c.name),v.trigger("listMsg.artificial",c),c.serviceInfo.serviceOutDoc&&(te=c.serviceInfo.serviceOutDoc),c.serviceInfo.serviceOutTime&&c.serviceInfo.serviceOutDoc&&(ae=60*c.serviceInfo.serviceOutTime),p();break;case-110:var y=doT.template(w.cutoffMsg)({content:Y.T0059});d.append(y),p();break;case 209:k(i,t,c),p();break;case 211:var C=X.L10040.replace("{0}",c.adminName),h={tips:C},y=doT.template(w.recallMsg)(h);d.find('[data-msg-id="'+c.revokeMsgId+'"]').html(y),p();break;case 213:i.apiInit.isLock=c.lockType,1==i.apiInit.isLock?(clearInterval(l),clearInterval(r)):(ee&&"user"==overTimeTipFlag&&He(),ie&&"admin"==overTimeTipFlag&&qe()),p();break;default:p()}Ye()},Ae=function(e){var i=e.percentage;$("#"+e.token).find(".js-processSpan").css("width",i+"%")},De=function(e){var i="fileOther";switch(e.filetype){case"rar":i="fileRar";break;case"txt":i="fileTxt";break;case"doc":i="fileDoc";break;case"pdf":i="filePdf";break;case"ppt":i="filePpt";break;case"xls":i="fileXls";break;default:i="fileOther"}if(e.browserVersion&&"ie-"===e.browserVersion)var t={filename:e.filename+e.extension,filetype:e.filetype,filesize:e.filesize,t:e.date,dateuid:e.token,fileIcoClass:i,source:"uploadFile",languageText:Y};else var t={filename:e.filename+e.extension,filetype:e.filetype,filesize:e.filesize||"",t:e.date,dateuid:e.token,fileIcoClass:i,source:"uploadFile",languageText:Y};var a=doT.template(w.rightMsg)(t),s=$(a);d.append(s),e.browserVersion&&"ie-"===e.browserVersion?(s.find(".js-uploadFileProcess").remove(),s.find(".js-filecancel").remove(),s.find(".js-fileSize").remove(),s.find(".js-sizeAfter").html("上传中...")):s.delegate("#filecancel"+e.token,"click",function(){v.trigger("listMsg.closeUploadFile","cancel"),s.find(".js-uploadFileProcess").remove(),s.find(".js-filecancel").remove(),s.find(".js-filecanceled").css("display","block")}),Ye()},_e=function(e){if(e.browserVersion&&"ie-"===e.browserVersion)var i={msg:'<img  class="webchat_img_upload js-zhichiMsgReUpload" src="img/upImgLoad.png"/>',t:e.date,dateuid:e.token,source:"uploadImg"};else var i={msg:'<img  class="webchat_img_upload js-zhichiMsgReUpload" src="'+e.result+'"/>',t:e.date,dateuid:e.token,source:"uploadImg"};var t=doT.template(w.rightMsg)(i),a=$(t);d.append(a);var s=$("#"+e.token).find(".js-uploadImgLayer").height();$("#"+e.token).find(".js-cancelUploadImg").css("margin-top",(s-60)/2+"px"),a.delegate("#imgCancel"+e.token,"click",function(){v.trigger("listMsg.closeUploadImg"),$("#"+e.token).remove()}),Ye()},Ne=function(e){"ie-"===e.browserVersion?($("#"+e.dateuid).find(".js-sizeAfter").remove(),$("#"+e.dateuid).find(".js-filefail").css("display","block")):($("#"+e.dateuid).find(".js-uploadFileProcess").remove(),$("#"+e.dateuid).find(".js-filecancel").remove(),$("#"+e.dateuid).find(".js-filefail").css("display","block"))},Re=function(e){L.clear(),e=e[0];var t=Be(e.answer);e.dateuid||(e.dateuid=e.uid+ +new Date);var a=e.dateuid,s={msg:t,dateuid:a};if("image"===e.msgSendType)$("#"+a).find(".msgText").html(e.answer),$("#"+a).find(".js-uploadImgLayer").remove(),$("#msgStatus"+a).remove();else if("file"===e.msgSendType)$("#"+a).find(".js-filecancel").remove(),$("#"+a).find(".js-uploadFileProcess").remove(),$("#"+a).find(".js-filedownload").css("display","inline-block").attr("href",e.fileurl);else if("ie-image"===e.msgSendType)$("#"+a).find(".js-zhichiMsgReUpload").attr("src",e.fileurl),$("#"+a).find(".js-uploadImgLayer").remove();else if("ie-file"===e.msgSendType)$("#"+a).find(".js-sizeAfter").html("上传完成");else{var n=doT.template(w.rightMsg)(s);d.append(n),$("#msgStatus"+a).addClass("msgsending")}ee&&clearInterval(r),overTimeTipFlag="admin",ie&&2==i.apiInit.isLock&&qe(),e.image===!0?setTimeout(function(){Ye()},500):Ye()},Oe=function(e){var i={msg:e.answer,leaveMsgFlag:1},t=doT.template(w.rightMsg)(i);d.append(t),Ye()},Be=function(e){var i=["<a","<img","<frame","<audio","<video","<iframe","<IFRAME","<EMBED","<embed"],t=!1;if("string"==typeof e){var a=["<script"];if(e.indexOf(a[0])>=0){var s=$("<div></div>").text(e);e=s.html()}for(var n=0;n<i.length;n++)e.indexOf(i[n])>=0&&(t=!0);return e=t?e:h.getNewUrlRegex(e),e=P.analysis(e)}},ze=function(e){"success"===e.result?$("#msgStatus"+e.msgId).remove():"ImgSendFail"==e.result?$("#msgStatus"+e.msgId).addClass("msgsendError js-ImgSendFail"):$("#msgStatus"+e.msgId).addClass("msgsendError")},Ee=function(){L.clear();var e=$(this).attr("id"),t=$("#"+e).parent().find(".msgText").html();if($("#"+e).parent().parent().remove(),e=e.substr(9,e.length),$(this).hasClass("js-ImgSendFail")){var a=$(this).parent().find(".js-zhichiMsgReUpload").attr("src");return void v.trigger("sendArea.createUploadImg",{result:a,date:+new Date,token:e})}v.trigger("sendArea.send",[{answer:t,uid:s,cid:n,dateuid:e,currentStatus:0==A?"robot":"human",date:+new Date,token:e,sendAgain:!0}]),ee&&clearInterval(r),overTimeTipFlag="admin",ie&&2==i.apiInit.isLock&&qe()},He=function(){i.urlParams.userTipWord,60*i.apiConfig.userTipTime;clearInterval(r),r=setInterval(function(){},1e3)},qe=function(){if(1===A&&!ne){clearInterval(l),i.apiConfig.serviceOutCountRule&&(ne=!0),l=setInterval(function(){},1e3)}},We=function(){var e=$(this).attr("data-docid")||"",i=$(this).html();if(Z){Z=!1;var t=s+ +new Date;v.trigger("sendArea.send",[{requestText:e,answer:i,uid:s,cid:n,dateuid:t,requestType:"question",questionFlag:1,date:+new Date,currentStatus:0==A?"robot":"human"}]),$("#msgStatus"+t).removeClass("msgsending"),setTimeout(function(){Z=!0},1e3)}},Ue=function(){var e=($(this).attr("data-docid")||"",$(this).attr("data-num")),t=[{question:e,answer:e,sysNum:i.sysnum,uid:s,cid:n,currentStatus:0==A?"robot":"human",source:i.userInfo.source,lanFlag:i.urlParams.lanFlag||0,robotFlag:i.urlParams.robotFlag||"",questionFlag:0}];v.trigger("sendArea.send",t)},Ge=function(){},Ve=function(e){switch(e){case-3:u.attr("title","").html(i.apiConfig.robotName),W=!0;break;case-1:if(i.urlParams.msgflag)var t=i.urlParams.adminNonelineTitle;else var t=i.urlParams.adminNonelineTitle+i.apiConfig.leaveMsg;var a={type:"system",status:"offline",data:{content:t}};i.apiConfig.adminNoneLineFlag&&ue(a);break;case-2:u.attr("title","").html(X.L10026),f.attr("src","img/nolink.png"),1===i.apiConfig.sideBarStatus&&($(".js-barRobotName").html(X.L10026),$(".js-barHeadImg").attr("src","img/nolink.png")),W=!0;break;case-4:var a={type:"system",status:"offline",data:{content:i.urlParams.adminNonelineTitle}};i.apiConfig.adminNoneLineFlag&&ue(a);break;case 2:case 3:if(i.apiConfig.serviceEndPushFlag){var a={type:"system",status:"offline",data:{content:i.urlParams.serviceEndPushMsg.replace("#客服#",u.html())}};ue(a)}break;case 5:var a={type:"system",status:"offline",data:{content:"温馨提示：请提高警惕，谨防被骗！不要轻信转账、付款二维码等信息！"}};ue(a);break;case 6:var a={type:"system",status:"offline",data:{content:X.L10030}};ue(a);break;case 1:var s="";s="暂无客服在线"===u.html()?i.urlParams.serviceEndPushMsg.replace("#客服#","客服"):i.urlParams.serviceEndPushMsg.replace("#客服#","客服");var n={content:s};_html=doT.template(w.systemMsg)(n),i.apiConfig.serviceEndPushFlag&&d.append(_html);break;case 4:var o=Qe(i.apiConfig.userOutWord),n=[{type:206,content:o,aname:u.html()}];Pe(n,0,function(){});case 7:break;case 8:var a={type:"system",status:"offline",data:{content:X.L10031.replace("{0}",u.html())}};ue(a)}},Ze=function(e){U=e.wurl,V=e.wurlOpenStyle},Je=function(){$(".js-moduleSwitch").remove()},Qe=function(e){return e+="",e.replace(/target=\"_self\"/g,'target="_blank"')},Ke=function(e){"transfer"===e.status&&($(".js-queueing").remove(),clearInterval(r),$(".js-switchRobot").remove())},Xe=function(){var e=$(this),i=e.attr("docId"),t=e.attr("robotFlag"),a=e.attr("question"),o=e.attr("status"),r=e.attr("msgId");b({type:"post",url:"/chat/user/rbAnswerComment.action",dataType:"json",data:{uid:s,cid:n,docId:i,msgId:r,docName:a,status:o,robotFlag:t},success:function(i){if(i.ustatus!==-1&&i.ustatus!==-2){if(0===i.ustatus){var t=Y.T0072;return void C.show(t)}var t=Y.T0073;return void C.show(t)}if(1==o)var t=Y.T0070;else var t=Y.T0071;C.show(t),e.hide().siblings(".js-evaback").show(),1==o?(e.siblings(".js-okBack").addClass("yesBack"),e.siblings(".js-noBack").addClass("no2Back")):(e.siblings(".js-okBack").addClass("yes2Back"),e.siblings(".js-noBack").addClass("noBack")),e.siblings(".js-msgEvaluate").remove()}})},Ye=function(){try{var e=document.getElementById("chatPanel");e.scrollTop=e.scrollHeight}catch(i){return"滚动至底部失败"}},ei=function(){var e=(document.getElementById("chatPanel"),$(".cutoff")),i=$(".js-chatPanel"),t=e.parent(),a=e.offset().top-t.offset().top;i.animate({scrollTop:a-25},300)},ii=function(){$(".js-chatSwitch").hide(),$(".js-fengefu1").hide(),$(".js-manual-remove").remove();for(var e=$(".js-msgBottomArea").length,i=0;i<e;i++)if(!$($(".js-msgBottomArea")[i]).attr("showEvaluate")){$(".js-msgBottomArea").remove();break}},ti=function(e){e.data.serviceOutDoc&&(te=e.data.serviceOutDoc),e.data.serviceOutTime&&e.data.serviceOutDoc&&(ae=60*e.data.serviceOutTime),$(".js-switchRobot").remove()},ai=function(){P=y(t,i),C=C(i)},si=function(){var e=$(this).attr("data-src");$("body").append('<div class="videoLayer js-videoLayer"><span class="videoClose">×</span><div class="blackBG"><video class="bigVideo js-bigVideo" src="'+e+'" autoplay loop></video></div></div>'),$(".js-videoLayer").animate({opacity:"0.98"},800)},ni=function(e){$(".js-videoLayer").animate({opacity:"0"},300,function(){$(".js-videoLayer").remove()})},oi=function(){c=$(".js-chatPanel"),d=$(".js-chatPanelList"),$msgStatus=$(".js-msgStatus"),u=$(".js-titleName"),f=$(".js-infoBarLogo"),p=$(".js-header"),m=$(".js-queueing"),g=document.getElementById("newMsgAudio")},ri=function(){v.on("core.initsession",ge),v.on("core.onreceive",ye),v.on("core.keySwitchAdmin",je),v.on("core.transTypeSwitchAdmin",Te),v.on("sendArea.send",Re),v.on("sendArea.sendLeaveMsg",Oe),$(t).on("message",le),v.on("core.msgresult",ze),v.on("sendArea.msgresult",ze),v.on("core.statechange",re),v.on("core.sessionclose",Ve),v.on("core.system",ue),v.on("core.system_pc",Me),v.on("sendArea.sendAreaSystemMsg",ue),v.on("sendArea.robotOverTimeHandler",Ge),v.on("listMsg.openVoice",function(e){N=e}),v.on("listMsg.scrollToBottom",Ye),v.on("sendArea.wurlHandler",Ze),v.on("sendArea.revmoveChatSwitch",Je),v.on("sendArea.createUploadFile",De),v.on("sendArea.uploadFileProcess",Ae),v.on("sendArea.createUploadImg",_e),v.on("sendArea.uploadFileFail",Ne),v.on("sendArea.hideMsgBotBtn",ii),v.on("core.system",Ke),v.on("core.transfersuccess",ti),d.delegate("img","click",function(){var e=$(this).attr("src"),i=$(this).attr("noJump");e.indexOf("data:")>=0||i||t.open(e)}),$(document.body).delegate(".js-unread","click",function(){ei(),$(".js-unread").css("display","none")}),$(t).resize(function(){fe()}),d.delegate(".js-answerBtn","click",We),d.delegate(".js-multiAnswerBtn","click",Ue),d.delegate(".js-msgStatus","click",Ee),d.delegate(".js-msgEvaluate","click",Xe),d.delegate(".js-tmpInnerList","click",Ce),d.delegate(".js-inputContent","click",$e),d.delegate(".js-inputContent_1511","click",Le),d.delegate(".js-tranMultiGroup","click",xe),d.delegate(".js-tmp2MultiMore","click",Fe),d.delegate(".js-tmp1MultiMore","click",ke),d.delegate(".js-keySwitchAdmin","click",be),$("body").delegate(".js_webchat_video","click",si),$("body").delegate(".js-videoLayer","click",ni),$("body").delegate(".js-bigVideo","click",function(e){e.stopPropagation()}),t.onfocus=function(){T=!0},t.onblur=function(){T=!1},c.on("scroll",function(){var e=c.scrollTop(),i=$(".cutoff"),t=($(".js-chatPanel"),i.parent());if(!(i.length<=0)){var a=i.offset().top-t.offset().top;e<a&&$(".js-unread").css("display","none")}})},li=function(){s=i.apiInit.uid,n=i.apiInit.cid,oi(),ai(),ri()};li()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/errorlog.js":29,"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"../../../common/util/msgReminder.js":35,"../../../common/util/promise.js":36,"../sendArea/leaveMessage.js":54,"../util/datetime.js":58,"../util/qqFace.js":69,"../util/showTip.js":70,"./noticeMessage.js":42,"./pushEvaHandler.js":43,"./template.js":45}],42:[function(e,i,t){var a=function(i,t){var a,s,n,o,r=e("../../../common/util/listener.js"),l=(e("./template.js"),i.language.lan,i.language.text),c=i.apiConfig.announceTopFlag,d=function(){s.css("display","block"),n.append(i.apiConfig.announceMsg),n.find("a").attr("target","_blank"),n.height()>114&&(n.addClass("noticeInner-ellipsis-5"),o.css("display","block"),s.css("padding-bottom","30px"))},u=function(){var e=40,i=$(".js-chatPanelBody").width()-e;s.css("width",i+"px"),n.css("width",i+"px");var t=40;c&&($(".js-chatPanelBody").css("padding-top",t),n.css("overflow","hidden")),r.trigger("listMsg.noticeInit",{noticeMsgHeight:t})},f=function(){o.hasClass("openActive")?(o.removeClass("openActive").addClass("closeActive"),o.html(l.T0069),n.removeClass("noticeInner-ellipsis-5")):(o.addClass("openActive").removeClass("closeActive"),o.html(l.T0068),n.addClass("noticeInner-ellipsis-5"))},p=function(){},m=function(){$mainBox=$(".js-mainBox"),a=$mainBox.find(".js-header"),s=$mainBox.find(".js-noticeMsg"),n=$mainBox.find(".js-noticeInner"),o=$mainBox.find(".js-openNotice")},g=function(){c&&$(t).resize(function(){u()}),o.on("click",f),r.on("listMsg.noticeToTop",p),r.on("listMsg.sideBarAfterNotice",u)},v=function(){m(),g(),d(),c&&u()};v()};i.exports=a},{"../../../common/util/listener.js":32,"./template.js":45}],43:[function(e,i,t){var a=function(i,t,a){var s,n=e("../../../common/util/listener.js"),o=e("./template.js"),r=e("../util/showTip.js"),l=!0,c=0,d={},u=1,f=e("../../../common/util/monitAjax.js")(i),p=i.language.lan,m=i.language.text,g=i.userInfo.color?i.userInfo.color:i.apiConfig.color,v=function(){$aLi=s.find("#pushStar li");for(var e=0,i=1;i<=$aLi.length;i++)$aLi[i-1].index=i,$($aLi[i-1]).bind("click",function(){switch(e=this.index,h(e),e){case 1:case 2:case 3:case 4:c=e,T();break;case 5:c=5,j()}s.find(".js-commit").css({"background-color":g,color:"#fff"})})},h=function(e){for(var i=0;i<$aLi.length;i++)$aLi[i].className=i<e?"on":""},y=function(){s.find("#pushStar li").unbind()},T=function(){I()},j=function(){l&&(l=!1,1!=d[0].isQuestionFlag&&(u=-1),f({type:"post",url:"/chat/user/comment.action",dataType:"json",data:{cid:i.apiInit.cid,visitorId:i.apiInit.uid,score:5,tag:"",remark:"",commentType:0,type:1,solved:u},success:function(e){1===e.status?(y(),showTipObj.show(m.T0032),s.undelegate(),s.find(".js-moregood").html(m.T0025),1==u?(s.find(".js-unSolved").removeClass("unsolveActive"),s.find(".js-unSolved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").css({background:g,border:"1px solid "+g}),s.find(".js-solved").removeClass("defaultSolveActive").addClass("solveActive")):0==u&&(s.find(".js-solved").removeClass("solveActive"),s.find(".js-solved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").addClass("unsolveActive"),s.find(".js-unSolved").css({background:g,border:"1px solid "+g}))):showTipObj.show(m.T0033)},error:function(){showTipObj.show(m.T0033)}})),setTimeout(function(){l=!0},4e3)},b=function(){v()},I=function(){var e=0;e=s.find(".js-solved").hasClass("solveActive")?1:s.find(".js-unSolved").hasClass("unsolveActive")?2:0;var i={from:"push",score:c,resultFlag:!1,sourceType:0,commentType:0,solveActive:e};n.trigger("listMsg.toEvaluate",i)},w=function(e){$aLi=$("#pushStar li");var i=e.score,t=e.solved;1==t?(s.find(".js-unSolved").removeClass("unsolveActive"),s.find(".js-unSolved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").css({background:g,border:"1px solid "+g}),s.find(".js-solved").removeClass("defaultSolveActive").addClass("solveActive")):0==t&&(s.find(".js-solved").removeClass("solveActive"),s.find(".js-solved").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").addClass("unsolveActive"),s.find(".js-unSolved").css({background:g,border:"1px solid "+g})),h(i),s.undelegate(),s.find(".js-moregood").html(m.T0025)},x=function(){$mainBox=$(".js-mainBox"),$chatPanelList=$(".js-chatPanelList")},F=function(){s.delegate(".js-commit","click",j),n.on("listMsg.closePushEva",y),n.on("sendArea.toPushEav",w),n.on("sendArea.reTopushEav",b),s.delegate(".js-solved","click",function(){$(this).hasClass("solveActive")||($(this).addClass("solveActive"),$(this).css({background:g,border:"1px solid "+g}),s.find(".unsolveActive").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-unSolved").removeClass("unsolveActive")),u=1}),s.delegate(".js-unSolved","click",function(){$(this).hasClass("unsolveActive")||($(this).addClass("unsolveActive"),$(this).css({background:g,border:"1px solid "+g}),s.find(".solveActive").css({background:"#fff",border:"1px solid #d6dbe5"}),s.find(".js-solved").removeClass("solveActive")),u=0})},k=function(){f({type:"get",url:"/chat/user/satisfactionMessage.action",dataType:"json",data:{uid:i.apiInit.uid},success:function(e){if(1===e.status){d=e.data,showTipObj=r(i),$chatPanelList.find(".js-zhichipushEva")&&$chatPanelList.find(".js-zhichipushEva").remove();var t=a.aname.length>4?a.aname.substr(0,4)+"...":a.aname,l={config:d,language:p,languageText:m,subName:t,aname:a.aname},c=doT.template(o.pushEvaMsg)(l);s=$(c),$chatPanelList.append(s),v(),F(),n.trigger("listMsg.scrollToBottom")}},error:function(){r.show("请检查网络链接")}})},C=function(){x(),k()};C()};i.exports=a},{"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"../util/showTip.js":70,"./template.js":45}],44:[function(e,i,t){var a=function(i,t,a){var s,n,o,r,l,c,d,u,f,p,m,g,v,h,y,T,j,b,I=e("../../../common/util/listener.js"),w=(e("../../../common/util/load.js")(),e("./template.js")),x=(e("../../../common/comm.js"),e("../../../common/util/monitAjax.js")(t)),F=t.language.text,k=0,C=42,L=0,S=1,M=0,P=0,A=80,D=120,_=[],N=function(){
var e=doT.template(w.sideBarMenu)(_);f.append(e),A*M>k?(b=80,P=k-C,b-P%b>1&&(b=P/Math.floor(P/b)),L=Math.ceil(b*M/(P+1)),f.find("li").eq(0).css("border-left","1px solid #fff")):A*M<=k&&D*M>=k?(b=k/M,P=k,b-P%b>1&&(b=P/Math.floor(P/b)),g.css("display","none")):(b=120,P=k,b-P%b>5&&(b=P/Math.floor(P/b)),g.css("display","none")),n.css("width",k+"px"),u.css("width",P+1+"px"),f.css("width",b*M+"px"),f.find("li").css("width",b-1+"px");var e=doT.template(w.barMain)({list:_,languageText:F});v.append(e),$(".js-barInner:first").css("display","block"),$(".js-barAddress").html(h.html()),$(".js-barRobotName").html(y.html()),$(".js-barRobotName").attr("title",y.html()),$(".js-barHeadImg").attr("src",t.apiConfig.robotLogo),$(".js-customInner").find("a").attr("target","_blank"),$(".js-barInner2 img").on("click",function(){var e=$(this).attr("src");a.open(e)}),setTimeout(function(){I.trigger("listMsg.sideBarAfterNotice")},50),R()},R=function(){var e=r.width()-k-2;e<360&&(e=360);var i=$("#zcChat").outerHeight()-r.outerHeight()-f.outerHeight()-20;v.css({height:i}),s.css("min-width",k+360+2+"px"),o.css("width",e+"px");var t=f.find("li.barMenuActive").index(),a=l.find(".js-barInner").eq(t).find("iframe");a.css({height:i+Math.floor(10*Math.random()+1)}),setTimeout(function(){a.css({height:i})},3),d.css("width",e+"px"),$(".barInner2").css("height",c.height()+10+"px")},O=function(){S<L&&(S+=1),z(S)},B=function(){S>1&&(S-=1),z(S)},z=function(e){currentMarginLeft=-P*(e-1),f.stop(!0).animate({"margin-left":currentMarginLeft},500)},E=function(){setTimeout(function(){var e=f.css("marginLeft");"0px"===e?(p.addClass("noAbleLeftBtn").removeClass("hoverBtn"),m.removeClass("noAbleRightBtn").addClass("hoverBtn")):S===L?(m.addClass("noAbleRightBtn").removeClass("hoverBtn"),p.removeClass("noAbleLeftBtn").addClass("hoverBtn")):(p.removeClass("noAbleLeftBtn").addClass("hoverBtn"),m.removeClass("noAbleRightBtn").addClass("hoverBtn"))},600)},H=function(){$(this).addClass("barMenuActive").siblings().removeClass("barMenuActive"),$(".js-barInner").css("display","none");var e=$(this).attr("data-tab");$("#"+e).css("display","block"),R()},q=function(e){if(e.displayField||!e.serviceInfo||e.serviceInfo.displayField){if("object"!=typeof e.serviceInfo)return!1;e.displayField=e.displayField||e.serviceInfo.displayField,"string"==typeof e.displayField&&(e.displayField=e.displayField.split(",")||[]);var i=doT.template(w.cusCard)({data:e,languageText:F});$(".js-barCard").html(i),$(".js-barHeadImg").attr("src",e.aface||e.serviceInfo.face)}},W=function(){l=$(i),s=$(".js-mainBox"),n=$(".js-rightBar"),o=$(".js-chatPanelBody"),r=$(".js-header"),c=$(".js-chatPanel"),d=$(".js-footer"),u=$(".js-barMenuWidely"),f=$(".js-barMenu"),p=$(".js-prev"),m=$(".js-next"),g=$(".js-menuBtn"),v=$(".js-barMain"),h=$(".js-infoBarCompany"),y=$(".js-titleName"),T=$(".js-barRobotName"),j=$(".js-barAddress")},U=function(){$(a).on("resize",R),p.on("click",B),m.on("click",O),g.on("click",E),f.delegate("li","click",H),I.on("listMsg.artificial",q)},G=function(){x({type:"post",url:"/chat/user/querySideBar.action ",dataType:"json",data:{sysNum:t.sysnum,source:t.userInfo.source,uid:t.apiInit.uid||"",channelFlag:t.urlParams.channelFlag||""},success:function(e){if(1===t.apiConfig.sideBarStatus){k=t.apiConfig.sideBarWidth;for(var i=0;i<e.list.length;i++)1===e.list[i].menuStatus&&_.push(e.list[i]);M=_.length,W(),U(),N()}}})};G()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":32,"../../../common/util/load.js":33,"../../../common/util/monitAjax.js":34,"./template.js":45}],45:[function(e,i,t){var a={},s='<li id="{{=it.id||""}}" class="clearfix js-queueing"><div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div></li>',n='<li id="{{=it.id||""}}" class="clearfix js-serviceOff"><div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div></li>',o='<li id="" class="clearfix js-zhichipushEva zhichipushEva"><div class="systemMsg"><div class="systemMsgPushEva"><div class="pushEvaluate js-pushEvaluate"><p class="pushEvaTitle"><label class="aname" title="{{=it.aname}}">{{=it.subName}}</label>{{=it.languageText.T0093}}</p>{{if(it.config[0].isQuestionFlag){}}<div class="operateType"><p class="operateTypeTitle"><label class="aname" title="{{=it.aname}}">{{=it.subName}}</label>{{=it.languageText.T0106}}</p><div class="operateTypeBtn"><p class="solve solved js-solved defaultSolveActive"><span></span>{{=it.languageText.T0041}}</p><p class="solve unSolved js-unSolved" style="margin-left:25px;"><span></span>{{=it.languageText.T0042}}</p></div></div>{{}}}<div id="pushStar"><ul><li class="js-toSideEvaluate"><a href="javascript:;">1</a></li><li class="js-toSideEvaluate"><a href="javascript:;">2</a></li><li class="js-toSideEvaluate"><a href="javascript:;">3</a></li><li class="js-toSideEvaluate"><a href="javascript:;">4</a></li><li class="js-commit"><a href="javascript:;">5</a></li></ul></div><p class="moregood js-moregood">{{=it.languageText.T0107}}</p></div></div></div></li>',r='<div class="systemMsg"><div class="systemMsgText">{{=it.content}}</div></div>',l='<li class="clearfix magBox leftMsg"><p class="leftName">{{=it.list.senderName}}</p><div class="msgDiv"><div class="msgText">{{=it.list.msg}}</div></div></li>',c='<li class="clearfix magBox leftMsg"><p class="leftName">{{=it.aname}}</p><div class="msgDiv"><div class="msgText">{{=it.content}}</div></div></li>',d='{{if(it.aname){ }}{{if(it.revokeFlag){}}<li class="clearfix magBox leftMsg"><div class="systemMsg"><div class="systemMsgText">您有一条消息被撤回</div></div></li>{{}else{}}<li class="clearfix magBox leftMsg" data-msg-id="{{=it.msgId}}" creattime="{{=it.t||""}}"><p class="leftName">{{=it.aname||""}}</p>{{if(it.msgType==24){}}<div class="msgDiv"><div class="msgText"><a href="{{=it.miniPage.url}}" target="_blank"><div class="goods-wrap"><div class="goods-thum">{{if(it.miniPage.thumbnail){ }}<img src="{{=it.miniPage.thumbnail}}">{{}}}</div><div class="goods-detail"><p class="goods-title" title="{{=it.miniPage.title}}">{{=it.miniPage.title}}</p><p class="goods-abstract" title="{{=it.miniPage.description}}">{{=it.miniPage.description}}</p><p class="goods-label" title="{{=it.miniPage.label}}"><span class="rmb-icon"></span>{{=it.miniPage.label}}</p></div></div></a></div></div>{{}else if(it.msgType==25){ }}<div class="msgDiv"><div class="msgText"><a class="order-wrapA" href="{{=it.miniPage.orderUrl}}" target="_blank"><div class="order-wrap"><div class="order-desc fixed">{{if(it.miniPage.goods[0].pictureUrl){}}<div class="order-pic"><img src="{{=it.miniPage.goods[0].pictureUrl}}" alt=""></div>{{}}}{{if(it.miniPage.goods.length>0){}}<div class="order-text"><div class="order-name">{{=it.miniPage.goods[0].name}}{{if(it.miniPage.goods.length>1){}}等{{=it.miniPage.goods.length}}件商品{{}}}</div><div class="order-tip">{{if(it.miniPage.goodsCount){}}<span>{{=it.miniPage.goodsCount}}件商品，</span>{{}}}{{if(it.miniPage.totalFee){}}<span>合计￥{{=it.miniPage.totalFee/100}}</span>{{}}}</div></div>{{}}}</div><div class="order-info">{{if(it.miniPage.orderStatus){}}<div class="order-status">订单状态：<span style="color:#F6A623">{{=it.miniPage.orderStatusNameList[it.miniPage.orderStatus]}}</span></div>{{ } }}<div class="order-code">订单编号：{{=it.miniPage.orderCode}}</div>{{if(it.miniPage.createTime){}}<div class="order-time">下单时间：{{=it.miniPage.createTimeFormat}}</div>{{ } }}</div></div></a></div></div>{{}else if(it.ticketMsgFlag && it.msgType!=5){ }}<div class="editContent msgDiv {{if(it.from=="initHistory"){ }} noneClick {{ } }}"><div class="msgText">{{=it.msg||""}}</div>{{ }else{ }}<div class="msgDiv {{if(it.from=="initHistory"){ }} noneClick {{ } }}"><div class="msgText">{{=it.msg||""}}</div>{{ } }}{{if(it.showEvaluate||it.showArtificial){ }}<div class="msgBottomArea js-msgBottomArea" showEvaluate="{{=it.showEvaluate||""}}">{{if(it.showArtificial&&!it.wurl){ }}<span class="js-chatSwitch js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></span>{{ } }}{{if(it.showArtificial&&it.wurl){ }}{{if(it.wurlOpenStyle){ }}<a href="{{=it.wurl}}" target="_blank" class="js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></a>{{ }else{ }}<a href="{{=it.wurl}}" target="_parent" class="js-moduleSwitch msgChatSwitch"><i>{{=it.languageText.T0141}}</i></a>{{ } }}{{ } }}{{if(it.showEvaluate&&it.showArtificial){ }}<span class="js-fengefu1 fengefu">|</span>{{ } }}{{if(it.showEvaluate){ }}<span docId="{{=it.docId||""}}" robotFlag="{{=it.robotFlag||""}}" question="{{=it.question||""}}" msgId="{{=it.msgId||""}}" status="1" title="{{=it.languageText.T0142}}" class="js-msgEvaluate msgEvaluateOk msgChatEvaluate"><i>{{=it.languageText.T0142}}</i></span><span title="{{=it.languageText.T0142}}" class="js-evaback js-okBack hide msgChatEvaluate"><i>{{=it.languageText.T0142}}</i></span><span class="fengefu">|</span><span docId="{{=it.docId||""}}" robotFlag="{{=it.robotFlag||""}}" question="{{=it.question||""}}" msgId="{{=it.msgId||""}}" status="-1" title="{{=it.languageText.T0143}}" class="js-msgEvaluate msgEvaluateNo msgChatEvaluate"><i>{{=it.languageText.T0143}}</i></span><span title="{{=it.languageText.T0143}}" class="js-evaback js-noBack hide msgChatEvaluate"><i>{{=it.languageText.T0143}}</i></span>{{ } }}</div>{{ } }}</div>{{ if(it.ticketMsgFlag){ }}<div class="queryAll"><span class="openEdit"><span class="texts">查看全部</span><i></i></span></div>{{ } }}</li>{{if(it.dangerWarnFlag){}}<li class="clearfix magBox leftMsg"><div class="systemMsg"><div class="systemMsgText">{{=it.language.L10041||""}}</div></div></li>{{}}}{{ } }}{{ } }}',u='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer pc-leaveMessage-layer"><p class="group-title">请选择留言模板<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.templateId}}">{{=item.templateName}}</li>{{  } }}</ul></div></div></div>',f='{{if(it.source&&it.source==="uploadImg"){}}<li class="clearfix imgMagBox magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv"><div id="msgStatus{{=it.dateuid||""}}" class="msgStatus js-msgStatus msgsending"></div><div class="msgText">{{=it.msg||""}}</div><div class="uploadImgLayer js-uploadImgLayer"><p id="imgCancel{{=it.dateuid||""}}" class="cancelUploadImg js-cancelUploadImg">取消上传</p></div></div></li>{{ }else if(it.source&&it.source==="uploadFile"){ }}<li class="clearfix fileMagBox magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv"><div class="msgText"><div class="msgFileIco js-msgFileIco {{=it.fileIcoClass}}"></div><div class="msgFileDetail js-msgFileDetail"><p class="filename" title="{{=it.filename}}">{{=it.filename}}</p><span class="fileSize js-fileSize">{{=it.filesize}}</span> <span class="sizeAfter js-sizeAfter">|</span> <div class="uploadFileProcess js-uploadFileProcess"><span class="processSpan js-processSpan"></span></div><span id="filecancel{{=it.dateuid}}" class="filecancel js-filecancel">{{=it.languageText.T0000}}</span><span class="filecanceled js-filecanceled">{{=it.languageText.T0159}}</span><span class="filefail js-filefail">{{=it.languageText.T0084}}</span><a class="filedownload js-filedownload" target="_blank">{{=it.languageText.T0160}}</a></div></div></div></li>{{ }else{ }}<li class="clearfix magBox rightMsg" id="{{=it.dateuid||""}}" creattime="{{=it.t||""}}"><div class="msgDiv">{{if(it.from!=="initHistory"){}}<div id="msgStatus{{=it.dateuid||""}}" class="msgStatus js-msgStatus"></div>{{ } }}<div class="msgText">{{=it.msg||""}}</div></div>{{if(it.leaveMsgFlag==1){}}<span class="xinfeng"></span>{{}}}</li>{{ } }}',p='<li id="cutoff" class="cutoff"><span class="cutleft"></span>{{=it.content}}<span class="cutright"></span></li>',m='<li class="clearfix sysData"><p class="msgData">{{=it}}</p></li>',g='<li class="clearfix magBox leftMsg js-SwitchAdminsMsg"><p class="leftName">{{=it.aname||""}}</p><div class="msgDiv"><div class="msgText">{{=it.tipsMessage||"您的消息涉及到重点业务，需要人工客服帮您解决，您可以选择以下技能组："}}<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}<li style="color:#4298ba"><a href="#0" class="js-keySwitchAdmin keySwitchAdmin" data-id="{{=it.list[i].groupId}}" keyword="{{=it.keyword}}" keywordId="{{=it.keywordId}}">{{=it.list[i].groupName}}</a></li>{{ } }}</ul></div></div></div></div></li>',v='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div></div>',h='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;">{{=it.answer?it.answer:""}}</div><p>{{=it.stripe?it.stripe:""}}</p><ul class="sugguestions-change">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div>{{if(it.count){}}<div class="changeGroup js-changeGroup">换一组<i></i></div>{{}}}',y='{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}',T='<div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><p style="{{=it.stripe?"margin-bottom:10px":""}}">{{if(it.answerStrip){}}{{for(var i=0;i<it.answerStrip.length;i++){}}{{if(i==it.answerStrip.length-1){}}<p class="beginLan">{{=it.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.answerStrip[i]||""}}</p>{{}}}{{}}}{{}}}</p><div>{{=it.answer?it.answer:""}}</div><div>{{=it.stripe?it.stripe:""}}</div><ul class="sugguestions">{{for(var i=0,lan=it.list ||[] ;i<lan.length;i++){ }}{{if(it.isHistory){ }}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba">{{=it.list[i]}}</a></li>{{}else{}}<li style="color:#4298ba">{{=i+1}}. <a href="#0" data-num="{{=i+1}}" class="js-answerBtn" style="color:#4298ba" data-docid="{{=it.list[i]["docId"]}}">{{=it.list[i]["question"]}}</a></li>{{}}}{{ } }}</ul></div></div>',j='{{for(var i=0;i<it.length;i++){ }}{{if(i==0){ }}<li data-tab="{{=it[i].sidebarId}}" class="barMenuActive"><span title="{{=it[i].menuName}}">{{=it[i].menuName}}</span></li>{{}else{}}<li data-tab="{{=it[i].sidebarId}}"><span title="{{=it[i].menuName}}">{{=it[i].menuName}}</span></li>{{}}}{{}}}',b='{{var list = it.list;}}{{for(var i=0;i<list.length;i++){ }}{{if(list[i].menuType===0){ }}<div id="{{=list[i].sidebarId}}" class="barInner js-barInner js-barCard"><div class="barInfo"><img class="headimage js-barHeadImg"/><p class="headname js-barRobotName"></p></div><div class="barInformation js-barInformation"><dl><dt>{{=it.languageText.T0061}}</dt><dd class="js-barAddress"></dd></dl></div></div>{{}else if(list[i].menuType===1){}}<div id="{{=list[i].sidebarId}}" class="js-barInner js-barInner2 barInner barInner2 js-customInner"><p>{{=list[i].customContent||""}}</p></div>{{}else{}}<div id="{{=list[i].sidebarId}}" class="js-barInner barInner"><iframe name="barIfm" id="barIfm" src="{{=list[i].menuUrl||""}}" scrolling="yes" frameborder="0"></iframe></div>{{}}}{{}}}',I='{{var list = it.data;}}<div class="barInfo">{{if(list.displayField[0]==="1"){ }}<img class="headimage js-barHeadImg"/>{{}}}{{if(list.displayField[2]==="1"){ }}<p class="headname js-barCusName"">{{=list.serviceInfo.nickName||"-"}}</p>{{}}}</div><div class="barInformation">{{if(list.displayField[4]==="1"){ }}<div id="{{=list.displayField[4]}}" class="inforLi"><label>{{=it.languageText.T0063}}</label><span>{{=list.serviceInfo.serviceNo||"-"}}</span></div>{{}}}{{if(list.displayField[6]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0064}}</label><span>{{=list.serviceInfo.name||"-"}}</span></div>{{}}}{{if(list.displayField[8]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0067}}</label><span>{{=list.serviceInfo.phone||"-"}}</span></div>{{}}}{{if(list.displayField[1]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0066}}</label><span>{{=list.serviceInfo.tel||"-"}}</span></div>{{}}}{{if(list.displayField[3]==="1"){ }}<div class="inforLi"><label>{{=it.languageText.T0062}}</label><span>{{=list.serviceInfo.email||"-"}}</span></div>{{}}}{{if(list.displayField[5]==="1"){ }}<div class="inforLi"><label>Q Q：</label><span>{{=list.serviceInfo.qq||"-"}}</span></div>{{}}}{{if(list.displayField[7]==="1"){ }}<dl><dt>{{=it.languageText.T0065}}</dt><dd>{{=list.serviceInfo.remark||"-"}}</dd></dl>{{}}}</div>',w='<div class="js-closeWindow"><div class="closeLayer js-closeLayer"></div><div class="closeEvaluate js-closeEvaluate"><span class="closeEvaBtn js-closeEvaBtn"></span><p class="closeEvaTitle">{{=it.languageText.T0096}}</p><div id="closeStar"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div><div class="btnGroup"><span class="js-toSideEvaluate toSideEvaluate" style="display:none">{{=it.languageText.T0094}}</span><span class="js-commit commit" style="display:none">{{=it.languageText.T0095}}</span></div></div></div>',x='<div class="js-closeWindow"><div class="closeLayer js-closeLayer"></div><div class="closeEvaluate js-closeEvaluate"><span class="closeEvaBtn js-closeEvaBtn"></span><p class="closeEvaTitle">{{=it.languageText.T0098}}</p><div class="robotChose"><span class="js-isques js-robotResult evaluateok" resultFlag="true"><i></i>{{=it.languageText.T0041}}</span><span class="js-noques js-robotResult evaluateno" resultFlag="false"><i></i>{{=it.languageText.T0042}}</span></div><div class="btnGroup"><span class="js-toSideEvaluate toSideEvaluate" style="display:none">{{=it.languageText.T0094}}</span><span class="js-commit commit" style="display:none">{{=it.languageText.T0095}}</span></div></div></div>',F='<div class="js-evamsg evamsg"><p>{{=it.language.L10037}}</p></div>',k='<div class="js-evamsg evamsg" style="color:#cb1f16"><p>{{=it.language.L10038}}</p></div>',C='{{if(it.style){ }}<a class="noticeMsg js-noticeMsg" target="_blank"><span class="noticeVoice"></span><div class="noticeInner js-noticeInner"></div><span class="openUrl js-openUrl"></span> </a>{{}else{}}<li class="noticeMsg js-noticeMsg"><span class="noticeVoice"></span><div class="noticeInner js-noticeInner"></div><span class="openNotice js-openNotice openActive">{{=it.languageText.T0068}}</span> </li>{{}}}',$='<div class="sessionTmp0 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}" >{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}<p>{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}<p>{{=it.multiDiaRespInfo.answer||""}}</p>{{if(it.multiDiaRespInfo.interfaceRetList){}}<div class="interfaceRetListArea"><ul class="js-interfaceRetList{{=it.multiDiaRespInfo.conversationId||""}}" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}<li class="tmp0InnerList js-tmpInnerList" {{if(i==it.multiDiaRespInfo.interfaceRetList.length-1){}} style="border-bottom: 1px solid #d6dbe5"{{}}}conversationId="{{=it.multiDiaRespInfo.conversationId}}" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" level="{{=it.multiDiaRespInfo.level}}" data-index="{{=i}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}<a class="viewImg" href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"22%":"0"}};">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}">{{}else{}}<span style="display:inline-block"></span>{{}}}</a>{{}else{}}<div class="viewImg" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"22%":"0"}};">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}">{{}else{}}<span style="display:inline-block"></span>{{}}}</div>{{}}}<div class="innerRight" style="width:{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail?"72%":"92%"}};"><div class="rightTop">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}<a class="title" href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank">{{=it.multiDiaRespInfo.interfaceRetList[i].title||""}}</a>{{}else{}}<p class="title">{{=it.multiDiaRespInfo.interfaceRetList[i].title||""}}</a>{{}}}</div><div class="rightMid"><p class="mark1">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p></div><div class="rightBottom"><p class="mark2">{{=it.multiDiaRespInfo.interfaceRetList[i].label||""}}</p><p class="mark4">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div></div><div style="clear:both"></div></li>{{}}}</ul></div>{{if(it.multiDiaRespInfo.interfaceRetList.length>3){}}{{if(it.from!="history"){}}<div class="tranMultiGroup js-tranMultiGroup" conversationId="{{=it.multiDiaRespInfo.conversationId||""}}" page="1"><span>换一组</span><i></i></div>{{}}}{{}}}{{}else{}}{{if(it.multiDiaRespInfo.endFlag){}}<p>{{=it.multiDiaRespInfo.answerStrip}}</p>{{}else{}}{{if(it.multiDiaRespInfo.endFlag&&it.from!="history"){}}<p>{{=it.multiDiaRespInfo.remindQuestion}}</p>{{}}}{{}}}{{}}}<div style="clear:both"></div> </div>',L='<div class="sessionTmp1 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList js-tmp1List" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{if(it.multiDiaRespInfo.interfaceRetList){}}{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}{{if(i<9){}}<li class="innerEle" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}else{}}<li class="innerEle multiHide" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}}}<a href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</a></li>{{}else{}}{{if(i<9){}}<li class="innerEle js-tmpInnerList" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" data-index="{{=i}}" level="{{=it.multiDiaRespInfo.level}}" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}else{}}<li class="innerEle js-tmpInnerList multiHide" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" data-index="{{=i}}" level="{{=it.multiDiaRespInfo.level}}" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{}}}{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</li>{{}}}{{}}}{{}}} </ul>{{if(it.multiDiaRespInfo.interfaceRetList.length>9){}}{{if(it.from!="history"){}}<div class="multiMore js-tmp1MultiMore" page="1"><span>展开更多</span><i></i></div>{{}}}{{}}}<div style="clear:both"></div> </div>',S='<div class="sessionTmp2 js-tmp{{=it.multiDiaRespInfo.conversationId}}">{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(!it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.interfaceRetList){}}<ul class="js-tmp2List" style="pointer-events:{{=it.clickFlag?"none":"auto"}};">{{for(var i=0;i<it.multiDiaRespInfo.interfaceRetList.length;i++){}}{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[i].anchor){}}{{if(i>2){}}<li class="multiHide">{{}else{}}<li>{{}}}<a href="{{=it.multiDiaRespInfo.interfaceRetList[i].anchor}}" target="_blank"><div class="tmp2InnerList" {{if(i==0){}}style="border-top: 1px solid #d6dbe5"{{}}}>{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}"><div class="innerTop">{{}else{}}<div class="innerTop" style="width:97%">{{}}}<p class="title" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</p><p class="tag">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div><div class="innerBottom"><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p> </div><div style="clear:both"></div></div></a></li>{{}else{}}{{if(i>2){}}<li class="multiHide">{{}else{}}<li>{{}}}<div class="tmp2InnerList js-tmpInnerList" {{if(i==0){}}style="border-top: 1px solid #d6dbe5"{{}}} conversationId="{{=it.multiDiaRespInfo.conversationId}}" clickFlag="{{=it.multiDiaRespInfo.clickFlag}}" level="{{=it.multiDiaRespInfo.level}}"  data-index="{{=i}}">{{if(it.multiDiaRespInfo.interfaceRetList[i].thumbnail){}}<img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[i].thumbnail}}"><div class="innerTop">{{}else{}}<div class="innerTop" style="width:97%">{{}}}<p class="title" title="{{=it.multiDiaRespInfo.interfaceRetList[i].title}}">{{=it.multiDiaRespInfo.interfaceRetList[i].title}}</p><p class="tag">{{=it.multiDiaRespInfo.interfaceRetList[i].tag||""}}</p></div><div class="innerBottom"><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[i].summary||""}}</p> </div><div style="clear:both"></div></div></li>{{}}}{{}}}</ul>{{if(it.multiDiaRespInfo.interfaceRetList.length>3){}}{{if(it.from!="history"){}}<div class="multiMore js-tmp2MultiMore" page="1"><span>展开更多</span><i></i></div>{{}}}{{}}}{{}}} </div>',M='<div class="sessionTmp3 js-tmpInnerList2 js-tmp{{=it.multiDiaRespInfo.conversationId||""}}" level="{{=it.multiDiaRespInfo.level}}"><div class="viewParent"><img class="viewImg" noJump="true" src="{{=it.multiDiaRespInfo.interfaceRetList[0].thumbnail}}"><div class="inner"><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].title}}</p><p class="summary">{{=it.multiDiaRespInfo.interfaceRetList[0].summary}}</p>{{if(it.multiDiaRespInfo.endFlag&&it.multiDiaRespInfo.interfaceRetList[0].anchor){}}<a class="more" target="_blank" href="{{=it.multiDiaRespInfo.interfaceRetList[0].anchor}}">查看详情 ></a> </div>{{}else{}}<p class="more">查看详情 ></p>{{}}}<div style="clear:both"></div></div> </div>',P='<div class="sessionTmp4">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.answerStrip||it.multiDiaRespInfo.remindQuestion){}}<p style="height:10px;width:100%;"></p>{{}}}<div class="inner"><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].title}}</p> </div><div style="clear:both"></div> </div>',A='<div class="sessionTmp4">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}{{if(it.multiDiaRespInfo.answerStrip||it.multiDiaRespInfo.remindQuestion){}}<p style="height:10px;width:100%;"></p>{{}}}<div class="inner"><p class="title">{{=it.multiDiaRespInfo.interfaceRetList[0].tempStr}}</p> </div><div style="clear:both"></div> </div>',D='<div class="sessionTmp1">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList">{{for(var i=0;i<it.contentAry.length;i++){}}<li class="innerEle js-inputContent js-tmp{{=it.multiDiaRespInfo.conversationId}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.contentAry[i]}}" outPutParamList="{{=it.multiDiaRespInfo.outPutParamList}}" level="{{=it.multiDiaRespInfo.level}}">{{=it.contentAry[i]}}</li>{{}}} </ul><div style="clear:both"></div> </div>',_='{{if(it.multiDiaRespInfo.retCode=="000000"){}}<div class="sessionTmp1511">{{if(it.multiDiaRespInfo.answerStrip){}}{{for(var i=0;i<it.multiDiaRespInfo.answerStrip.length;i++){}}{{if(i==it.multiDiaRespInfo.answerStrip.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.answerStrip[i]||""}}</p>{{}}}{{}}}{{}else if(it.multiDiaRespInfo.remindQuestion){}}{{for(var i=0;i<it.multiDiaRespInfo.remindQuestion.length;i++){}}{{if(i==it.multiDiaRespInfo.remindQuestion.length-1){}}<p class="beginLan">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}else{}}<p class="">{{=it.multiDiaRespInfo.remindQuestion[i]||""}}</p>{{}}}{{}}}{{}}}<ul class="tmp1InnerList">{{for(var i=0;i<it.contentAry.length;i++){}}<li class="innerEle js-inputContent_1511 js-tmp{{=it.multiDiaRespInfo.conversationId}}" conversationId="{{=it.multiDiaRespInfo.conversationId}}" title="{{=it.titleAry[i]}}" content="{{=it.contentAry[i]}}" level="{{=it.multiDiaRespInfo.level}}">• {{=it.titleAry[i]}}：{{=it.contentAry[i]}}</li>{{}}} </ul><div style="clear:both"></div> </div>{{}else{}}<div class="sessionTmp1511"><p>{{=it.multiDiaRespInfo.retErrorMsg||""}}</p><div style="clear:both"></div> </div>{{}}}',N='<div class="cyclicSessionError"><span class="icn"></span><p class="errorP">{{=it.multiDiaRespInfo.retErrorMsg}}</p></div>',R='<div class="sessionTmp1"><p class="beginLan" style="margin-bottom:0px">{{=it.multiDiaRespInfo.answer||"说的什么玩意儿"}}</p><div style="clear:both"></div> </div>',O='<li class="clearfix magBox leftMsg" creattime=""><p class="leftName">{{=it.robotData.robotName}}</p><div class="msgDiv"><div class="msgText"><div class="msgwrap leftMsg"><div class="msgOuter js-msgOuter"><div style="margin-bottom:10px;"><p>{{=it.multiGuideData.guide}}</p></div><p></p><ul class="multiGuide">{{for(var i=0;i<it.multiGuideData.msg.length;i++){}}{{if(i<6){}}<li class="guideEle"><a href="#0" data-num="{{=it.multiGuideData.msg[i].question}}" class="js-multiAnswerBtn multiAnswerBtn" data-docid="{{=it.multiGuideData.msg[i].id}}">{{=it.multiGuideData.msg[i].title}}</a><i></i></li>{{}}}{{}}}</ul></div></div></div></div><div class="msgBottomArea"></div></li>',B='<div class="systemMsg"><div class="systemMsgText">{{=it.tips}}</div></div>';
a.systemMsg=s,a.systemqueue=r,a.sayHello=l,a.transferSayHello=c,a.leftMsg=d,a.rightMsg=f,a.cutoffMsg=p,a.msgDate=m,a.listSugguestionsMsg=v,a.multiListSugguestionsMsg=T,a.sideBarMenu=j,a.barMain=b,a.cusCard=I,a.closeFormHumanEvaluate=w,a.closeFormRobotEvaluate=x,a.evamsgHtml=F,a.evamsgHtml2=k,a.noticeHtml=C,a.pushEvaMsg=o,a.cyclicSessionTMP0=$,a.cyclicSessionTMP1=L,a.cyclicSessionTMP2=S,a.cyclicSessionTMP3=M,a.cyclicSessionTMP4=P,a.cyclicSessionTMP99=A,a.inputContentTMP=D,a.inputContentTMP_1511=_,a.cyclicSession_1522=R,a.cyclicSessionError=N,a.multiGuideHtml=O,a.recallMsg=B,a.keySwitchAdmins=g,a.systemMsg2=n,a.groupTemplate=u,a.sugguestionsListMsg=y,a.listSugguestionsMsgChange=h,i.exports=a},{}],46:[function(e,i,t){var a=function(i){var t=(e("../../../common/util/listener.js"),""),a=function(){t=i.userInfo.color?i.userInfo.color:i.apiConfig.color,$header.css("background",t);var e=".rightMsg .msgDiv::before{border-color:transparent "+t+"}.rightMsg .msgDiv{background: "+t+"}";try{var a=document.getElementById("setStyle");a.appendChild(document.createTextNode(e))}catch(s){a.styleSheet.cssText=e}},s=function(){},n=function(){$header=$(".js-header"),$zhichiVoice=$(".js-zhichiVoice"),$infoBarLogo=$(".infoBarLogo"),$item=$(".js-item")},o=function(){a()},r=function(){n(),o(),s()};r()};i.exports=a},{"../../../common/util/listener.js":32}],47:[function(e,i,t){var a=function(){var i,t=e("../../../common/util/listener.js"),a=e("../../../common/comm.js"),s=e("../listMsg/sideBar.js"),n=a.getQueryParam(),o="",r="",l=function(){"iframe"===n.from?($(".js-mainBox").css({display:"block",height:"100%",width:"100%","max-height":"100%","max-width":"100%","min-height":"430px","min-width":"360px",top:"0px",bottom:"0px",left:"0px","margin-top":"0","margin-left":"0"}),n.hideMax&&$zhichiMax.css("display","none")):($(".js-mainBox").css({display:"block",height:"90%",width:"70%","max-height":"720px","max-width":"640px",top:"50%",left:"50%","margin-left":"-240px","margin-top":"-320px","min-height":"430px","min-width":"360px"}),$zhichiMin.css("display","none"),$zhichiMax.css("display","none"))},c=function(){l(),$(".js-evaluate").find(".block-text").html("")},d=function(){var e=$(window).height(),i=$(window).width(),t=$(".js-mainBox").width(),a=$(".js-mainBox").height();"iframe"!=n.from&&$(".js-mainBox").css({top:(e-a)/2,left:(i-t)/2,"margin-top":"0","margin-left":"0"})},u=function(){var e=window.location.href,i=[],t=[];for(var a in n)"uid"!==a&&"cid"!==a&&"from"!==a&&"unit"!==a&&(i.push(a),t.push(n[a]));e=e.substring(0,e.lastIndexOf("?")+1);for(var s=0;s<i.length;s++)e+=i[s]+"="+t[s]+"&";e=e.substring(0,e.length-1),$zhichiMax.attr("href",e)},f=function(){$zhichiMin=$(".js-zhichiMin"),$zhichiMax=$(".js-zhichiMax"),t.on("core.onload",function(e){i=e[0],o=i.language.lan,r=i.language.text,"iframe"!==n.from&&1===i.apiConfig.sideBarStatus&&(s($(".js-rightBar")[0],i,window),$(".js-mainBox").css({"max-width":i.apiConfig.sideBarWidth+640+"px"})),d()})},p=function(){$(window).resize(function(){d()}),u(),$zhichiMax.on("click",function(){window.parent!==window&&(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"))}),$zhichiMin.on("click",function(){window.parent!==window&&(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),window.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window",status:"collapse"}}),"*"))})},m=function(){f(),p(),c()};m()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":32,"../listMsg/sideBar.js":44}],48:[function(e,i,t){var a={orderClassify:"/ws/queryTicketTypeInfoList/4"},s={},n="orderClassify",o=function(i,t){var o=(e("../../../common/util/monitAjax.js")(t),e("../../../common/util/listener.js")),r=e("./template.js"),l=!1,c=i,d=!1,u=1,f="",p=function(e){e.stopPropagation(),o.trigger("sendArea.closeAlldropMenu"),l?(c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),$(this).find(".classIfyTitleIcn").css("background-position","-3279px 13px"),l=!1):(d||m(),c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),$(this).find(".classIfyTitleIcn").css("background-position","-3320px 13px"),l=!0)},m=function(){var e={},i=JSON.stringify(e),s={uid:t.apiInit.uid,url:a[n],method:"get",param:i};$.ajax({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:s}).success(function(e){var i={items:e.items};g(i.items),f=doT.template(r.classifyOrderList)(i),c.find(".js-classifyOrderMenu").html(f),d=!0})},g=function(e){if(e)for(var i=0;i<e.length;i++)e[i].items&&e[i].items.length>0&&(s[e[i].typeId]=e[i].items,g(s[e[i].typeId]))},v=function(){var e=$(this).attr("dataId")||"",i=$(this).attr("data-nodeFlag")||"",t=$(this).attr("title")||"",a=s[e];if("1"===i&&e&&a.length&&u<5){u++;var n={items:a},o=doT.template(r.classifyOrderList)(n);c.find(".js-classifyOrderMenu").html(o),c.find(".js-routerDeep").addClass("active"),c.find(".js-classRouter").append("<span class='routerDeep js-routerDeep' dataDeep='"+u+"' dataId='"+e+"' data-nodeFlag='"+i+"' title='"+t+"'><i style='color:#0DAEAF'>/ </i>"+t+"</span>"),h(u);try{var l=document.getElementById("classDropdownMenu");l.scrollTop=0}catch(d){return"滚动至底部失败"}}},h=function(e){for(var i=1;i<6;i++)c.find(".js-routerDeep").removeClass("routerNum"+i).addClass("routerNum"+e)},y=function(){var e=$(this).attr("dataId")||"",i=$(this).attr("dataDeep")||"",t=s[e];u=i;for(var a=$(this).parent().find(".js-routerDeep"),n=a.length,o=0;o<n-i;o++)$(a[n-o-1]).remove();if($(this).removeClass("active"),e){if(t.length){var l={items:t},d=doT.template(r.classifyOrderList)(l);c.find(".js-classifyOrderMenu").html(d)}}else c.find(".js-classifyOrderMenu").html(f);h(i)},T=function(e){e.stopPropagation();var i=$(this).attr("data-key")||"",t=$(this).attr("data-nodeFlag")||"";if("1"!==t){var a=$(this).parents(".js-questionClassify");a.find(".js-classDropdown-title").html($(this).html());var s=$(this).attr("dataId")||"",n=$(this).attr("dataName")||"",r={key:i,dataId:s,dataName:n};o.trigger("sendArea.definedFieldResult",r),c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),c.find(".classIfyTitleIcn").css("background-position","-3279px 13px"),l=!1}},j=function(){l=!1,c.find(".js-classDropdownAreaFixed").removeClass("openActive"),c.find(".js-classDropdown-btn").removeClass("checkActive"),c.find(".classIfyTitleIcn").css("background-position","-3279px 13px")},b=function(e){e.stopPropagation()},I=function(){},w=function(){c.delegate(".js-classDropdown-btn","click",p),c.delegate(".js-classDropdownLi","click",T),c.delegate(".js-classOrderList","click",v),c.delegate(".js-routerDeep","click",y),c.delegate(".js-classDropdownAreaFixed","click",b),c.delegate(".js-leaveMsgBody","click",j)},x=function(){},F=function(){x(),I(),w()};F()};i.exports=o},{"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"./template.js":56}],49:[function(e,i,t){function a(i,t,a,s){var n,o=e("./template.js"),r=e("../../../common/util/listener.js"),l=e("../../../common/util/msgReminder.js"),c=e("../util/showTip.js"),d=e("../../../common/util/monitAjax.js")(t),u=(t.language.lan,t.language.text),f=t.userInfo.color?t.userInfo.color:t.apiConfig.color,p=0,m="",g="",v=!1,h=!1,y=0===a.commentType?a.commentType:1,T=1,j="",b={};l.clear();var I=function(){var e=doT.template(o.AlertTemplate)(),i=t.apiConfig.robotName.length>8?t.apiConfig.robotName.substr(0,8)+"...":t.apiConfig.robotName,s=doT.template(o.sobotEvaluateOne_selfHtml)({evaluateTitle:u.T0021,okText:u.T0041,cancelText:u.T0042,robotName:t.apiConfig.robotName,subName:i});n=$(e),$(".js-mainBox").append(n),S(),n.find(".model-body").html(s),k(a.from),n.find(".js-submitTheme").css("background",f),D()},w=function(){$(this).addClass("noactive"),$(this).css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-isques").removeClass("okactive"),n.find(".js-isques").css({background:"#fff",border:"1px solid #ddd",color:"#8a9699"}),h=!0,p=0;var e=t.apiConfig.robotCommentTitle.split(","),i=doT.template(o.sobotEvaluateTwo_selfHtml)({list:e,languageText:u});n.find(".model-body-extend").html(i),D()},x=function(){var e=doT.template(o.AlertTemplate)();n=$(e),$(".js-mainBox").append(n),S();var i=$(".js-titleName").html(),t=i.length>4?i.substr(0,4)+"...":i,s=doT.template(o.humanOne_selfHtml)({config:b,languageText:u,aname:i,subName:t});if(n.find(".model-body").html(s),$aLi=$("#star li"),"push"==a.from){p=a.score;var r=a.solveActive;L(p),k(a.from),n.find(".js-evaluateTip").html(b[4].scoreExplain),F(p),0==r?n.find(".js-solved").addClass("solveActive").css({background:f,border:"1px solid "+f,color:"#fff"}):1==r?n.find(".js-solved").addClass("solveActive").css({background:f,border:"1px solid "+f,color:"#fff"}):2==r&&n.find(".js-unSolved").addClass("unsolveActive").css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-submitTheme").css("background",f)}else p=5,L(p),h=!0,k(a.from),n.find(".js-evaluateTip").html(b[4].scoreExplain),n.find(".js-solved").addClass("solveActive").css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-submitTheme").css("background",f);for(var l=0,c=1;c<=$aLi.length;c++)$aLi[c-1].index=c,$($aLi[c-1]).bind("click",function(){switch(l=this.index,L(l),h=!0,l){case 1:case 2:p=l,F(l),k(a.from),D(),n.find(".js-submitTheme").css("background",f);break;case 3:case 4:p=l,F(l),k(a.from),n.find(".js-submitTheme").css("background",f),D();break;case 5:p=5,n.find(".model-body-extend").html(""),n.find(".js-submitTheme").css("background",f),n.find(".js-evaluateTip").html(b[l-1].scoreExplain),"close"==a.from&&C(),D()}});D()},F=function(e){h=!0,conf=b[e-1];var i=[],t=conf.scoreExplain;conf.labelName&&(i=conf.labelName.split(","));for(var a=0;a<i.length;a++)""==i[a]&&i.splice(a,1);var s=doT.template(o.humanTwo_selfHtml)({list:i,conf:conf,languageText:u});n.find(".model-body-extend").html(s),n.find(".js-evaluateTip").html(t),D()},k=function(e){var i=doT.template(o.evaluateFooter_selfHtml)({from:e,languageText:u});n.find(".model-body-commit").html(i)},C=function(){if("push"==a.from&&(h=!0),0==v&&h){v=!0;var e=[],s=n.find(".js-tag").length;if(n.find(".js-tag").each(function(){var i=$(this).html();$(this).hasClass("active")&&e.push(i)}),i&&0==e.length&&b[p-1].isTagMust&&5!=p&&s>0)return c.show(u.T0104),void setTimeout(function(){v=!1},3e3);if(m=e.join(","),g=n.find(".js-evaluateInner").val()||"",/^\s+$/g.test(g)&&(g=""),i&&""==g&&b[p-1].isInputMust&&5!=p)return c.show(u.T0105),void setTimeout(function(){v=!1},3e3);T=1==i?1==b[0].isQuestionFlag?n.find(".js-solved").hasClass("solveActive")?1:0:-1:n.find(".js-isques").hasClass("okactive")?1:0,0==i&&(j=t.apiConfig.robotFlag||""),d({type:"post",url:"/chat/user/comment.action",dataType:"json",data:{cid:t.apiInit.cid,visitorId:t.apiInit.uid,score:p,solved:T,tag:m,robotFlag:j,remark:g,type:i,commentType:y},success:function(e){if(1===e.status){var i={score:p,solved:T};if(r.trigger("sendArea.toPushEav",i),M(),"push"==a.from)r.trigger("listMsg.closePushEva");else{var s={type:"system",status:"evaluate",data:{content:u.T0025}};r.trigger("sendArea.sendAreaSystemMsg",s)}c.show(u.T0032),a&&a.resultFlag&&(window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),2===t.apiConfig.pageCloseFlag&&d({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){r.trigger("core.sessionclose",999)}})):(window.close(),window.location.href="about:blank"))}else c.show(u.T0033)},error:function(){c.show(u.T0033)}}),setTimeout(function(){v=!1},3e3)}},L=function(e){for(var i=0;i<$aLi.length;i++)$aLi[i].className=i<e?"on":""},S=function(){n.find(".js-evaluatelayer").css("display","block"),n.find(".js-evaluateDialog").css("display","block")},M=function(){n.find(".js-evaluatelayer").css("display","none"),n.find(".js-evaluateDialog").css("display","none"),setTimeout(function(){$(".js-evaluateArea").remove()},500)},P=function(){Alert.show()},A=function(){n.find(".js-noques").on("click",w),n.find(".js-isques").on("click",function(){h=!0,p=5,n.find(".js-submitTheme").css("background",f),$(this).addClass("okactive"),$(this).css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-noques").removeClass("noactive"),n.find(".js-noques").css({background:"#fff",border:"1px solid #ddd",color:"#8a9699"}),n.find(".model-body-extend").html(""),D()})},D=function(){var e=$(".js-mainBox").width(),i=$(".js-mainBox").height(),t=n.find(".js-evaluateDialog").height();i>t?n.find(".js-evaluateDialog").css({left:(e-360)/2+"px",top:(i-t)/2+"px"}):(n.find(".js-evaluateDialog").css({left:(e-360)/2+"px",top:"0px","overflow-y":"scroll"}),n.find(".js-evaluateDialog").height(i+"px"))},_=function(){h=!0,n.find(".js-isques").addClass("okactive"),n.find(".js-isques").css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-noques").removeClass("noactive"),n.find(".js-noques").css({background:"#fff",border:"1px solid #ddd",color:"#8a9699"}),n.find(".model-body-extend").html(""),p=5},N=function(){},R=function(){n.undelegate(),n.delegate(".js-tag","click",function(){$(this).hasClass("active")?($(this).removeClass("active"),$(this).css({background:"#fff",color:"#8a9699",border:"1px solid #e0e9e8"})):($(this).addClass("active"),$(this).css({background:f,color:"#fff",border:"1px solid "+f}))}),n.delegate(".js-evaluateSubmit","click",C),n.delegate(".js-evaluateClose","click",function(){M(),r.trigger("sendArea.reTopushEav")}),n.delegate(".js-evaluatelayer","click",function(){M(),r.trigger("sendArea.reTopushEav"),setTimeout(function(){$(".js-evaluateArea").remove()},500)}),n.delegate(".js-solved","click",function(){$(this).hasClass("solveActive")||($(this).addClass("solveActive").css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-unSolved").removeClass("unsolveActive").css({background:"#fff",border:"1px solid #d6dbe5",color:"#8b98ad"}))}),n.delegate(".js-unSolved","click",function(){$(this).hasClass("unsolveActive")||($(this).addClass("unsolveActive").css({background:f,border:"1px solid "+f,color:"#fff"}),n.find(".js-solved").removeClass("solveActive").css({background:"#fff",border:"1px solid #d6dbe5",color:"#8b98ad"}))}),n.delegate(".js-noevaluateSubmit","click",function(){a&&a.resultFlag&&(M(),window.parent!==window?(window.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),2===t.apiConfig.pageCloseFlag&&d({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){r.trigger("core.sessionclose",999)}})):(window.close(),window.location.href="about:blank"))})},O=function(){$evaluate=$(".js-evaluate")},B=function(e){O(),0===i?(I(),A(),_()):(x(),N()),R(),c=c(t),"push"==a.from},z=function(){d({type:"get",url:"/chat/user/satisfactionMessage.action",dataType:"json",data:{uid:t.apiInit.uid},success:function(e){1===e.status&&(b=e.data,B())},error:function(){c.show("请检查网络链接"),setTimeout(function(){$(".js-evamsg").remove()},3e3)}})};z(),this.modeAlert=P}i.exports=a},{"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"../../../common/util/msgReminder.js":35,"../util/showTip.js":70,"./template.js":56}],50:[function(e,i,t){i.exports={".bmp":"image",".jpg":"image",".JPG":"image",".jpeg":"image",".JPEG":"image",".png":"image",".PNG":"image",".gif":"image",".GIF":"image",".txt":"txt",".TXT":"txt",".DOC":"doc",".doc":"doc",".docx":"doc",".DOCX":"doc",".pdf":"pdf",".PDF":"pdf",".ppt":"ppt",".PPT":"ppt",".PPTX":"ppt",".pptx":"ppt",".xls":"xls",".XLS":"xls",".xlsx":"xls",".XLSX":"xls",".RAR":"rar",".rar":"rar",".ZIP":"rar",".zip":"rar",".swj":"swj",".eml":"eml",".msb":"msb",".ssu":"ssu",".SSU":"SSU",".mp3":"player",".MP3":"player",".mp4":"player",".MP4":"player",".wma":"player",".WMA":"player",".WMV":"player",".wmv":"player",".rmvb":"player",".RMVB":"player"}},{}],51:[function(e,i,t){i.exports={txt:"//img.sobot.com/yun/attachment/fileTypeImages/icon_txt.gif",doc:"//img.sobot.com/yun/attachment/fileTypeImages/icon_doc.gif",pdf:"//img.sobot.com/yun/attachment/fileTypeImages/icon_pdf.gif",ppt:"//img.sobot.com/yun/attachment/fileTypeImages/icon_ppt.gif",xls:"//img.sobot.com/yun/attachment/fileTypeImages/icon_xls.gif",rar:"//img.sobot.com/yun/attachment/fileTypeImages/icon_rar.gif",player:"//img.sobot.com/yun/attachment/fileTypeImages/icon_mp3.gif"}},{}],52:[function(e,i,t){var a=function(i,t,a){var s,n,o,r,l,c,d,u,n,f,p,m,g,v,h,y,T,j,b,I,w,x,F,k,C,L,S,M,P,A,D,_,N,R,O,B=e("../../../common/util/listener.js"),z=e("../../../common/mode/currentState.js"),E=e("../util/qqFace.js"),H=e("./uploadImg.js"),q=e("./leaveMessage.js"),W=e("./evaluate.js"),U=e("./template.js"),G=e("../util/modal/dialog.js"),V=e("./switchRobot.js"),Z={},J=e("../../../common/comm.js"),Q=!1,K=!1,X=0,Y="",ee=function(){var e=T.val();if(0==e.length||/^\s+$/g.test(e))return T.val(""),!1;var i=c+ +new Date,t=$("<div></div>").text(e),a=t.html();clearTimeout(n),B.trigger("sendArea.send",[{answer:a,uid:c,cid:d,dateuid:i,date:+new Date,currentStatus:u}]),T.val(""),$inputPlaceholder.css("display","block"),ae(),clearTimeout(n),setTimeout(function(){se()},1e3)},ie=function(){var e="iframe"==l.urlParams.from,i=e?320:360,t=new G({title:"截图说明",footer:!1,width:i,source:"capture"});t.setInner(U.captureDialogTemplate),t.show(),e&&$(".capture-outer").css({width:i})},te=function(){clearInterval(n),n=setTimeout(function(){var e=T.val();s({type:"post",url:"/chat/user/input.action",dataType:"json",data:{cid:d,uid:c,content:e}})},200)},ae=function(){var e=T.val(),i=e.length,t=$("<div></div>").text($(".js-inputMsg").val());if(N.html(t.html()),setTimeout(function(){var e=N.height();e<160?$(".js-inputMsg").css({height:e}):$(".js-inputMsg").css({height:e,"overflow-y":"scroll"})},5),X&&te(),i>0?y.css("background",m):y.css("background","#e0e9e8"),l.apiConfig.support&&"robot"===u){if(0==e.length||/^\s+$/g.test(e))return se(),!1;clearInterval(o),o=setTimeout(function(){s({type:"post",url:"/chat-web/user/robotGuess.action",dataType:"json",data:{uid:c,question:e,robotFlag:l.urlParams.robotFlag||l.apiConfig.robotFlag||""},success:function(e){if(1==e.status){se();var i={respInfoList:e.respInfoList};if(e.respInfoList.length>0){respInfoListTemp=doT.template(U.respInfoList)(i),F.append(respInfoListTemp);var t=F.find(".js-respInfoList").height(),a=20;F.find(".js-respInfoList").css({top:-+(t+a)+"px"})}else se()}}})},500)}},se=function(){F.find(".js-respInfoList").remove()},ne=function(e){if(13==e.keyCode)return ee(),!1},oe=function(e){u=e,"human"===u?(X=1,M.show(),l.apiConfig.lan||S.show(),L.show(),w.show(),x.show(),se()):"robot"===u&&(X=0,M.hide(),S.hide(),L.hide(),w.show(),x.show())},re=function(e,i){0==K&&(K=!0,B.trigger("sendArea.artificial",i),setTimeout(function(){K=!1},2e3))},le=function(e){"transfer"!==e.status&&"hide"!==e.action||(T.unbind("paste"),T.on("paste",pe),X=1,T.css("display","block"),T.html()&&$inputPlaceholder.css("display","block"),N.html("").css("visibility","hidden"),$inputPlaceholder.html(l.apiConfig.customDoc))},ce=function(e){"transfer"!==e.status&&"hide"!==e.action||B.trigger("sendArea.hideMsgBotBtn"),"blacklist"===e.status&&B.trigger("sendArea.robotOverTimeHandler")},de=function(){Z.hide()},ue=function(){setTimeout(function(){K=!1,j.trigger("click")},10)},fe=function(e){var i=document.getElementById("js-inputMsg"),t=-1;if(i.selectionStart||0==i.selectionStart)t=i.selectionStart;else{var a=document.selection.createRange();a.moveStart("character",-i.value.length),t=a.text.length}var s=T.val().substring(0,t),n=T.val().substring(t),o=s+e+n;$(T).val(o);var r=(s+e).length;if(i.setSelectionRange)i.setSelectionRange(r,r),i.focus();else if(i.createTextRange){var a=i.createTextRange();a.collapse(!0),a.moveEnd("character",r),a.moveStart("character",r),a.select()}ae(),$inputPlaceholder.css("display","none")},pe=function(e){for(var i=e.originalEvent,t=0,a=i.clipboardData.items.length;t<a;t++){var s=i.clipboardData.items[t];"file"===s.kind&&(e.preventDefault(),uploadFile.onFormDataPasteHandler(s,c,d))}},me=function(){uploadFile.onChangeHandler(c,d)},ge=function(e){ve(e),B.trigger("sendArea.send",[{answer:f,uid:e.uid,cid:e.cid,dateuid:e.dateuid,date:+new Date,currentStatus:u,msgSendType:g,fileurl:e.url}]),T.focus()},ve=function(e){if(he(e)){g=e.browserVersion&&"ie-"===e.browserVersion?"ie-file":"file";var i="fileOther";switch(e.filetype){case"rar":i="fileRar";break;case"txt":i="fileTxt";break;case"doc":i="fileDoc";break;case"pdf":i="filePdf";break;case"ppt":i="filePpt";break;case"xls":i="fileXls";break;default:i="fileOther"}var t={url:e.url,dateuid:e.token,filesize:e.filesize,fileIcoClass:i,filename:e.filename+e.extension,languageText:p};f=doT.template(U.tranfiletype)(t)}},he=function(e){switch(e.filetype){case"image":g=e.browserVersion&&"ie-"===e.browserVersion?"ie-image":"image";var i={url:e.url};return f=doT.template(U.fileImage)(i),!1;default:return!0}},ye=function(e){0==Q&&(Q=!0,s({type:"post",url:"/chat/user/isComment.action",dataType:"json",data:{cid:l.apiInit.cid,uid:l.apiInit.uid,type:X},success:function(i){if(isEvaluated=i.isComment,1==isEvaluated){if("close"==e.from)return void(a.parent!==a?(a.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),a.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"),2===l.apiConfig.pageCloseFlag&&s({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:l.apiInit.uid},success:function(e){B.trigger("core.sessionclose",999)}})):(a.close(),a.location.href="about:blank"));var t={type:"system",status:"evaluate",data:{content:p.T0025}};B.trigger("sendArea.sendAreaSystemMsg",t)}else if(0==isEvaluated)W(X,l,e,Y);else{if("close"==e.from)return void(a.parent!==a?(a.parent.postMessage(JSON.stringify({name:"chat_collapseWindow",data:""}),"*"),a.parent.postMessage(JSON.stringify({name:"zc_post_message",data:{action:"chat_collapse_window"}}),"*"),2===l.apiConfig.pageCloseFlag&&s({type:"post",url:"/chat-web/user/out.action",dataType:"json",data:{uid:l.apiInit.uid},success:function(e){B.trigger("core.sessionclose",999)}})):(a.close(),a.location.href="about:blank"));var t={type:"system",status:"evaluate",data:{content:p.T0026}};B.trigger("sendArea.sendAreaSystemMsg",t)}}}),setTimeout(function(){Q=!1},1e3))},Te=function(e){switch(e){case-3:break;case-2:T.css("display","none"),$inputPlaceholder.css("display","none"),N.html(l.apiConfig.waitDoc).css("visibility","visible");break;case-4:case-1:case 1:case 2:case 3:case 5:case 4:case 6:case 7:case 8:case 999:case 888:F.remove(),e!=-1&&3!=e||(P.remove(),e==-1&&1!=l.urlParams.msgflag&&(l.urlParams.isLeaveCustomSysFlag?a.open(l.urlParams.leaveCustomUrl):xe())),B.trigger("sendArea.revmoveChatSwitch"),l.urlParams.msgflag&&$(".js-endleaveMessage").remove(),l.urlParams.satDegree_A||$(".js-endEvaluate").remove(),setTimeout(function(){je()},100),k.css("display","block")}},je=function(){var e=0;switch($(".js-endavgWidth").each(function(){"block"===$(this).css("display")&&(e+=1)}),e){case 1:_.css("width","100%");break;case 2:_.css("width","50%");break;case 3:_.css("width","33.333%")}},be=function(e){var i=e.originalEvent;if(!i.data){var t=JSON.parse(i.data);"human"!=z.getCurrentState()&&"auto"==i.data.type&&(l.urlParams.autoManual=!0,l.urlParams.aid=t.aid,re())}},Ie=function(){var e=$(this).attr("title"),i=c+ +new Date;B.trigger("sendArea.send",[{requestText:e,answer:e,uid:c,cid:d,dateuid:i,date:+new Date,currentStatus:u}]),se(),T.val(""),$inputPlaceholder.css("display","block"),ae()},we=function(){if("iframe"==l.urlParams.from){var e=a.location.href.replace(/#[\S]+$/,"").replace(/(&|\?)cid=[^&]+/,"").replace(/(&|\?)tnk=[^&]+/,"").replace(/(&|\?)autoManual=[^&]+/,"");a.location.href=e+"&tnk="+ +new Date}else{var e=a.location.href;e=e.replace(/(&|\?)autoManual=[^&]+/,"").replace(/#[\S]+$/,""),e=e.replace(/(&|\?)tnk=[^&]+/,""),e+="&tnk="+ +new Date,a.location.href=e}},xe=function(){s({type:"post",url:"/chat-web/user/getWsTemplate.action",dataType:"json",data:{uid:l.apiInit.uid,source:0,channelFlag:l.urlParams.channelFlag||""},success:function(e){var i=e||[];if(i.length>1){var t=doT.template(U.groupTemplate)({list:i});r=$(t),$(".js-mainBox").append(r),r.delegate(".js-item","click",function(){r.remove();var e=$(this).data("id");Fe(e)}),r.find(".js-group-outer").animate({right:"0"}),r.delegate(".js-cancel-btn,.js-group-layer","click",function(){r.find(".js-group-outer").animate({right:"-390px"},function(){r.remove()})})}else Fe(i[0].templateId)}})},Fe=function(e){l.urlParams.templateId=e,s({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:{uid:l.apiInit.uid,url:"basic-set/getCusMsgTemplateConfig/4",method:"get",param:JSON.stringify({templateId:e})}}).success(function(e){l.urlParams.msgTxt=e.item.msgTxt,l.urlParams.msgTmp=e.item.msgTmp,l.urlParams.emailFlag=e.item.emailFlag,l.urlParams.emailShowFlag=e.item.emailShowFlag,l.urlParams.enclosureFlag=e.item.enclosureFlag,l.urlParams.enclosureShowFlag=e.item.enclosureShowFlag,l.urlParams.telFlag=e.item.telFlag,l.urlParams.telShowFlag=e.item.telShowFlag,l.urlParams.ticketShowFlag=e.item.ticketShowFlag,l.urlParams.ticketTypeFlag=e.item.ticketTypeFlag,l.urlParams.ticketTypeId=e.item.ticketTypeId,l.urlParams.ticketTitleShowFlag=e.item.ticketTitleShowFlag,q(l)})},ke=function(){var e=$(this).val();""===e?$(this).next().css("display","block"):$(this).next().css("display","none"),e&&(_length=e.length)},Ce=function(e){var i=$(e).val();""===i?$(e).next().css("display","block"):$(e).next().css("display","none"),i&&(_length=i.length)},$e=function(){$inputMsg.val(""),$inputPlaceholder.html(l.apiConfig.customDoc),$inputPlaceholder.css("display","block")},Le=function(){V(l)},Se=function(i){l=i[0],s=e("../../../common/util/monitAjax.js")(l),p=l.language.text,m=l.userInfo.color?l.userInfo.color:l.apiConfig.color,j.css("color",m);var t=l.urlParams.wurl||"",n=l.urlParams.wurlOpenStyle;t&&1==l.urlParams.isCustomSysFlag&&(j.remove(),n?L.before('<a class="chatSwitch js-sendChatSwitch" target="_blank" style="color:'+m+'" href="'+t+'">'+p.T0060+"</a>"):L.before('<a class="chatSwitch js-sendChatSwitch" target="_parent" style="color:'+m+'" href="'+t+'">'+p.T0060+"</a>"),j=$(".js-sendChatSwitch"),B.trigger("sendArea.wurlHandler",{wurl:t,wurlOpenStyle:n})),l.urlParams.isLeaveCustomSysFlag?$(".js-mainBox").delegate(".js-leaveMessage","click",function(){a.open(l.urlParams.leaveCustomUrl)}):$(".js-mainBox").delegate(".js-leaveMessage","click",xe);var o=l.urlParams.chatConnectButton;"1"==o&&j.css("display","none"),$inputPlaceholder.html(l.apiConfig.robotDoc),M.attr("title",p.T0049),L.attr("title",p.T0050),x.attr("title",p.T0052),w.attr("title",p.T0051),R.text(p.T0057),Pe(),Me()},Me=function(){Z=E(a,l),uploadFile=H(i,t,a,l),!l.urlParams.autoManual||1!=l.apiConfig.type&&3!=l.apiConfig.type||setTimeout(re,100),0==l.urlParams.designButton&&$(".js-powBox").css("visibility","hidden"),l.urlParams.isMessageFlag||$(".js-sendLeaveMessage").remove(),2==l.apiConfig.msgToTicketFlag&&$(".js-sendLeaveMessage").remove(),l.apiConfig.isUploadFlag||$(".js-uploadFile").remove(),l.urlParams.isFeedBackFlag||$(".js-sendEvaluate").remove(),l.apiConfig.robotSwitchFlag&&$(".js-switchRobot").css("display","block")},Pe=function(){c=l.apiInit.uid,d=l.apiInit.cid},Ae=function(){v=$(document.body),h=$(i),y=h.find(".js-send-btn"),T=h.find(".js-inputMsg"),j=h.find(".js-chatSwitch"),b=h.find(".js-voiceCalls"),I=h.find(".js-upload"),S=h.find(".js-capture"),w=h.find(".js-leaveMessage"),x=h.find(".js-evaluate"),F=h.find(".js-footerOn"),k=h.find(".js-footerOff"),C=h.find(".js-newMessage"),L=h.find(".js-uploadFile"),M=h.find(".js-emotion"),P=h.find(".js-endEvaluate"),A=h.find(".js-endnewMessage"),D=h.find(".js-endleaveMessage"),_=h.find(".js-endavgWidth"),N=h.find(".js-textareaPre"),$inputPlaceholder=h.find(".js-inputPlaceholder"),R=h.find(".js-sobotTitle"),$inputMsg=h.find(".js-inputMsg"),O=h.find(".js-respInfoBtn"),$switchRobot=h.find(".js-switchRobot")},De=function(){B.on("core.onload",Se),B.on("core.buttonchange",ce),B.on("core.grouplist",ue),$(".js-capture").on("click",ie),B.on("core.system",le),y.on("click",ee),T.on("keydown",ne),J.detectEventSupport("input")?T.on("input",ae):setInterval(function(){ae()},200),$(".js-mainBox").delegate(".js-chatSwitch","click",re),T.on("focus",de),B.on("sendArea.gotoxy",fe),B.on("sendArea.uploadImgUrl",ge),I.on("change",me),x.on("click",ye),B.on("listMsg.toEvaluate",ye),B.on("listMsg.artificial",$e),C.on("click",we),F.delegate(".js-respInfoBtn","click",Ie),B.on("core.sessionclose",Te),B.on("listMsg.openleaveMsgPage",xe),$(a).on("message",be),B.on("core.transfersuccess",function(e){Y=e.data.aname,T.unbind("paste"),T.on("paste",pe),X=1}),B.on("listMsg.showChatSwitch",function(){j.css("display","block")}),J.detectEventSupport("input")?T.on("input",ke):setInterval(function(){Ce(T)},100),$inputPlaceholder.on("click",function(){T.focus()}),v.on("click",se),$switchRobot.on("click",Le)},_e=function(){Ae(),De(),B.on("core.statechange",oe)};_e()};i.exports=a},{"../../../common/comm.js":1,"../../../common/mode/currentState.js":11,"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"../util/modal/dialog.js":66,"../util/qqFace.js":69,"./evaluate.js":49,"./leaveMessage.js":54,"./switchRobot.js":55,"./template.js":56,"./uploadImg.js":57}],53:[function(e,i,t){var a=function(i,t){var a=(e("./template.js"),e("../../../common/util/monitAjax.js")(t),e("../../../common/util/listener.js")),s=!1,n="",o=function(e){e.stopPropagation(),n=$(this).attr("data-key"),s?(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),s=!1,i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px")):(i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),$(this).find(".dropListTitleIcn").css("background-position","-3320px 13px"),$(this).addClass("checkActive"),$(this).next().addClass("openActive"),i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px"),s=!0)},r=function(e){e.stopPropagation();var t=$(this).attr("data-nodeFlag")||"";if("1"!==t){var o=$(this).parent().parent();if(o.find(".js-dropdown-title").html($(this).html()),n){var r=$(this).attr("dataId")||"",l=$(this).attr("dataName")||"",c={key:n,dataId:r,dataName:l};a.trigger("sendArea.definedFieldResult",c)}else{var d=$(this).attr("data-fieldId")||"",u=$(this).attr("dataValue")||"",l=($(this).attr("fieldType")||"",$(this).attr("dataName")||"");if(u)var c={fieldId:d,dataValue:u,dataName:l,type:"definedList"};else{var f="00:00";f=o.parent().find(".js-definedHour").html()+":"+o.parent().find(".js-definedMinutes").html();var c={fieldId:d,dataValue:f,dataName:f,type:"time"}}a.trigger("sendArea.definedFieldResult",c)}i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),s=!1}},l=function(){s=!1,i.find(".js-dropdown-menu").removeClass("openActive"),i.find(".js-dropdown-btn").removeClass("checkActive"),i.find(".dropListTitleIcn").css("background-position","-3279px 13px"),i.find(".js-classDropdownAreaFixed").removeClass("openActive"),i.find(".js-classDropdown-btn").removeClass("checkActive"),i.find(".classIfyTitleIcn").css("background-position","-3279px 13px")},c=function(){},d=function(){},u=function(){
l()},f=function(){i.delegate(".js-dropdown-btn","click",o),i.delegate(".js-dropdownLi","click",r),$(document.body).on("click",function(){l()}),a.on("sendArea.closeAlldropMenu",u)},p=function(){},m=function(){p(),d(),f()};m(),this.expand=c,this.collapse=l};i.exports=a},{"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"./template.js":56}],54:[function(e,i,t){var a=function(i,t){var a,s,n,o,r,l,c,d,u,f,p,m,g,v,h,y,T,j,b,I,w=e("../util/load.js")(),x=e("../../../common/comm.js"),F=e("../../../common/util/listener.js"),k=e("../config/config.json"),C=e("../util/showTip.js"),L=e("./leaveDropdown.js"),S=e("./dropdownClassify.js"),M=e("../../../common/util/monitAjax.js")(i),P=e("./template.js"),A=!1,D=!1,_=!1,N=!1,R=!1,O=!1,B=!1,z=!0,E=60,H=60,q=[],W=!1,U=0,G=0,V=0,Z=0,s=i.apiInit.uid,J=(i.apiInit.cid,i.userInfo.color?i.userInfo.color:i.apiConfig.color),Q=i.language.lan,l=i.language.text,K=[],X={},Y="",ee=i.urlParams.leaveMsgGroupId||"",ie=navigator.userAgent.toLowerCase(),te={},ae=[],se={score:5},ne=function(){$leaveMsglayer.removeClass("show"),$(".js-drag-layer").css("display","block"),window.parent!==window&&window.parent.postMessage(JSON.stringify({name:"toggleDrag",toggleDrag:"true"}),"*"),$("#leaveMsg").animate({right:"-390px"},function(){a.remove()}),$sureWindow.removeClass("show"),$sureWindowlayer.removeClass("show"),$(".gt_holder").remove(),clearInterval(G),clearInterval(V),clearInterval(Z)},oe=function(){$(".js-drag-layer").css("display","none"),$(".js-drag-layer").remove(),window.parent!==window&&window.parent.postMessage(JSON.stringify({name:"toggleDrag",toggleDrag:"false"}),"*"),$(".js-leaveMsglayer").addClass("show"),$("#leaveMsg").animate({right:"0"}),t&&($(".leaveMsgShowtem").css("display","none"),$(".leaveMsgRecord").css("display","block"),$(".js-titleTwo").addClass("active").siblings().removeClass("active")),i.apiConfig.ticketShowFlag||$(".js-titleTwo").css("display","none")},re=function(){var e=d.val();return""===e?(_text=l.T0037,$leaveMsgDetailTip.html(_text).css("visibility","inherit"),A=!1,!1):($leaveMsgDetailTip.css("visibility","hidden"),A=!0,!0)},le=function(){var e=a.find(".js-leaveMsgDetail_msg").val();return""===e?(_text=l.T0146,$leaveMsgDetailTip.html(_text).css("visibility","inherit"),!1):($leaveMsgDetailTip.css("visibility","hidden"),!0)},ce=function(){var e=$(".js-email").val(),i=/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[-a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/;if(o){if(e&&i.test(e))return v.css("visibility","hidden"),D=!0,!0;var t=l.T0036;return""===e&&(t=l.T0035),v.html(t).css("visibility","inherit"),D=!1,!1}return e&&!i.test(e)?(v.html(t).css("visibility","inherit"),D=!1,!1):(v.css("visibility","hidden"),D=!0,!0)},de=function(){var e=/(^1\d{10}$)/,i=$(".js-telephone").val(),t=l.T0045;if(_=!1,n){if(!i||!e.test(i))return h.html(t).css("visibility","inherit"),_;h.css("visibility","hidden")}else{if(i&&!e.test(i))return h.html(t).css("visibility","inherit"),_;h.css("visibility","hidden")}return _=!0,!0},ue=function(){r?$(".js-leaveMsgFileStyle").length?N=!0:(N=!1,$enclosureTip.html(l.T0076).css("visibility","inherit")):N=!0},fe=function(e,i){var t=!1,a=!1,s=!1,n=!1;return i.forEach(function(e){7===e&&(s=!0,n=!1,a=!1,t=!1),8===e&&s===!1&&(n=!0,a=!1,t=!1),5===e&&s===!1&&n===!1&&(a=!0,t=!1),4===e&&s===!1&&n===!1&&a===!1&&(t=!0)}),s?/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e):n?/^1[1-9]\d{9}$/.test(e):a?/^[0-9]+$/.test(e):!t||/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/.test(e)},pe=function(e){for(var t=0,n=0;n<K.length;n++)if(X[K[n].id].fillFlag&&""==X[K[n].id].value)a.find(".js-errorTip"+X[K[n].id].id).css("visibility","inherit"),B=!1;else if(1==X[K[n].id].fieldType&&""!=X[K[n].id].value&&X[K[n].id].limitOptions&&X[K[n].id].limitOptions.length>0){var o=fe(X[K[n].id].value,X[K[n].id].limitOptions);o?(a.find(".js-errorTip"+X[K[n].id].id).css("visibility","hidden"),t++):(a.find(".js-errorTip"+X[K[n].id].id).css("visibility","inherit"),B=!1)}else K[n].value=X[K[n].id].value,a.find(".js-errorTip"+X[K[n].id].id).css("visibility","hidden"),t++;0!=K.length&&t!=K.length||(B=!0),2==i.urlParams.ticketTypeFlag&&(Y=i.urlParams.ticketTypeId),1==i.urlParams.ticketTypeFlag&&""===Y?(R=!1,a.find(".js-errorQuestionClass").css("visibility","inherit")):(R=!0,a.find(".js-errorQuestionClass").css("visibility","hidden"));var r=a.find(".js-ticketTitle").val();if(1==i.urlParams.ticketTitleShowFlag&&""==r?(O=!1,a.find(".js-ticketTitle-tip").css("visibility","inherit")):(O=!0,a.find(".js-ticketTitle-tip").css("visibility","hidden")),re()||(A=!1),ce()||(D=!1),de()||(_=!1),ue(),W)return void C.show(l.T0090);if(e&&1===e&&(U=0),U>0)return $commitSureWindow.animate({opacity:"1"}).addClass("show"),void $sureWindowlayer.animate({opacity:"1"}).addClass("show");if(A&&D&&_&&N&&B&&O&&R&&z){for(var f=d.val()||"",m=u.val()||"",g=p.val()||"",v=0,h=0,y=i.sysnum,T="",j=[],n=0;n<q.length;n++)""!==q[n]&&j.push(q[n]);if(f.length>5e3)return void C.show(Q.L10042);if(T=j.join(";"),b=JSON.stringify(K),i.urlParams.enclosureShowFlag&&i.urlParams.enclosureFlag&&!T)return void $enclosureTip.html(l.T0076).css("visibility","inherit");if(c)$(".gt_holder").addClass("gt_show").removeClass("gt_hide");else{z=!1;var I={uid:s,companyId:y,ticketContent:f,customerEmail:m,customerPhone:g,ticketFrom:v,customerSource:h,fileStr:T,customerNick:i.apiInit.uname,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ee:"",extendFields:b,ticketTypeId:Y,templateId:i.urlParams.templateId||1,ticketTitle:r};M({type:"post",url:"/chat/data/postMsg.action",dataType:"json",data:I,success:function(e){if(e&&"000000"==e.retCode){var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0056}};F.trigger("sendArea.sendAreaSystemMsg",i),d.val(""),u.val(""),p.val(""),ne(),C.show(l.T0032),setTimeout(function(){z=!0},5e3)}else C.show(Q.L10038)},error:function(){C.show(l.T0033)}})}}},me=function(){$(this).css({border:"1px solid #acbbbf"})},ge=function(){$(this).css({border:"1px solid #e0e9e8"})},ve=function(){""!==d.val()||""!==u.val()||""!==p.val()||$(".js-leaveMsgFileStyle").length?($sureWindow.addClass("show"),$sureWindow.animate({opacity:"1"}),$sureWindowlayer.addClass("show"),$sureWindowlayer.animate({opacity:"1"})):ne()},he=function(){var e=$(this).val();""===e?$(this).next().css("visibility","inherit"):$(this).next().css("visibility","hidden"),e&&(_length=e.length)},ye=function(e){var i=$(e).val();""===i?$(e).next().css("visibility","inherit"):$(e).next().css("visibility","hidden"),i&&(_length=i.length)},Te=function(){var e=0;e>200&&$(this).val($(this).val().substring(0,200))},je=function(){var e=$(".js-mainBox").height()-E-H;$(".leaveMsgBody").height(e)},be=function(){M({type:"post",url:"/chat/data/isMessage.action?t="+(new Date).getTime(),dataType:"json",data:{uid:s,msgFlag:"0"},success:function(e){c=+e.isMessage,c&&e.resStr&&(e.resStr=JSON.parse(e.resStr),initGeetest({gt:e.resStr.gt,challenge:e.resStr.challenge,offline:!e.resStr.success,product:"popup"},Ie))}})},Ie=function(e){e.onSuccess(function(){for(var t=e.getValidate(),n=d.val()||"",o=u.val()||"",r=p.val()||"",c=0,f=i.sysnum,m="",g=[],v=0;v<q.length;v++)""!==q[v]&&g.push(q[v]);return m=g.join(";"),n.length>5e3?void C.show(Q.L10042):void M({url:"/chat/data/postMsgAfterVerify.action",type:"post",dataType:"json",data:{uid:s,companyId:f,source:c,ticketFrom:c,customerSource:c,customerPhone:r,customerEmail:o,ticketContent:n,msgFlag:"0",fileStr:m,geetest_challenge:t.geetest_challenge,geetest_validate:t.geetest_validate,geetest_seccode:t.geetest_seccode,customerNick:i.apiInit.uname,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ee:"",extendFields:b,ticketTypeId:Y,templateId:i.urlParams.templateId||1,ticketTitle:a.find(".js-ticketTitle").val()},success:function(e){if(e&&"000000"==e.retCode){$(".gt_holder").remove();var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0056}};F.trigger("sendArea.sendAreaSystemMsg",i),ne(),C.show(l.T0032)}else C.show(Q.L10038)}})}),e.appendTo(".js-popup-captcha-pc"),we()},we=function(){var e=$(".js-mainBox").width(),i=$(".js-mainBox").height();$("#popup-captcha-pc").css({top:(i-250)/2+"px",left:(e-260)/2+"px"})},xe=function(){if($(".js-leaveMsgFileStyle").length>4)return C.show(l.T0077),void Se();if(window.FormData){var e=+new Date,i=$leaveMsgUploadBtn[0],t=$leaveMsgUploadBtn.val(),a=t.substr(t.lastIndexOf(".")),s=t.substring(t.lastIndexOf("\\")+1,t.lastIndexOf("."));if(Le(a,s)){var n=i.files[0],o=n.size;if(o<1024)o+="B";else if(o<1048576)o=(o/1024).toFixed(2)+"KB";else{if(o=(o/1048576).toFixed(2),o>20)return C.show(l.T0082),void Se();o+="M"}Fe(n,a,s,o,e)}}else Ce(),$sureWindowlayer.addClass("show"),$sureWindowlayer.removeClass("show")},Fe=function(e,i,t,s,n){var o={filename:t,extension:i,filesize:s,date:n,languageText:l},r=doT.template(P.leaveMsgFileStyle)(o);a.find(".js-enclosureTip").before(r),ke(e,i,t,n)},ke=function(e,t,s,n){var o=(i.apiConfig.uid+n,new XMLHttpRequest),r=new FormData;r.append("file",e),r.append("type","msg"),r.append("uid",i.apiInit.uid),r.append("pid",i.apiInit.pid),r.append("countTag",1),r.append("source",0),o.open("post","/chat/webchat/fileUploadForPostMsgBypc.action");var c=new FileReader;c.readAsDataURL(e),c.onload=function(e){o.send(r)},a.delegate(".js-leaveMsgFileClose"+n,"click",function(){o.abort(),W=!1;var e=$(this).attr("data-url");if(e){var i=q.join(";");i=i.replace(e,""),q=i.split(";")}$(this).parent().remove(),Se(),U--,a.find(".js-leaveMsgFileClose"+n).attr("data-url",e)}),o.onreadystatechange=function(e){if(4==e.target.readyState){if(200==e.target.status){var i=JSON.parse(e.target.response).url;q.push(i),$enclosureTip.css("visibility","hidden"),a.find(".js-leaveMsgFileClose"+n).attr("data-url",i)}else a.find(".js-leaveMsgFile"+n).find(".fileTip").html(l.T0075).addClass("fileTipShow"),U++;Se()}},o.upload.addEventListener("progress",function(e){if(e.lengthComputable){W=!0;var i=Math.round(100*e.loaded/e.total),t=i.toString();a.find(".js-leaveMsgProcess"+n).css("width",t+"%"),"100"==t&&(W=!1,a.find(".js-leaveMsgProcess"+n).parent().remove())}else a.find(".js-leaveMsgProcess"+n).parent().remove()},!1)},Ce=function(){var e=a.find(".js-leavemsgfileinfo");e.find('input[name="pid"]').val(i.apiInit.pid);var t=$leaveMsgUploadBtn.val(),s=t.substr(t.lastIndexOf(".")),n=t.substring(t.lastIndexOf("\\")+1,t.lastIndexOf(".")),o=+new Date;i.apiConfig.uid+o;if(Le(s,n)){var r=$e(s,n),l="iframe"+r;e.attr("target",l),e.attr("action","/chat/webchat/fileUploadForPostMsgBypc.action");var c=$('<iframe id="'+l+'" style="display:none;height:1000px;width:500px;" name="'+l+'" src="about:blank;"></iframe>');c.on("load",function(){var e=c[0],i=e.contentWindow.document.getElementsByTagName("body")[0].innerHTML;if(i){var t=JSON.parse(i);t.filesize===!1?(C.show("文件太大，上传失败"),a.find(".js-leaveMsgFile"+r).find(".ie-uploadLoading").remove(),a.find(".js-leaveMsgFile"+r).find(".fileTip").addClass("fileTipShow"),U++):(a.find(".js-leaveMsgFile"+r).find(".ie-uploadLoading").remove(),q.push(t.url)),a.find(".js-leaveMsgFileClose"+r).attr("data-url",t.url),a.delegate(".js-leaveMsgFileClose"+r,"click",function(){var e=$(this).attr("data-url");if(e){var i=q.join(";");i=i.replace(e,""),q=i.split(";")}$(this).parent().remove(),Se(),U--})}}),$(document.body).append(c),e.submit()}Se()},$e=function(e,i){var t=+new Date,s={filename:i,extension:e,date:t,languageText:l},n=doT.template(P.IframeleaveMsgFileStyle)(s);return a.find(".js-leaveMsgUpload").append(n),t},Le=function(e,i){var t="";return e=e.toLowerCase(),t=/^(.jpg|.jpeg|.png|.gif|.tiff|.bmp|.xls|.xlsx|.csv|.pdf|.doc|.docx|.odc|.txt|.wps|.et|.xps|.rtf|.ppt|.pptx|.otd|.rmvb|.rm|.flv|.mp4|.mid|.3gp|.mpg|.mov|.mkv|.mp3|.wma|.wav|.rar|.zip)$/,!!t.test(e)||(e&&C.show(l.T0078),Se(),!1)},Se=function(){a.find(".js-leaveMsgUploadBtn").val(""),a.find(".js-leavemsgfileinfo")[0].reset()},Me=function(){var e=$(this).attr("data-fieldId"),i=[],t=[];$(this).find(".js-userCheckIco"+e).hasClass("userCheckIcoActive")?($(this).addClass("userCheck"),$(this).find(".js-userCheckIco"+e).removeClass("userCheckIcoActive")):($(this).removeClass("userCheck"),$(this).find(".js-userCheckIco"+e).addClass("userCheckIcoActive")),$(".js-userCheckIco"+e).each(function(){$(this).hasClass("userCheckIcoActive")&&(i.push($(this).parent().attr("dataValue")),t.push($(this).parent().attr("dataName")))}),i=i.join(","),t=t.join(",");var a={fieldId:e,dataValue:i,dataName:t};X[a.fieldId].value=a.dataValue},Pe=function(){var e=$(this).attr("data-fieldId"),i=$(this).attr("dataValue"),t=$(this).attr("dataName");$(".js-userOptIco"+e).removeClass("userOptIcoActive"),$(".js-userOptIco"+e).parent().addClass("userOpt"),$(this).removeClass("userOpt").find(".js-userOptIco"+e).addClass("userOptIcoActive");var a={fieldId:e,dataValue:i,dataName:t};X[a.fieldId].value=a.dataValue},Ae=function(){var e=$(this).attr("data-fieldId"),i=$(this).val();X[e].value=i,a.find(".js-errorTip"+e).css("visibility","hidden")},De=function(e,i){X[i].value=e,a.find(".js-errorTip"+i).css("visibility","hidden")},_e=function(e){e.key?(Y=e.dataId,a.find(".js-errorQuestionClass").css("visibility","hidden")):("definedList"==e.type?X[e.fieldId].value=e.dataValue:"time"==e.type&&(X[e.fieldId].value=e.dataValue),a.find(".js-errorTip"+e.fieldId).css("visibility","hidden"))},Ne=function(){var e=doT.template(P.evaluationDialog)(te);$(".leaveMsglayer-wrapper").append(e),ae=te.ticketScoreInfooList},Re=function(){$(".evaluation-layer").remove()},Oe=function(){var e=$(this).index();$(".js-start-btn").each(function(i,t){i<=e?$(t).addClass("active"):$(t).removeClass("active")}),se.score=e+1,$(".js-change-evaluation").text(ae[e].scoreExplain)},Be=function(){$("#js-text-evaluation").length>0?se.remark=$("#js-text-evaluation").val():se.remark="",$.ajax({type:"POST",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:s,param:JSON.stringify(se),url:"ws/addTicketSatisfactionScoreInfo/4",method:"post"},success:function(e){if(e.retCode="000000"){$(".evaluation-layer").remove();var i=ae[se.score-1].scoreExplain+"("+se.score+"星)",t="";se.remark&&(t='<div><span style="color: #333">评价反馈：</span><span style="color: #888;word-break: break-all;text-align: justify">'+se.remark+"</span></div>");var a='<div style="margin-left: 23px;margin-bottom: 10px;"><div><span style="color: #333">评价星级：</span><span style="color: #888">'+i+"</span></div>"+t+"</div>";$(".js-evaluation-area").before(a),$(".js-evaluation-area").remove()}}})},ze=function(e){var t=i.urlParams.msgTxt,s=i.urlParams.msgTmp;w.load(k.basePath+"/views/sendArea/leaveMessage.html").then(function(c){var u=doT.template(c)({global:i,guide:t,leaveMsgDetail:s,languageText:l,definedField:e.items,ticketTitleShowFlag:i.urlParams.ticketTitleShowFlag});a=$(u),$(".js-mainBox").append(a);for(var p=0;p<e.items.length;p++){var g={};g.id=e.items[p].cusFieldConfig.fieldId,g.fieldName=e.items[p].cusFieldConfig.fieldName,4==e.items[p].cusFieldConfig.fieldType?(g.fillFlag=0,g.value="00:00"):(g.fillFlag=e.items[p].cusFieldConfig.fillFlag,g.value=""),g.limitOptions=e.items[p].cusFieldConfig.limitOptions,g.fieldType=e.items[p].cusFieldConfig.fieldType,K.push(g),X[g.id]=g}qe(),Ue(),oe(),je(),L(a,i),S(a,i),Ge(),$leaveMsgsubmit.css("background",J);i.urlParams.emailFlag||"",i.urlParams.emailShowFlag||"";1==i.urlParams.emailShowFlag?o=1==i.urlParams.emailFlag:(f.remove(),D=!0);i.urlParams.telFlag||"",i.urlParams.telShowFlag||"";1==i.urlParams.telShowFlag?(n=!0,n=0!=i.urlParams.telFlag):(m.remove(),_=!0),1==i.urlParams.enclosureShowFlag?r=0!=i.urlParams.enclosureFlag:$leaveMsgUpload.remove();var v=$txtTip.height();v>114&&d.height(v);for(var p=0,h=e.items.length;p<h;p++)3==e.items[p].cusFieldConfig.fieldType&&a.find("#dp"+e.items[p].cusFieldConfig.fieldId).datepicker().on("changeDate",function(e){var i,t,a,s=e.date;i=s.getFullYear(),t=s.getMonth()+1<10?"0"+(Number(s.getMonth())+1):s.getMonth()+1,a=s.getDate()<10?"0"+s.getDate():s.getDate(),_bir=i+"-"+t+"-"+a,$(this).val(_bir);var n=$(this).attr("data-fieldId");De(_bir,n),$(".datepicker.dropdown-menu").hide()})})},Ee=function(){var e=i.apiConfig.msgLeaveTxt,t=i.apiConfig.msgLeaveContentTxt;w.load(k.basePath+"/views/sendArea/leaveMsg.html").then(function(s){var n=doT.template(s)({global:i,msgLeaveTxt:e,leaveMsgDetail:t,languageText:l});a=$(n),$(".js-mainBox").append(a),qe(),Ue(),oe()})},He=function(){var e=$(this).attr("data-fieldId"),i=$(".js-definedNumInput"+e).val();i.length>300&&(i=i.slice(0,300)),$(".js-definedNumInput"+e).val(i)},qe=function(){u=a.find(".js-email"),f=a.find(".js-emailArea"),p=a.find(".js-telephone"),m=a.find(".js-telArea"),d=a.find(".js-leaveMsgDetail"),g=a.find(".js-leaveMessage"),$leaveMsgDetailTip=a.find(".js-leaveMsgDetailTip"),v=a.find(".js-emailTip"),h=a.find(".js-telephoneTip"),$leaveMsgsubmit=a.find(".js-leaveMsgsubmit"),$leaveMsglayer=a.find(".js-leaveMsglayer"),$focusStyle=a.find(".js-focusStyle"),$close=a.find(".js-close"),$txtTip=a.find(".js-txt-tip"),$sureWindow=a.find(".js-sureWindow"),$leaveclose=a.find(".js-leaveclose"),$leavecancel=a.find(".js-leavecancel"),$leavesure=a.find(".js-leavesure"),y=a.find(".js-leaveMsgHeader"),$sureWindowlayer=a.find(".js-sureWindowlayer"),$leaveMsgUploadBtn=a.find(".js-leaveMsgUploadBtn"),$leaveMsgUpload=a.find(".js-leaveMsgUpload"),$enclosureTip=a.find(".js-enclosureTip"),$commitSureWindow=a.find(".js-commitSureWindow"),$commitLeavesure=a.find(".js-commitLeavesure"),$leaveMsgBody=a.find(".js-leaveMsgBody"),$definedFields=a.find(".js-definedFields"),$userCheck=a.find(".js-userCheck"),$userOpt=a.find(".js-userOpt"),$definedNumInput=a.find(".js-definedNumInput"),$jsTitle=a.find(".js-title"),$jsTitles=a.find(".js-titles"),$descript=$(".detailed-description"),j=a.find(".bgback")},We=function(){var e=$("<div></div>").text($(".js-leaveMsgDetail_msg").val());if(_content=e.html(),""!=_content){var t={uid:s,companyId:i.sysnum,groupId:i.urlParams.leaveMsgSendGroupIdFlag?ee:"",content:_content};z&&(z=!1,M({type:"post",url:"/chat-web/user/leaveMsg.action",dataType:"json",data:t,success:function(e){if(e&&1==e.status){var i={type:"system",status:"leaveMsgComplete",data:{content:l.T0157}};F.trigger("sendArea.sendLeaveMsg",{answer:_content}),F.trigger("sendArea.sendAreaSystemMsg",i),F.trigger("core.sessionclose",888),ne(),setTimeout(function(){z=!0},5e3)}else C.show(Q.L10038)},error:function(){C.show(l.T0033)}}))}},Ue=function(){j.on("click",function(){$("#leaveMsg1").css("display","block"),$("#leaveMsg2").css("display","none")}),$jsTitle.on("click",function(){$(this).addClass("active").siblings().removeClass("active"),"请您留言"===$(this)[0].innerHTML?(a.find(".leaveMsgShowtem").css("display","block"),a.find(".leaveMsgRecord").css("display","none")):(a.find(".leaveMsgShowtem").css("display","none"),a.find(".leaveMsgRecord").css("display","block"),T=a.find(".quectionDisc"))}),$(".clickShow").on("click",function(){$(".tubo").toggleClass("active"),$(".detailed-description").toggleClass("active")}),$close.on("click",ve),$leaveMsglayer.on("click",ve),$leavesure.on("click",ne),d.on("blur",re),a.find(".js-leaveMsgDetail_msg").on("blur",le),u.on("blur",ce),p.on("blur",de),$leaveMsgsubmit.on("click",pe),$focusStyle.on("focus",me),$focusStyle.on("blur",ge),$(window).on("resize",je),d.on("input",Te),$definedNumInput.on("input",He),$commitLeavesure.on("click",function(){pe(1)}),a.delegate(".js-definedInput","blur",Ae),F.on("sendArea.definedFieldResult",_e),ie.indexOf("ie 7")!==-1&&$leaveMsgBody.on("scroll",function(){$sureWindowlayer.addClass("show"),$sureWindowlayer.removeClass("show")}),$leaveMsgUploadBtn.on("change",xe),x.detectEventSupport("input")?(d.on("input",he),u.on("input",he),p.on("input",he)):G=setInterval(function(){ye(".js-leaveMsgDetail")},100),$txtTip.on("click",function(){d.focus()}),$leavecancel.on("click",function(){$sureWindow.css({opacity:"0"}).removeClass("show"),$sureWindowlayer.css({opacity:"0"}).removeClass("show"),$commitSureWindow.animate({opacity:"0"}).removeClass("show")}),$leaveclose.on("click",function(){$sureWindow.css({opacity:"0"}).removeClass("show"),$sureWindowlayer.css({opacity:"0"}).removeClass("show"),$commitSureWindow.animate({opacity:"0"}).removeClass("show")}),$leavesure.css({background:J,color:"#fff"}),$commitLeavesure.css({background:J,color:"#fff"}),$userCheck.on("click",Me),$userOpt.on("click",Pe),a.find(".js-leaveMsgDetail_msg").on("input",function(){a.find(".js-leaveMsgCommit").css("background",J)}),a.find(".js-leaveMsgCommit").on("click",function(){We()}),a.on("click",".js-evaluation-score",Ne),a.on("click",".js-close-evaluation",Re),a.on("click",".js-start-btn",Oe),a.on("click",".js-submit-evaluation",Be)},Ge=function(){if(i.apiInit.userId&&"null"!==i.apiInit.userId&&"undefined"!==i.apiInit.userId)$.ajax({type:"get",dataType:"json",url:"/chat-web/user/getUserTicketInfoList.action",data:{uid:s},success:function(e){if(e.retCode="000000"){if(I=e.items,!I.length)return void $(".js-titleTwo").remove();var t={items:I,languageText:l},n=doT.template(P.switchLeaveMsgTemplate)(t);$(".js-leaveMsgRecord").html(n),T=$(".js-li-click"),T.off("click"),T.on("click",function(){var e=$(this).index();$("#leaveMsg1").css("display","none"),$("#leaveMsg2").css("display","block"),j=a.find(".bgback");var t=JSON.stringify({companyId:i.sysnum,ticketId:I[e].ticketId});se.companyId=i.sysnum,se.ticketId=I[e].ticketId,$.ajax({type:"get",url:"/chat-web/data/invokeOtherByUser.action",dataType:"json",data:{uid:s,param:t,url:"ws/getUserDealTicketInfoList/4",method:"get"},success:function(e){if(e.retCode="000000"){var i={items:e.items,currentOrderData:I,languageText:l,endFlag:e.items[0].flag};e.items.forEach(function(e){3==e.flag&&(e.ticketScoreInfooList&&e.ticketScoreInfooList.reverse(),te=e)});var t=doT.template(P.procressLeaveMsg)(i),a=doT.template(P.showOrHide)(i);$(".js-bottomss").html(t),$(".detailed-description").html(a),Ge()}}})})}}});else{$(".js-titleTwo").remove(),I=[];var e={items:I,languageText:l},t=doT.template(P.switchLeaveMsgTemplate)(e);$(".js-leaveMsgRecord").html(t)}},Ve=function(){if(2==i.apiConfig.msgToTicketFlag)Ee();else{var e={operateType:3,openFlag:1,templateId:i.urlParams.templateId},t=JSON.stringify(e),a={uid:s,url:"basic-set/getTemplateFieldsInfo/4",method:"get",param:t};M({url:"/chat/data/invokeOtherByUser.action",dataType:"json",type:"get",data:a}).success(function(e){ze(e),be()})}C=C(i)};Ve(),window.validateField=function(e){var i=$(e),t=i.data("info");if(t.length>0){var a=!1,s=!1,n=!1,o=!1;t.forEach(function(e){7===e&&(n=!0,o=!1,s=!1,a=!1),8===e&&n===!1&&(o=!0,s=!1,a=!1),5===e&&n===!1&&o===!1&&(s=!0,a=!1),4===e&&n===!1&&o===!1&&s===!1&&(a=!0)}),o&&i.val(i.val().replace(/\D/g,"")),s&&i.val(i.val().replace(/\D/g,"")),a&&i.val(i.val().replace(/[^\u4E00-\u9FA5A-Za-z0-9]/g,""))}}};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"../config/config.json":37,"../util/load.js":64,"../util/showTip.js":70,"./dropdownClassify.js":48,"./leaveDropdown.js":53,"./template.js":56}],55:[function(e,i,t){var a=function(i){var t,a,s,t,n,o,r=(e("../../../common/util/listener.js"),e("../../../common/util/monitAjax.js")(i)),l=e("./template.js"),c=e("../../../common/comm.js"),d=function(){a.removeClass("show"),s.animate({right:"-390px"},function(){t.remove()})},u=function(){a.addClass("show"),s.animate({right:"0"})},f=function(e){o=c.getQueryParam();var a=document.location.href,s=a.substring(0,a.indexOf("?")+1);for(key in o)"robotid"==key||(s+=key+"="+encodeURIComponent(o[key])+"&");s=s.substring(0,s.lastIndexOf("&"));var n={uid:i.apiInit.uid,channelFlag:o.channelFlag||""};r({url:"/chat-web/user/getRobotSwitchList.action",dataType:"json",type:"get",data:n}).success(function(e){if(1==e.status){for(var a=0;a<e.list.length;a++)e.list[a].newLink=s+"&robotid="+e.list[a].robotFlag,e.list[a].robotFlag==i.apiConfig.robotid&&(e.list[a].currentRobot=1);var n={languageText:i.language.text,list:e.list},o=doT.template(l.switchRobotTemplete)(n);t=$(o),$(".js-mainBox").append(t),t.find(".js-currentRobot").css({background:i.userInfo.color,border:"1px solid "+i.userInfo.color}),p(),m(),u()}})},p=function(){a=t.find(".js-switchRobotlayer"),s=t.find(".js-switchRobot"),n=t.find(".js-close")},m=function(){n.on("click",d),a.on("click",d),t.find(".js-switchRobotEle").hover(function(){$(this).css({background:i.userInfo.color,border:"1px solid "+i.userInfo.color}),$(this).find("a").css({color:"#fff"})},function(){$(this).css({background:"#fff",border:"1px solid #e0e9e8"}),$(this).find("a").css({color:"#535656"})})},g=function(){f()};g()};i.exports=a},{"../../../common/comm.js":1,"../../../common/util/listener.js":32,"../../../common/util/monitAjax.js":34,"./template.js":56}],56:[function(e,i,t){var a={},s='<div class="evaluation-layer"><div class="dialog-box"><div class="dialog-content"><div class="close-dialog"><i class="js-close-evaluation"></i></div><div class="title">请您对本次服务进行评分</div><div class="star-list"><ul class="clearfix"><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li><li class="js-start-btn active"></li></ul></div><div class="tips js-change-evaluation">{{=it.ticketScoreInfooList[4].scoreExplain }}</div>{{ if(it.txtFlag == 1){ }}<div class="desc"><textarea maxlength="150" id="js-text-evaluation" placeholder="欢迎给我们的服务提意见～"></textarea></div>{{ } }}{{ else{ }}<div style="margin-top: 80px"></div>{{ } }}<a class="submit js-submit-evaluation" href="javascript:">提交评价</a></div></div></div>',n='<div><div class="group-layer js-group-layer"></div><div class="group-outer js-group-outer pc-leaveMessage-layer"><p class="group-title">请选择留言模板<span class="close_button js-cancel-btn js-group-cancel"></span></p><div class="group-main"><ul class="clearfix">{{  for(var i=0;i<it.list.length;i++){ }}{{ var item = it.list[i];}}<li class="js-item" data-id="{{=item.templateId}}">{{=item.templateName}}</li>{{  } }}</ul></div></div></div>',o='<div class="msgFileIco js-msgFileIco {{=it.fileIcoClass}}" style="float: left; width: 30px;height: 30px;margin-top: 3px;background-repeat: no-repeat;"></div><div class="msgFileDetail js-msgFileDetail" style="float: left;margin-left: 9px;font-size: 12px;"><p class="filename" title="{{=it.filename}}" style="width: 170px;height: 20px;color: #555556;overflow: hidden;text-overflow: ellipsis;word-break: normal;white-space: nowrap;font-size: 12px;">{{=it.filename}}</p><span class="fileSize" style="float: left;color: #8a9699;font-size: 12px">{{=it.filesize}}</span> <span class="sizeAfter js-sizeAfter" style="float: left;margin: 0 5px;color: #8a9699;font-size: 12px;">|</span><a class="filedownload js-filedownload" href="{{=it.url}}" target="_blank" style="display:block;color: #28a7dc!important; font-size: 12px; cursor: pointer;">{{=it.languageText.T0160}}</a></div>',r='<img src="{{=it.url}}" class="webchat_img_upload upNowImg uploadedFile" />',l='<div class="systeamTextBox systeamNowText js-systeamTextBox{{=it.date}}"><p class="systeamText">正在上传 {{=it.filename}}{{=it.extension}}</p></div>',c='<div class="evaluateWether"><p class="evaluateTitle"><label class="aname" style="text-overflow: ellipsis; max-width: 100px;word-break: normal;white-space: nowrap; display: inline-block; overflow: hidden;line-height: 13px;" title="{{=it.subName}}">{{=it.subName}}</label> {{=it.evaluateTitle}}</p><div class="btnGroup"><span class="js-isques evaluate-btn evaluateok"><i></i>{{=it.okText || "确定"}}</span><span class="js-noques evaluate-btn evaluateno"><i></i>{{=it.cancelText || "取消"}}</span></div></div>',d='<div class="evaluate js-evaluate"><p class="h2">{{=it.languageText.T0027}}</p><div class="situation">{{for(var i=0;i<it.list.length;i++){}}{{if(i%2==0){}}<span class="tag js-tag">{{=it.list[i]}}</span>{{}else{}}<span class="tag js-tag" style="margin-right:0">{{=it.list[i]}}</span>{{}}}{{}}}</div><textarea id="js-evaluateInner" class="js-evaluateInner" placeholder="{{=it.languageText.T0028}}" maxLength="200"></textarea></div>',u='<div class="evaluateWether js-evaluate">{{if(it.config[0].isQuestionFlag){}}<div class="operateType"><p class="operateTypeTitle" title={{=it.aname}}>{{=it.subName}}{{=it.languageText.T0106}}</p><div class="operateTypeBtn"><p class="solve solved js-solved"><span></span>{{=it.languageText.T0041}}</p><p class="solve unSolved js-unSolved" style="margin-left:25px;"><span></span>{{=it.languageText.T0042}}</p></div></div>{{}}}<p class="evaluateTitle">{{=it.languageText.T0096}}</p><div id="star"><ul><li><a href="javascript:;">1</a></li><li><a href="javascript:;">2</a></li><li><a href="javascript:;">3</a></li><li><a href="javascript:;">4</a></li><li><a href="javascript:;">5</a></li></ul></div><p class="evaluateTip js-evaluateTip"><span style="color:#8b98ad;">{{=it.languageText.T0107}}</span></p></div>',f='<div class="evaluate js-evaluate">{{if(it.list.length>0){}}<p class="h2">{{=it.languageText.T0027}}</p>{{}}}<div class="situation">{{for(var i=0;i<it.list.length;i++){}}{{if(i%2==0){}}<span class="tag js-tag">{{=it.list[i]}}</span>{{}else{}}<span class="tag js-tag" style="margin-right:0">{{=it.list[i]}}</span>{{}}}{{}}}</div><textarea id="js-evaluateInner" class="js-evaluateInner" placeholder="{{=it.conf.inputLanguage||it.languageText.T0028}}{{=it.conf.isInputMust?it.languageText.T0046:it.languageText.T0047}}" maxLength="200"></textarea></div>',p='<div class="evaluateSubmitArea">{{if(it.from=="close"){}}<a class="submit js-evaluateSubmit js-submitTheme" href="#">{{=it.languageText.T0029}}</a><a class="nosubmit js-noevaluateSubmit" href="#">{{=it.languageText.T0097}}</a>{{}else{}}<a class="submit js-evaluateSubmit js-submitTheme" href="#">{{=it.languageText.T0029}}</a>{{}}}</div>',m='<a class="js-leaveMsgBtn" href="{{=it.hostUrl}}"><i class="leaveMessagebg"></i><p>{{=it.languageText.T0030}}</p></a>',g='<span class="span3"><a class="js-leaveMsgBtn" href="{{=it.hostUrl}}"><i class="icon"></i><p>{{=it.languageText.T0030}}</p></a></span>',v='<div class="js-allScreen allScreen"><div class="loadingUploadImg"><i></i><p>{{=it.language.L10036}}</p></div></div>',h='<div class="js-evamsg evamsg"><p>{{=it.language.L10037}}</p></div>',y='<div class="js-evamsg evamsg" style="color:#cb1f16"><p>{{=it.language.L10038}}</p></div>',T='<div class="js-evaluateArea"><div class="evaluatelayer js-evaluatelayer"></div><div class="evaluateDialog js-evaluateDialog"><span class="close_button js-evaluateClose"></span><div class="evaluate-body-widely"><div class="model-body"></div><div class="model-body-extend"></div><div class="model-body-commit"></div></div></div></div>',j='<div class="js-leaveMsgFileStyle leaveMsgFileStyle js-leaveMsgFile{{=it.date}}"><p class="leaveMsgFileName" title="{{=it.filename}}{{=it.extension}}">{{=it.filename}}{{=it.extension}}</p><p class="leaveMsgFilesize">({{=it.filesize}})</p><p class="leaveMsgProcessWidely"><span class="js-leaveMsgProcess{{=it.date}} leaveMsgProcess"></span></p><p class="fileTip">{{=it.languageText.T0084}}</p><span class="leaveMsgFileClose js-leaveMsgFileClose{{=it.date}}"></span></div>',b='<div class="js-leaveMsgFileStyle leaveMsgFileStyle js-leaveMsgFile{{=it.date}}"><p class="leaveMsgFileName" title="{{=it.filename}}{{=it.extension}}">{{=it.filename}}{{=it.extension}}</p><p class="ie-uploadLoading">{{=it.languageText.T0083}}</p><p class="fileTip">{{=it.languageText.T0084}}</p><span class="leaveMsgFileClose js-leaveMsgFileClose{{=it.date}}"></span></div>',I='{{if(it.items.length>0){}}{{ for(var i=0;i<it.items.length;i++){ }}<li class="js-classDropdownLi js-classOrderList" data-nodeFlag="{{=it.items[i].nodeFlag}}" dataId="{{=it.items[i].typeId}}" data-key="classifyByPid" title="{{=it.items[i].typeName||""}}">{{=it.items[i].typeName}}{{if(it.items[i].nodeFlag){}}<span class="firstIcon"></span>{{}}}</li>{{ } }}{{ }else{ }} <li>空</li>{{ } }}',w='<div class="capture-outer"><p class="captTips">提示：建议使用微信或QQ的截图功能进行截图，然后直接粘贴到对话框即可。</p><p class="h5">您可按照以下步骤下载截图插件：</p><ol><li><h6>下载地址</h6><div class="capture-text">Windows系统下载qq截图插件 <a href="https://img.sobot.com/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7-win.exe" target="_blank">点击此处</a></div><div class="capture-text">Mac系统下载qq截图插件 <a href="https://img.sobot.com/tools/%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7-mac.dmg" target="_blank">点击此处</a></div></li><li><h6>完成下载后，请找到程序所在文件夹，然后按照下面链接的方法设置截图快捷键</h6><div class="capture-text">Windows系统下 <a href="https://jingyan.baidu.com/article/2fb0ba408a1e1300f2ec5f03.html" target="_blank">安装设置方法</a></div><div class="capture-text">Mac系统下 <a href="https://jingyan.baidu.com/article/3d69c5514e44a3f0ce02d751.html" target="_blank">安装设置方法</a></div></li><li><h6>完成上述步骤后，即可使用。</h6></li>',x='<ul class="respInfoList js-respInfoList">{{for(var i=0;i<it.respInfoList.length;i++){}}{{if(i<6){}}<li class="js-respInfoBtn" title="{{=it.respInfoList[i].question}}" data-docid="{{=it.respInfoList[i].docId}}">{{=it.respInfoList[i].highlight}}</li>{{}}}{{}}}</ul>',F='<div><div class="switchRobotlayer js-switchRobotlayer"></div><div class="switchRobot js-switchRobot"><div class="js-switchRobotHeader switchRobotHeader"><p class="title">{{=it.languageText.T0140}}</p><span class="close js-close"></span></div><div class="switchRobotBody js-switchRobotBody"><ul class="robotList">{{for(var i=0;i<it.list.length;i++){}}{{if(it.list[i].currentRobot){}}<li class="js-switchRobot currentRobot js-currentRobot"><a href="{{=it.list[i].newLink}}">{{=it.list[i].operationRemark}}</a></li>{{}else{}}<li class="js-switchRobotEle"><a href="{{=it.list[i].newLink}}">{{=it.list[i].operationRemark}}</a></li>{{}}}{{}}}</ul></div></div></div>',k='{{if(it.items.length===0){}}<span style="display: block;margin-top: 200px"> {{=it.languageText.T0148}}</span>{{}else{}}<div class="leaveMsgListRecord"><ul>{{for(var i=0;i<it.items.length;i++){}}<li class="js-li-click"><div class="quectionDisc"><div class="header"><div class="tips">{{=it.languageText.T0110}}{{if(it.items[i].newFlag===2){}}<span class="umi"><span>New</span></span>{{}}}</div>{{if(it.items[i].flag===3){}}<div class="state">{{=it.languageText.T0131}}</div>{{}else if(it.items[i].flag===2){}}<div class="state1">{{=it.languageText.T0132}}</div>{{}else{}}<div class="state2">{{=it.languageText.T0133}}</div>{{}}}</div><div class="content"><div class="culoum">{{=it.items[i].content}}</div></div><div class="bottom"><div class="left">{{=it.languageText.T0134}}:{{=it.items[i].ticketCode}}</div><div class="right">{{=it.items[i].timeStr}}</div></div></div></li>{{}}}</ul>{{}}}',C='<div class="bottom">{{for(var i=0;i<it.items.length;i++){}}{{if(it.items[i].flag===3){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0131}}</span></div><div class="contents-sl active" ><div style="margin-left: 15px"><div class="resful">{{=it.languageText.T0149}}</div><div class="resfuls">{{=(it.items[i].content||it.languageText.T0139)}}</div></div></div>{{ if(it.items[i].isOpen == 1 && it.items[i].isEvalution == 0){ }}<div class="js-evaluation-area" style="margin: 10px 0 10px 23px"><a href="javascript:" class="js-evaluation-score" style="display: block;width: 124px;line-height: 30px;font-size: 14px;color: #fff;background: #0DAEAF; text-align: center; border-radius: 2px;">立即评价</a></div>{{ } }}{{ else if(it.items[i].isEvalution == 1){ }}<div style="margin-left: 23px;margin-bottom: 10px;"><div><span style="color: #333">评价星级：</span><span style="color: #888">{{=it.items[i].ticketScoreInfooList[it.items[i].score - 1].scoreExplain}}({{=it.items[i].score}}星)</span></div>{{ if(it.items[i].remark){ }}<div><span style="color: #333">评价反馈：</span><span style="color: #888;word-break: break-all;text-align: justify">{{=it.items[i].remark}}</span></div>{{ } }}</div>{{ } }}</div>{{}}}{{if(it.items[i].flag===2){}}{{for(var j=0;j<it.items[i].replayList.length;j++){}}{{if(j===0&&it.items.length===2){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].replayList[j].replyTimeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0132}}</span></div><div class="contents-sl active" ><div style="margin-left: 15px">{{if(it.items[i].replayList[j].startType===0){}}<div class="resful">{{=it.languageText.T0149}}</div>{{}else if(it.items[i].replayList[j].startType===1){}}<div class="resful">{{=it.languageText.T0150}}</div>{{}}}<div class="resfuls">{{=(it.items[i].replayList[j].replyContent||it.languageText.T0139)}}</div></div></div></div>{{}else{}}<div class="proseess"><div><span class="timer"></span><span class="texts">{{=it.items[i].replayList[j].replyTimeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss"></span><span class="texts">{{=it.languageText.T0132}}</span></div><div class="contents-sl" ><div style="margin-left: 15px">{{if(it.items[i].replayList[j].startType===0){}}<div class="resful">{{=it.languageText.T0149}}</div>{{}else if(it.items[i].replayList[j].startType===1){}}<div class="resful">{{=it.languageText.T0150}}</div>{{}}}<div class="resfuls">{{=(it.items[i].replayList[j].replyContent||it.languageText.T0139)}}</div></div></div></div>{{}}}{{}}}{{}}}{{if(it.items[i].flag===1){}}{{if(it.items.length===1){}}<div class="proseess"><div><span class="timer actives"></span><span class="texts active">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss active"></span><span class="texts active">{{=it.languageText.T0133}}</span></div></div>{{}else{}}<div class="proseess"><div><span class="timer"></span><span class="texts">{{=it.items[i].timeStr}}</span></div><div style="margin-top: 8px"><span class="tipsss"></span><span class="texts">{{=it.languageText.T0133}}</span></div></div>{{}}}{{}}}{{}}}</div>',$="<span>{{=it.items[it.items.length-1].content}}</span>";
a.evaluationDialog=s,a.groupTemplate=n,a.captureDialogTemplate=w,a.sobotEvaluateOne_selfHtml=c,a.sobotEvaluateTwo_selfHtml=d,a.humanOne_selfHtml=u,a.humanTwo_selfHtml=f,a.evaluateFooter_selfHtml=p,a.leaveMessageBtn=m,a.leaveMessageEndBtn=g,a.evamsgHtml=h,a.evamsgHtml2=y,a.waitingUploadImg=v,a.tranfiletype=o,a.fileImage=r,a.uploading=l,a.AlertTemplate=T,a.leaveMsgFileStyle=j,a.IframeleaveMsgFileStyle=b,a.classifyOrderList=I,a.respInfoList=x,a.switchRobotTemplete=F,a.switchLeaveMsgTemplate=k,a.procressLeaveMsg=C,a.showOrHide=$,i.exports=a},{}],57:[function(e,i,t){function a(i,t,a,s){var n=e("../../../common/util/listener.js"),o=e("../../../common/util/msgReminder.js"),r={},l=e("../util/modal/alert.js"),c=e("./fileType.json"),d=e("../util/showTip.js"),u=s.language.text,f=e("./fileTypeIcon.json"),p=e("./template.js"),m=function(){$node=$(i),$uploadBtn=$(".js-upload")},g=s.userInfo.color?s.userInfo.color:s.apiConfig.color;o.clear();var v=function(e,i){T(e,i)},h=function(e){for(var i=e.substring(e.indexOf(":")+1,e.indexOf(";")),t=e.substring(e.indexOf(",")+1),a=atob(t),s=new Array(a.length),n=0;n<a.length;n++)s[n]=a.charCodeAt(n);var o=new Uint8Array(s),r=new Blob([o],{type:i});return r},y=function(e,i,t){var a=e.getAsFile();if(a&&"image/png"==a.type){var n=new FormData,o=new FileReader;o.onload=function(e){var a=!1,o=e.target.result,r=h(o);n.append("file",r),n.append("type","paste"),n.append("pid",s.apiInit.pid),n.append("countTag",1),n.append("source",0);var c="image",d="智齿科技",u=".png",f=new l({title:"确认发送图片？",text:'<img src="'+e.target.result+'">',okText:"发送",cancelText:"取消",OK:function(){a||(a=!0,j(i,t,u,d,c,r))}});f.show(),$(".js-ok-btn").css({background:g,color:"#fff"})},o.readAsDataURL(a)}},T=function(e,i){if(a.FormData){var t=$uploadBtn[0],s=$uploadBtn.val(),n=s.substr(s.lastIndexOf(".")),o=s.substring(s.lastIndexOf("\\")+1,s.lastIndexOf(".")),r=c[n],l=f[r];if(b(n,o)){var d=w(n,o),u=t.files[0];j(e,i,n,o,r,u,l,d)}$uploadBtn.val("")}else I(e,i)},j=function(e,i,t,a,o,r,l,c){var f=+new Date,p=e+f,m=new XMLHttpRequest,g=new FormData,v=!1;if("image"===o){m.open("post","/chat/webchat/fileuploadBase64.action");var h=new FileReader;h.readAsDataURL(r),h.onload=function(i){var t=i.target.result;g.append("sysNum",s.sysnum),g.append("uid",e),g.append("base64",t),n.trigger("sendArea.createUploadImg",{result:t,date:f,token:p}),m.send(g)},n.on("leftMsg.closeUploadImg",function(){v=!0,m.abort()}),m.onreadystatechange=function(s){if(4==s.target.readyState)if(200==s.target.status){var r=JSON.parse(s.target.response).url,f=JSON.parse(s.target.response).filesize;if(0==f)return void d.show(u.T0082);try{n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:r,filetype:o,filename:a,extension:t,fileIcon:l,date:c,dateuid:p})}catch(m){}}else{var g={result:"ImgSendFail",msgId:p};n.trigger("sendArea.msgresult",g)}}}else{var y=r.size,T=!1;if(y>20971520)return void d.show(u.T0082);y<1024?y+="B":y=y<1048576?(y/1024).toFixed(2)+"KB":(y/1048576).toFixed(2)+"M",g.append("file",r),g.append("type","msg"),g.append("pid",s.apiInit.pid),g.append("countTag",1),g.append("source",0),g.append("uid",e),m.open("post","/chat/webchat/fileupload.action");var h=new FileReader;h.readAsDataURL(r),h.onload=function(e){n.trigger("sendArea.createUploadFile",{filename:a,extension:t,filetype:o,filesize:y,date:f,token:p}),m.send(g)},n.on("listMsg.closeUploadFile",function(){T=!0,m.abort()}),m.onreadystatechange=function(s){if(4==s.target.readyState)if(200==s.target.status){var r=JSON.parse(s.target.response).url,d=JSON.parse(s.target.response).filesize;if(0==d)return;try{n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:r,filetype:o,filename:a,filesize:y,extension:t,fileIcon:l,date:c,dateuid:p})}catch(u){}}else T||n.trigger("sendArea.uploadFileFail",{dateuid:p})},m.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total),t=i.toString(),s={percentage:t,token:p,filename:a};n.trigger("sendArea.uploadFileProcess",s)}},!1)}},b=function(e,i){var t="";if(t=/^(.eml|.otd|.msb|.ssu|.SSU|.bmp|.swj|.jpg|.JPG|.jpeg|.JPEG|.png|.PNG|.gif|.GIF|.txt|.TXT|.DOC|.doc|.docx|.DOCX|.pdf|.PDF|.ppt|.PPT|.pptx|.PPTX|.xls|.XLS|.xlsx|.XLSX|.RAR|.rar|.zip|.ZIP|.mp3|.MP3|.mp4|.MP4|.wma|.WMA|.wmv|.WMV|.rmvb|.RMVB|.mov|.MOV)$/,t.test(e))return!0;var a={type:"system",status:"uploadFileError",data:{content:"不能上传"+e+"格式的文件"}};return n.trigger("sendArea.sendAreaSystemMsg",a),!1},I=function(e,i){var t=$node.find(".js-fileinfo");t.find('input[name="pid"]').val(s.apiInit.pid);var a=$uploadBtn.val(),o=a.substr(a.lastIndexOf(".")),r=a.substring(a.lastIndexOf("\\")+1,a.lastIndexOf(".")),l=c[o],d=f[l],u=+new Date,p=e+u;if(b(o,r)){var m=w(o,r),g="iframe"+m;"image"===l?n.trigger("sendArea.createUploadImg",{result:"上传中...",date:u,token:p,browserVersion:"ie-"}):n.trigger("sendArea.createUploadFile",{filename:r,extension:o,filetype:l,date:u,token:p,browserVersion:"ie-"}),t.attr("target",g),t.attr("uid",e),t.attr("action","/chat/webchat/fileupload.action");var v=$('<iframe id="'+g+'" style="display:none;height:1000px;width:500px;" name="'+g+'" src="about:blank;"></iframe>');v.on("load",function(){var t=v[0],a=t.contentWindow.document.getElementsByTagName("body")[0].innerHTML;if(a){var s=JSON.parse(a);s.filesize===!1?(alert("文件太大，上传失败"),n.trigger("sendArea.uploadFileFail",{uid:e,cid:i,dateuid:p,browserVersion:"ie-"})):n.trigger("sendArea.uploadImgUrl",{uid:e,cid:i,url:s.url,filetype:l,filename:r||"",filesize:s.filesize,extension:o||"",fileIcon:d||"",date:m,dateuid:p,browserVersion:"ie-"})}}),$(document.body).append(v),t.submit()}$uploadBtn.val("")},w=function(e,i){var t=+new Date,a={filename:i,extension:e,date:t},s=doT.template(p.uploading)(a);return $node.find(".scrollBox").append(s),t},x=function(){},F=function(){m(),x(),d=d(s)};return F(),r.onFormDataPasteHandler=y,r.onChangeHandler=v,r}i.exports=a},{"../../../common/util/listener.js":32,"../../../common/util/msgReminder.js":35,"../util/modal/alert.js":65,"../util/showTip.js":70,"./fileType.json":50,"./fileTypeIcon.json":51,"./template.js":56}],58:[function(e,i,t){var a={},s=function(e){return e>=10?e+"":"0"+e},n=function(e){if(Object.prototype.toString.call(e).indexOf("Date")<0)throw"param error";var i=e.getHours(),t=e.getMinutes(),a=e.getSeconds(),n=[s(i),s(t),s(a)];return n.join(":")},o=function(e,i){var t,a=new Date,s=Math.abs(a-new Date(e.substr(0,e.indexOf(" "))))/1e3/60/60/24;e=e.replace(/-/g,"/");var n=s<=1?0:s>1&&s<=2?1:2,o=e.substring(0,e.lastIndexOf(":")),r=e.substring(e.indexOf(" "),e.lastIndexOf(":"));switch(n){case 0:t=i.T0011+r;break;case 1:t=i.T0013+r;break;case 2:t=o}return t};a.getTime=n,a.formatTime=o,i.exports=a},{}],59:[function(e,i,t){var a={};a.emojiTip=["u1F603","u1F604","u1F601","u1F606","u1F605","u1F923","u1F602","u1F642","u1F609","u1F60A","u1F607","u1F60D","u1F929","u1F618","u1F61A","u1F619","u1F60B","u1F61C","u1F61D","u1F917","u1F92D","u1F914","u1F910","u1F611","u1F60F","u1F612","u1F60C","u1F614","u1F637","u1F912","u1F635","u1F920","u1F60E","u1F913","u1F633","u1F628","u1F630","u1F625","u1F622","u1F62D","u1F631","u1F616","u1F623","u1F613","u1F620","u1F44B","u1F44C","u270C","u1F91F","u1F44D","u1F44F","u1F91D","u1F64F","u1F4AA","u1F647","u1F42E","u1F339","u1F940","u1F48B","u2764","u1F494","u2B50","u1F389","u1F37A","u1F381"],a.emojiSymbolTip=["😃","😄","😁","😆","😅","🤣","😂","🙂","😉","😊","😇","😍","🤩","😘","😚","😙","😋","😜","😝","🤗","🤭","🤔","🤐","😑","😏","😒","😌","😔","😷","🤒","😵","🤠","😎","🤓","😳","😨","😰","😥","😢","😭","😱","😖","😣","😓","😠","👋","👌","✌","🤟","👍","👏","🤝","🙏","💪","🙇","🐮","🌹","🥀","💋","❤","💔","⭐","🎉","🍺","🎁"],a.emojiReg=/(😃|😄|😁|😆|😅|🤣|😂|🙂|😉|😊|😇|😍|🤩|😘|😚|😙|😋|😜|😝|🤗|🤭|🤔|🤐|😑|😏|😒|😌|😔|😷|🤒|😵|🤠|😎|🤓|😳|😨|😰|😥|😢|😭|😱|😖|😣|😓|😠|👋|👌|✌|🤟|👍|👏|🤝|🙏|💪|🙇|🐮|🌹|🥀|💋|❤|💔|⭐|🎉|🍺|🎁)/g,a.emojiReg2=/(😃|😄|😁|😆|😅|🤣|😂|🙂|😉|😊|😇|😍|🤩|😘|😚|😙|😋|😜|😝|🤗|🤭|🤔|🤐|😑|😏|😒|😌|😔|😷|🤒|😵|🤠|😎|🤓|😳|😨|😰|😥|😢|😭|😱|😖|😣|😓|😠|👋|👌|✌|🤟|👍|👏|🤝|🙏|💪|🙇|🐮|🌹|🥀|💋|❤|💔|⭐|🎉|🍺|🎁)/,a.qqfaceReg=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/g,a.qqfaceReg2=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/,i.exports=a},{}],60:[function(e,i,t){i.exports={"😃":"u1F603.png","😄":"u1F604.png","😁":"u1F601.png","😆":"u1F606.png","😅":"u1F605.png","🤣":"u1F923.png","😂":"u1F602.png","🙂":"u1F642.png","😉":"u1F609.png","😊":"u1F60A.png","😇":"u1F607.png","😍":"u1F60D.png","🤩":"u1F929.png","😘":"u1F618.png","😚":"u1F61A.png","😙":"u1F619.png","😋":"u1F60B.png","😜":"u1F61C.png","😝":"u1F61D.png","🤗":"u1F917.png","🤭":"u1F92D.png","🤔":"u1F914.png","🤐":"u1F910.png","😑":"u1F611.png","😏":"u1F60F.png","😒":"u1F612.png","😌":"u1F60C.png","😔":"u1F614.png","😷":"u1F637.png","🤒":"u1F912.png","😵":"u1F635.png","🤠":"u1F920.png","😎":"u1F60E.png","🤓":"u1F913.png","😳":"u1F633.png","😨":"u1F628.png","😰":"u1F630.png","😥":"u1F625.png","😢":"u1F622.png","😭":"u1F62D.png","😱":"u1F631.png","😖":"u1F616.png","😣":"u1F623.png","😓":"u1F613.png","😠":"u1F620.png","👋":"u1F44B.png","👌":"u1F44C.png","✌":"u270C.png","🤟":"u1F91F.png","👍":"u1F44D.png","👏":"u1F44F.png","🤝":"u1F91D.png","🙏":"u1F64F.png","💪":"u1F4AA.png","🙇":"u1F647.png","🐮":"u1F42E.png","🌹":"u1F339.png","🥀":"u1F940.png","💋":"u1F48B.png","❤":"u2764.png","💔":"u1F494.png","⭐":"u2B50.png","🎉":"u1F389.png","🍺":"u1F37A.png","🎁":"u1F381.png"}},{}],61:[function(e,i,t){i.exports={"[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong"}},{}],62:[function(e,i,t){i.exports={"/::)":"weixiao","/::~":"piezui","/::B":"se","/::|":"fadai","/:8-)":"deyi","/::<":"liulei","/::$":"haixiu","/::X":"bizui","/::Z":"shui","/::'(":"daku","/::-|":"ganga","/::@":"fanu","/::P":"tiaopi","/::D":"ciya","/::O":"jingya","/::(":"nanguo","/::+":"ku","/:–b":"lenghan","/:,@!":"shuai","/:!!!":"kulou","/::Q":"zhuakuang","/::T":"tu","/:,@P":"touxiao","/:,@-D":"yukuai","/::d":"baiyan","/:,@o":"aoman","/::g":"jie","/:|-)":"kun","/::!":"jingkong","/::L":"liuhan","/::>":"hanxiao","/::,@":"youxian","/:,@f":"fendou","/::-S":"zhouma","/:?":"yiwen","/:,@x":"xu","/:,@@":"yun","/::8":"fengl","/:xx":"qiaoda","/:bye":"zaijian","/:wipe":"cahan","/:dig":"koubi","/:handclap":"guzhang","/:&-(":"qiudal","/:B-)":"huaixiao","/:<@":"zuohengheng","/:@>":"youhengheng","/::-O":"haqian","/:>-|":"bishi","/:P-(":"weiqu","/:X-)":"yinxian","/::'|":"kuaikul","/::*":"qinqin","/:@x":"xia","/:8*":"kelian","/:pd":"caidao","/:<W>":"xigua","/:beer":"pijiu","/:basketb":"lanqiu","/:oo":"pingpang","/:coffee":"kafei","/:eat":"fan","/:pig":"zhutou","/:rose":"meigui","/:fade":"diaoxie","/:showlove":"zuichun","/:heart":"aixin","/:break":"xinsui","/:cake":"dangao","/:li":"shandian","/:bome":"zhadan","/:kn":"dao","/:footb":"zuqiu","/:ladybug":"piaochong","/:shit":"bianbian","/:moon":"yueliang","/:sun":"taiyang","/:gift":"liwu","/:hug":"yongbao","/:strong":"qiang","/:weak":"ruo","/:share":"woshou","/:v":"shengli","/:@)":"baoquan","/:jj":"gouyin","/:@@":"quantou","/:bad":"chajin","/:lvu":"aini","/:no":"no_1","/:ok":"ok_1","/:love":"aiqing","/:<L>":"feiwen","/:jump":"tiaotiao","/:shake":"fadou","/:<O>":"ouhuo","/:circle":"zhuanquan","/:kotow":"ketou","/:turn":"huitou","/:skip":"tiaosheng","/:oY":"touxiang","/:#-0":"jidong","/:hiphot":"luanwu","/:kiss":"xianwen","/:<&":"zuotaiji","/:&>":"youtaiji","/微笑":"weixiao","/撇嘴":"piezui","/色":"se","/发呆":"fadai","/得意":"deyi","/流泪":"liulei","/害羞":"haixiu","/闭嘴":"bizui","/睡":"shui","/大哭":"daku","/尴尬":"ganga","/发怒":"fanu","/调皮":"tiaopi","/呲牙":"ciya","/惊讶":"jingya","/难过":"nanguo","/酷":"ku","/冷汗":"lenghan","/衰":"shuai","/骷髅":"kulou","/敲打":"qiaoda","/再见":"zaijian","/擦汗":"cahan","/抠鼻":"koubi","/鼓掌":"guzhang","/糗大了":"qiudal","/坏笑":"huaixiao","/左哼哼":"zuohengheng","/右哼哼":"youhengheng","/哈欠":"haqian","/鄙视":"bishi","/委屈":"weiqu","/快哭了":"kuaikul","/阴险":"yinxian","/亲亲":"qinqin","/吓":"xia","/可怜":"kelian","/抓狂":"zhuakuang","/吐":"tu","/偷笑":"touxiao","/愉快":"yukuai","/白眼":"baiyan","/傲慢":"aoman","/饥饿":"jie","/困":"kun","/惊恐":"jingkong","/流汗":"liuhan","/憨笑":"hanxiao","/悠闲":"youxian","/奋斗":"fendou","/咒骂":"zhouma","/疑问":"yiwen","/嘘":"xu","/晕":"yun","/疯了":"fengl","/篮球":"lanqiu","/乒乓":"pingpang","/咖啡":"kafei","/饭":"fan","/猪头":"zhutou","/玫瑰":"meigui","/调谢":"diaoxie","/嘴唇":"zuichun","/爱心":"aixin","/心碎":"xinsui","/蛋糕":"dangao","/闪电":"shandian","/炸弹":"zhadan","/刀":"dao","/足球":"zuqiu","/瓢虫":"piaochong","/便便":"bianbian","/月亮":"yueliang","/太阳":"taiyang","/礼物":"liwu","/拥抱":"yongbao","/菜刀":"caidao","/西瓜":"xigua","/啤酒":"pijiu","/弱":"ruo","/握手":"woshou","/胜利":"shengli","/抱拳":"baoquan","/勾引":"gouyin","/拳头":"quantou","/差劲":"chajin","/爱你":"aini","/NO":"no_1","/OK":"ok_1","/爱情":"aiqing","/飞吻":"feiwen","/跳跳":"tiaotiao","/强":"qiang","/发抖":"fadou","/怄火":"ouhuo","/转圈":"zhuanquan","/磕头":"ketou","/回头":"huitou","/跳绳":"tiaosheng","/投降":"touxiang","/激动":"jidong","/乱舞":"luanwu","/献吻":"xianwen","/左太极":"zuotaiji","/右太极":"youtaiji","[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[衰]":"shuai","[骷髅]":"kulou","[敲打]":"qiaoda","[再见]":"zaijian","[擦汗]":"cahan","[抠鼻]":"koubi","[鼓掌]":"guzhang","[糗大了]":"qiudal","[坏笑]":"huaixiao","[左哼哼]":"zuohengheng","[右哼哼]":"youhengheng","[哈欠]":"haqian","[鄙视]":"bishi","[委屈]":"weiqu","[快哭了]":"kuaikul","[阴险]":"yinxian","[亲亲]":"qinqin","[吓]":"xia","[可怜]":"kelian","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong","[流汗]":"liuhan","[憨笑]":"hanxiao","[悠闲]":"youxian","[奋斗]":"fendou","[咒骂]":"zhouma","[疑问]":"yiwen","[嘘]":"xu","[晕]":"yun","[疯了]":"fengl","[篮球]":"lanqiu","[乒乓]":"pingpang","[咖啡]":"kafei","[饭]":"fan","[猪头]":"zhutou","[玫瑰]":"meigui","[调谢]":"diaoxie","[嘴唇]":"zuichun","[爱心]":"aixin","[心碎]":"xinsui","[蛋糕]":"dangao","[闪电]":"shandian","[炸弹]":"zhadan","[刀]":"dao","[足球]":"zuqiu","[瓢虫]":"piaochong","[便便]":"bianbian","[月亮]":"yueliang","[太阳]":"taiyang","[礼物]":"liwu","[拥抱]":"yongbao","[菜刀]":"caidao","[西瓜]":"xigua","[啤酒]":"pijiu","[弱]":"ruo","[握手]":"woshou","[胜利]":"shengli","[抱拳]":"baoquan","[勾引]":"gouyin","[拳头]":"quantou","[差劲]":"chajin","[爱你]":"aini","[NO]":"no_1","[OK]":"ok_1","[爱情]":"aiqing","[飞吻]":"feiwen","[跳跳]":"tiaotiao","[强]":"qiang","[发抖]":"fadou","[怄火]":"ouhuo","[转圈]":"zhuanquan","[磕头]":"ketou","[回头]":"huitou","[跳绳]":"tiaosheng","[投降]":"touxiang","[激动]":"jidong","[乱舞]":"luanwu","[献吻]":"xianwen","[左太极]":"zuotaiji","[右太极]":"youtaiji"}},{}],63:[function(require,module,exports){!function(){var that={},parse=function(str){var obj;try{obj=eval("("+str+")")}catch(e){}return obj};that.parse=parse,window.JSON||(window.JSON=that)}()},{}],64:[function(e,i,t){var a=e("./promise.js"),s={},n={},o=function(e,i){var i=i||new a;return setTimeout(function(){return n[e]?a.when(function(){var t=n[e];setTimeout(function(){i.resolve(t)},0)}):void $.ajax({url:e,async:!0,dataType:"text",type:"get"}).success(function(t){i.resolve(t),n[e]=t}).fail(function(e){i.reject(e)})},0),i};s.load=o;var r=function(){return s};i.exports=r},{"./promise.js":68}],65:[function(e,i,t){function a(i){var t=e("./dialog"),a=this,s=$.extend({text:"TEXT",info:"",OK:function(e){}},i);t.call(this,s);var n=function(){var i=e("./template.js"),t=doT.template(i.zcAlertTemplate)(s);a.setInner(t)};n()}i.exports=a},{"./dialog":66,"./template.js":67}],66:[function(e,i,t){function a(i){var t,a,s=e("./template.js"),n=this,o=$.extend({okText:"确定",title:"提示",inner:!1,footer:!0,OK:function(){}},i),r=!0,l=function(){t=$(s.zcShadowLayer);var e=doT.template(s.zcModalOuter)(o);a=$(e),setTimeout(function(){a.find("input").focus()},1)},c=function(e){a.find(".modal-body").append($(e))},d=function(){t.find(".fade.in").animate({opacity:0},300,function(){setTimeout(function(){t.remove()},100)})},u=function(){t.on("click",d),a.on("click",function(e){e.stopPropagation()}),a.delegate(".bootbox-close-button","click",d),a.delegate(".js-cancel-btn","click",function(e){o.cancel&&o.cancel(n),d()}),a.delegate(".js-ok-btn","click",function(e){d(),o.OK&&o.OK(n)}),a.on("keydown",function(e){r&&(r=!1,13==e.keyCode&&(d(),o.OK&&o.OK(n)),setTimeout(function(){r=!0},3e3))}),$(window).resize(function(){m()})},f=function(){return a[0]},p=function(){u(),t.append(a),$(".js-mainBox").append(t),m(),t.find(".fade.in").animate({opacity:1},300)},m=function(){var e=($(".js-mainBox").width()-360)/2,i=($(".js-mainBox").height()-416)/2;$(".modal-dialog").css({"margin-left":e,"margin-top":i})},g=function(){l()};g(),this.getOuter=f,this.setInner=c,this.show=p,this.hide=d}i.exports=a},{"./template.js":67}],67:[function(e,i,t){var a={},s='<div class="zc-shadow-layer"></div>',n='<div class="bootbox  fade in" tabindex="-1" role="dialog" aria-hidden="false" style="display: block;outline:none;">{{if(it.source=="capture"){}}<div class="modal-dialog capture-dialog" style="width:{{=it.width}}px;">{{}else{}}<div class="modal-dialog" style="width:{{=it.width}}px;">{{}}}<div class="modal-content"><div class="modal-header"><span type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true"></span><h4 class="modal-title">{{=it.title || "提示"}}</h4></div><input style="position:absolute;left:0;top:0;z-index:-1;outline:none"/><div class="modal-body"></div>{{ if((it.footer !== false) ) { }}<div class="modal-footer"><button class="btn btn-success js-ok-btn">{{=it.okText || "确定"}}</button><button class="btn btn-danger js-cancel-btn">{{=it.cancelText || "取消"}}</button></div>{{ } }}</div></div></div>',o='<div class="modal-alert-content"><p class="large">{{=it.text}}</p><p>{{=it.info}}</p></div>';a.zcAlertTemplate=o,a.zcModalOuter=n,a.zcShadowLayer=s,i.exports=a},{}],68:[function(e,i,t){function a(){var e=[];this.resolve=function(i){var t=e.shift();t&&t.success&&"function"==typeof t.success&&t.success(i,this)},this.reject=function(i){var t=e.shift();t&&t.fail&&"function"==typeof t.fail&&t.fail(i,this)},this.then=function(i,t){return e.push({success:i,fail:t}),this}}a.when=function(e){return e()},i.exports=a},{}],69:[function(e,i,t){function a(i,t){var a,s,n,o,r,l,c,d,u,f=e("../../../common/util/listener.js"),p=e("./load.js")(),m=e("./face/weixin.json"),g=e("./face/weixinsymbol.json"),v=(e("./unicode.js"),e("./face/Reg.js")),h=e("./face/emojiImagePath.json"),y=e("../config/config.json"),T={},j="",b="",I="",w="",x="",F="",k="",C="",L="img/qqarclist/",S=y.imgPath+"/emoji/",M=function(){"block"===a.css("display")?A():($("#emojiBox").length<=0&&p.load(y.basePath+"/views/sendArea/emoji.html").then(function(e){var i=doT.template(e)({emojiTip:I,emojiSymbolTip:w,emojiPath:S});n.append(i)}),P())},P=function(){a.css("display","block"),o.css("background-position","-46px 0px")},A=function(){a.css("display","none"),o.css("background-position","")},D=function(){var e=$(this).find(".js-faceIco").attr("data-src");f.trigger("sendArea.gotoxy",e)},_=function(e){var i="";if(""!==e&&!e)return null;if(i=e.match(x))for(var t=0;t<i.length;t++){var a=F.exec(e),s=b[a[0]];e=e.replace(F,'<img class="zc-face js-zcFace" src="'+L+s+'.png" />')}var n=e.match(k);if(n)for(var t=0,o=n.length;t<o;t++){var a=C.exec(e),s=h[a[0]];e=e.replace(a[0],'<img class="zc-face zc-emoji" src="'+S+s+'" />')}return e},N=function(){var e=$(this).attr("data-tab");d.hide(),$(e).show(),$(this).addClass("active").siblings().removeClass("active")},R=function(){j=m,b=g,I=v.emojiTip,w=v.emojiSymbolTip,x=v.qqfaceReg,F=v.qqfaceReg2,k=v.emojiReg,C=v.emojiReg2;for(var e in j){var i=new Image;i.src=L+j[e]+".png"}},O=function(){a=$(".js-group"),s=$(".js-faceGroup"),n=$(".js-emojiGroup"),o=$(".js-emotion"),r=$(".js-inputMsg"),l=$(".js-faceIco"),c=$(".js-icoLi"),d=$(".js-groupChildren"),u=$(".js-faceIcoLi")},B=function(){o.on("click",M),c.on("click",N),$(document.body).delegate(".js-faceIcoLi","click",D),$(document.body).on("click",function(e){var i=!1,t=0;e.target.classList?t=e.target.classList.length:i=!0;for(var a=0;a<t;a++)"js-emotion"===e.target.classList[a]&&(i=!0);i||A()})},z=function(){O(),R(),B()};return z(),T.show=P,T.hide=A,T.analysis=_,T}var s,n=function(e,i){return s||(s=a(e,i)),s};i.exports=n},{"../../../common/util/listener.js":32,"../config/config.json":37,"./face/Reg.js":59,"./face/emojiImagePath.json":60,"./face/weixin.json":61,"./face/weixinsymbol.json":62,"./load.js":64,"./unicode.js":72}],70:[function(e,i,t){function a(i){var t=e("./template.js"),a=(i.language.lan,i.language.text,{}),s=function(e){var i={};i={text:e};var a=doT.template(t.showTip)(i);$(".js-mainBox").append(a),r(),o(),n()},n=function(){setTimeout(function(){$showTip.remove()},3e3)},o=function(){var e=($(".js-mainBox").height()-$(".js-showTip").height())/2,i=($(".js-mainBox").width()-$(".js-showTip").width())/2;$showTip.css({top:e,left:i-10})},r=function(){$showTip=$(".js-showTip")},l=function(){},c=function(){l()};return c(),a.show=s,a}i.exports=a},{"./template.js":71}],71:[function(e,i,t){var a={},s='<span unselectable="on" class="faceIco js-faceIco faceIco{{=it.flag}}" data-src="{{=it.a}}" /></span><span class="backDelete"></span>',n='<span unselectable="on" class="faceIco js-faceIco faceIco{{=it.flag}}" data-src="{{=it.a}}" /></span>',o='<div class="js-showTip showTip"><p class="showTipText">{{=it.text}}</p></div>';a.faceIcoStr=s,a.faceIcoStr2=n,a.showTip=o,i.exports=a},{}],72:[function(e,i,t){var a={};a.parse=function(e){return e=e.replace(/\\/g,"%"),unescape(e)},a.stringify=function(e){for(var i=[],t=e.length,a=0;a<t;++a)i[a]=("00"+e.charCodeAt(a).toString(16)).slice(-4);return e?"\\u"+i.join("\\u"):""},i.exports=a},{}]},{},[39]);